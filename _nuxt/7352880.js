(window.webpackJsonp=window.webpackJsonp||[]).push([[125,69],{1354:function(e,t,r){"use strict";r.r(t);var n=r(120),o=r(565),c=(r(17),r(15),r(16),r(8),r(22),r(14),r(23),r(19)),l=r(2),d=(r(37),r(62),r(570)),view=r(1295),f=r(79);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function x(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={name:"survey",layout:"default",components:{Spinner:d.default,PollBox:view.default},data:function(){return{error:null,success:null,survey:null,pageLoaded:!1,loadingFailed:!1,isSurveyExpired:!1}},computed:x({user:function(){return this.$store.state.authUser}},Object(f.c)({isAdmin:"account/ISADMIN"})),mounted:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$nextTick((function(){e.$nuxt.setLayout("default")})),!e.user){t.next=5;break}return t.next=4,e.getInfo();case 4:e.computeIsExpired();case 5:case"end":return t.stop()}}),t)})))()},watch:{$route:function(e,t){var r=this;return Object(c.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("survey-id"!==e.name){t.next=4;break}return t.next=3,r.getInfo();case 3:r.computeIsExpired();case 4:case"end":return t.stop()}}),t)})))()}},methods:{isExpiredHandler:function(e){this.isSurveyExpired=e},computeIsExpired:function(){var e=parseInt(this.survey.expireAt)-new Date;this.isSurveyExpired=e<0},handleJoin:function(){localStorage.setItem("BEFORE_LOGIN_PATH",this.$route.path),this.$router.push({path:"/login"})},getInfo:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var r,n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$fire.firestore.collection("surveys").doc(e.$route.params.id).get();case 3:if(!(r=t.sent).exists){t.next=10;break}n=r.id,data=r.data(),e.survey=x({id:n},data),t.next=12;break;case 10:return e.$nuxt.error({statusCode:404,message:"Poll not found"}),t.abrupt("return");case 12:t.next=18;break;case 14:return t.prev=14,t.t0=t.catch(0),e.$nuxt.error({statusCode:404,message:"Poll not found"}),t.abrupt("return");case 18:e.pageLoaded=!0;case 19:case"end":return t.stop()}}),t,null,[[0,14]])})))()}}},h=r(54),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("client-only",[e.user?t("div",[e.pageLoaded?t("div",{staticClass:"mt-5"},[e.isSurveyExpired?t("div",[t("h1",{staticClass:"d-flex justify-center align-center"},[e._v("This Survey has expired")])]):e._e(),e._v(" "),t("div",{staticClass:"poll-container"},[t("div",{staticClass:"poll-container-inner"},[t("div",{staticClass:"d-flex justify-center align-center",staticStyle:{width:"100%"}},[t("h1",{staticClass:"mx-5 mt-2 mb-3 mt-md-3 blue--text text-decoration-underline",staticStyle:{"text-align":"center","max-width":"100%",width:"600px"}},[e._v(" \n              "+e._s(e.survey.title)+" \n            ")])]),e._v(" "),e._l(e.survey.polls,(function(r,i){return t("div",{key:i},[t("PollBox",{attrs:{id:r,expireAt:e.survey.expireAt,isSurveyExpired:e.isSurveyExpired},on:{isExpired:e.isExpiredHandler}})],1)}))],2)])]):t("Spinner",{attrs:{color:"blue"}})],1):t(o.a,[t("h1",[e._v("\n        You must be logged in to view this page.\n      ")]),e._v(" "),t(n.a,{staticClass:"pa-0 blue--text",staticStyle:{"text-transform":"unset !important","font-size":"16px !important"},attrs:{text:""},on:{click:function(t){return e.handleJoin()}}},[e._v("Click here to Join")])],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Spinner:r(576).default})},569:function(e,t,r){var content=r(575);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(25).default)("1a30734a",content,!0,{sourceMap:!1})},574:function(e,t,r){"use strict";r(569)},575:function(e,t,r){var n=r(24)(!1);n.push([e.i,".spinner[data-v-b799d304]{display:flex;justify-content:center;margin-top:1rem;color:#add8e6}",""]),e.exports=n},576:function(e,t,r){"use strict";r.r(t);var n=r(247),o={},c=(r(574),r(54)),component=Object(c.a)(o,(function(){var e=this._self._c;return e("div",{staticClass:"spinner"},[e(n.a,{attrs:{size:"100",indeterminate:""}})],1)}),[],!1,null,"b799d304",null);t.default=component.exports}}]);