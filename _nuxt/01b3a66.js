(window.webpackJsonp=window.webpackJsonp||[]).push([[47,40,43],{559:function(e,t,n){var content=n(563);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(26).default)("6333d4fe",content,!0,{sourceMap:!1})},561:function(e,t,n){"use strict";n.r(t);var r={name:"LoadingSpinner"},o=(n(562),n(65)),component=Object(o.a)(r,(function(){this._self._c;return this._m(0)}),[function(){var e=this._self._c;return e("div",{staticClass:"text-center",staticStyle:{"margin-top":"10px"}},[e("div",{staticClass:"lds-ring"},[e("div"),e("div"),e("div"),e("div")])])}],!1,null,"6f49ae7c",null);t.default=component.exports},562:function(e,t,n){"use strict";n(559)},563:function(e,t,n){var r=n(25)(!1);r.push([e.i,".lds-ring[data-v-6f49ae7c]{display:inline-block;position:relative;width:80px;height:80px}.lds-ring div[data-v-6f49ae7c]{box-sizing:border-box;display:block;position:absolute;width:64px;height:64px;margin:5px;border-radius:50%;-webkit-animation:lds-ring-6f49ae7c 1.2s cubic-bezier(.5,0,.5,1) infinite;animation:lds-ring-6f49ae7c 1.2s cubic-bezier(.5,0,.5,1) infinite;border:5px solid transparent;border-top-color:#2196f3}.lds-ring div[data-v-6f49ae7c]:first-child{-webkit-animation-delay:-.45s;animation-delay:-.45s}.lds-ring div[data-v-6f49ae7c]:nth-child(2){-webkit-animation-delay:-.3s;animation-delay:-.3s}.lds-ring div[data-v-6f49ae7c]:nth-child(3){-webkit-animation-delay:-.15s;animation-delay:-.15s}@-webkit-keyframes lds-ring-6f49ae7c{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes lds-ring-6f49ae7c{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}",""]),e.exports=r},643:function(e,t,n){var content=n(719);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(26).default)("75f21722",content,!0,{sourceMap:!1})},666:function(e,t,n){"use strict";n.r(t);var r=n(120),o=n(111),l=n(121),c=n(2),d=(n(16),n(8),n(20)),f=(n(61),n(14),n(76),n(34),n(66),n(89),n(54),{name:"GloberPoll",components:{Spinner:n(561).default},props:{poll:{type:Object,required:!0},pollAnswers:{type:Array,required:!0},myOriginalAnswer:{type:Object||null,default:null}},data:function(){return{isLoading:!1,submitButtonText:"Submit",customId:0,finalResults:!1,myAnswer:null}},watch:{myOriginalAnswer:{handler:function(e){this.myAnswer=e},immediate:!0,deep:!0}},computed:{isChoice:function(){return"multi-choice"===this.poll.type||"single-choice"===this.poll.type},isMultiChoice:function(){return"multi-choice"===this.poll.type},isSingleChoice:function(){return"single-choice"===this.poll.type},user:function(){return this.$store.state.authUser},answers:function(){var e={};this.pollAnswers.forEach((function(t){t.answers.forEach((function(t){e.hasOwnProperty(t)?e[t]+=1:e[t]=1}))})),this.myAnswer&&this.myAnswer.answers.forEach((function(t){e.hasOwnProperty(t)?e[t]+=1:e[t]=1}));var t=this.poll.options.choices.map((function(t){return{value:t.value,selected:!1,votes:e[t.value]||0}}));return t},hasMyAnswer:function(){return this.myAnswer&&this.myAnswer.answers&&this.myAnswer.answers.length},totalVotes:function(){var e=0;return this.answers.filter((function(a){!isNaN(a.votes)&&a.votes>0&&(e+=parseInt(a.votes))})),e},totalVotesFormatted:function(){return this.totalVotes.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},mostVotes:function(){var e=0;return this.answers.filter((function(a){!isNaN(a.votes)&&a.votes>0&&a.votes>=e&&(e=a.votes)})),e},calcAnswers:function(){var e=this;if(0===this.totalVotes){var t=this.answers.map((function(a){return a.percent="0%",a}));return t}return this.answers.filter((function(a){return!isNaN(a.votes)&&a.votes>0?a.percent=Math.round(parseInt(a.votes)/e.totalVotes*100)+"%":a.percent="0%",a}))},totalSelections:function(){var e=this.calcAnswers.filter((function(a){return a.selected})).length;return e}},methods:{addvote:function(e){var t=this;return Object(d.a)(regeneratorRuntime.mark((function n(){var r,data,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.isLoading=!0,r=Date.now().toString(),data={answers:[],pollId:t.poll.id,userId:t.user.uid,createdAt:r},!t.isMultiChoice){n.next=8;break}return o=e.map((function(e){return e.value})),data.answers=o,n.next=8,t.$fire.firestore.collection("pollAnswers").add(data).then((function(e){data.id=e.id,t.myAnswer=data,t.success="Successfully updated!!",t.isLoading=!1,setTimeout((function(){t.success=null}),2e3)})).catch((function(e){t.isLoading=!1,t.error="Error: "+e,setTimeout((function(){t.error=null}),2e3)}));case 8:if(!t.isSingleChoice){n.next=12;break}return data.answers.push(e.value),n.next=12,t.$fire.firestore.collection("pollAnswers").add(data).then((function(e){data.id=e.id,t.myAnswer=data,t.success="Successfully updated!!",t.isLoading=!1,setTimeout((function(){t.success=null}),2e3)})).catch((function(e){t.error="Error: "+e,t.isLoading=!1,setTimeout((function(){t.error=null}),2e3)}));case 12:t.$forceUpdate();case 13:case"end":return n.stop()}}),n)})))()},resetAnswer:function(){var e=this;this.isLoading=!0,this.$fire.firestore.collection("pollAnswers").doc(this.myAnswer.id).delete().then((function(){e.myAnswer=null,e.isLoading=!1,e.$forceUpdate(),e.success="Reset Answer!!",setTimeout((function(){e.success=null}),2e3)})).catch((function(t){console.log(t),e.isLoading=!1}))},handleMultiple:function(){var e=[];this.calcAnswers.filter((function(a){a.selected&&(a.votes++,e.push({value:a.value,votes:a.votes}))})),this.addvote(e)},handleVote:function(a){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isMultiChoice){t.next=5;break}return void 0===a.selected&&console.log("Please add 'selected: false' on the answer object"),a.selected=!a.selected,e.$forceUpdate(),t.abrupt("return");case 5:return t.next=7,e.addvote(a);case 7:case"end":return t.stop()}}),t)})))()}}}),v=(n(718),n(65)),component=Object(v.a)(f,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-poll"},[t(o.a,{staticClass:"vue-poll-inner pa-3 ma-3"},[t("h3",{staticClass:"qst",domProps:{innerHTML:e._s(e.poll.question)}}),e._v(" "),e.poll.hint?t("p",{staticClass:"qst",staticStyle:{color:"grey","font-size":"14px"},domProps:{innerHTML:e._s(e.poll.hint)}}):e._e(),e._v(" "),t("div",{staticClass:"ans-cnt"},[e._l(e.calcAnswers,(function(a,n){return t("div",{key:n,class:Object(c.a)({ans:!0},a.custom_class,a.custom_class)},[e.hasMyAnswer?[t("div",{staticClass:"ans-voted final"},[a.percent?t("span",{staticClass:"percent",domProps:{textContent:e._s(a.percent)}}):e._e(),e._v(" "),t("span",{staticClass:"txt",domProps:{innerHTML:e._s(a.value)}})]),e._v(" "),t("span",{class:{bg:!0,selected:e.mostVotes==a.votes},style:{width:a.percent}})]:[t("div",{class:{"ans-no-vote noselect":!0,active:a.selected},on:{click:function(t){return t.preventDefault(),e.handleVote(a)}}},[t("span",{staticClass:"txt",domProps:{innerHTML:e._s(a.value)}})])]],2)})),e._v(" "),!e.isLoading&&e.myAnswer?t(r.a,{staticClass:"redo-btn",attrs:{disabled:e.isLoading,text:""},on:{click:e.resetAnswer}},[t(l.a,[e._v("\n                mdi-arrow-u-left-top-bold\n                ")])],1):e._e()],2),e._v(" "),e.hasMyAnswer?t("div",{staticClass:"votes",domProps:{textContent:e._s(e.totalVotesFormatted+" votes")}}):e._e(),e._v(" "),!e.hasMyAnswer&&e.isMultiChoice&&e.calcAnswers.filter((function(a){return a.selected})).length>0?[t("div",{staticClass:"d-flex justify-center",staticStyle:{width:"100%"}},[t(r.a,{staticStyle:{margin:"0 auto"},attrs:{disabled:e.isLoading,color:"primary",dark:""},domProps:{textContent:e._s(e.submitButtonText)},on:{click:function(t){return t.preventDefault(),e.handleMultiple.apply(null,arguments)}}})],1)]:e._e()],2)],1)}),[],!1,null,null,null);t.default=component.exports},718:function(e,t,n){"use strict";n(643)},719:function(e,t,n){var r=n(25)(!1);r.push([e.i,'.vue-poll{font-family:"Avenir",Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:#2c3e50;position:relative;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center}.vue-poll .vue-poll-inner{max-width:600px;width:calc(100% - 20px);position:relative}.vue-poll .vue-poll-inner .redo-btn{color:#8899a6;position:absolute;bottom:0;right:0}.vue-poll .noselect{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.vue-poll .qst{font-weight:400}.vue-poll .ans-cnt{margin:20px 0}.vue-poll .ans-cnt .ans{position:relative;margin-top:10px}.vue-poll .ans-cnt .ans:first-child{margin-top:0}.vue-poll .ans-cnt .ans-no-vote{text-align:center;border:2px solid #77c7f7;box-sizing:border-box;border-radius:5px;cursor:pointer;padding:5px 0;transition:background .2s ease-in-out;-webkit-transition:background .2s ease-in-out;-moz-transition:background .2s ease-in-out}.vue-poll .ans-cnt .ans-no-vote .txt{color:#77c7f7;transition:color .2s ease-in-out;-webkit-transition:color .2s ease-in-out;-moz-transition:color .2s ease-in-out}.vue-poll .ans-cnt .ans-no-vote.active{background:#77c7f7}.vue-poll .ans-cnt .ans-no-vote.active .txt{color:#fff}.vue-poll .ans-cnt .ans-voted{display:flex;padding:5px 0}.vue-poll .ans-cnt .ans-voted .percent,.vue-poll .ans-cnt .ans-voted .txt{position:relative;z-index:1}.vue-poll .ans-cnt .ans-voted .percent{font-weight:700;min-width:51px;display:inline-block;margin:0 10px}.vue-poll .ans-cnt .ans-voted.selected .txt:after{content:"âœ”";margin-left:10px}.vue-poll .ans-cnt .ans .bg{position:absolute;width:0;top:0;left:0;bottom:0;z-index:0;background-color:#e1e8ed;border-top-left-radius:5px;border-bottom-left-radius:5px;transition:all .3s cubic-bezier(.5,1.2,.5,1.2);-webkit-transition:all .3s cubic-bezier(.5,1.2,.5,1.2);-moz-transition:all .3s cubic-bezier(.5,1.2,.5,1.2)}.vue-poll .ans-cnt .ans .bg.selected{background-color:#77c7f7}.vue-poll .votes{font-size:14px;color:#8899a6}.vue-poll .submit{display:block;text-align:center;margin:0 auto;max-width:80px;text-decoration:none;background-color:#2196f3;color:#fff;padding:10px 25px;border-radius:5px}',""]),e.exports=r},997:function(e,t,n){"use strict";n.r(t);n(17),n(15),n(16),n(22),n(23);var r=n(2),o=n(20),l=(n(39),n(8),n(14),n(61),n(561)),c=n(666);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v={components:{Spinner:l.default,GloberPoll:c.default},props:{id:{type:String,required:!0}},data:function(){return{myAnswer:null,error:null,success:null,poll:null,pageLoaded:!1,loadingFailed:!1,pollAnswers:[]}},computed:{user:function(){return this.$store.state.authUser},isChoice:function(){return"multi-choice"===this.poll.type||"single-choice"===this.poll.type}},mounted:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.user){t.next=3;break}return t.next=3,e.getInfo();case 3:case"end":return t.stop()}}),t)})))()},watch:{$route:function(e,t){var n=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("tools-polls-id"!==e.name){t.next=3;break}return t.next=3,n.getInfo();case 3:case"end":return t.stop()}}),t)})))()}},methods:{getInfo:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,r,data,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$fire.firestore.collection("polls").doc(e.id).get();case 3:if(!(n=t.sent).exists){t.next=15;break}if(r=n.id,data=n.data(),e.poll=f({id:r},data),!e.isChoice){t.next=13;break}return t.next=11,e.$fire.firestore.collection("pollAnswers").where("pollId","==",e.poll.id).get();case 11:(o=t.sent).size&&o.docs.forEach((function(t){var n=t.id,data=t.data();data.userId===e.user.uid?e.myAnswer=f({id:n},data):e.pollAnswers.push(f({id:n},data))}));case 13:t.next=17;break;case 15:return e.$nuxt.error({statusCode:404,message:"Poll not found"}),t.abrupt("return");case 17:t.next=23;break;case 19:return t.prev=19,t.t0=t.catch(0),e.$nuxt.error({statusCode:404,message:"Poll not found"}),t.abrupt("return");case 23:e.pageLoaded=!0;case 24:case"end":return t.stop()}}),t,null,[[0,19]])})))()}}},h=n(65),component=Object(h.a)(v,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"poll-container"},[e.pageLoaded?t("div",{staticClass:"poll-container-inner"},[t("GloberPoll",{attrs:{myOriginalAnswer:e.myAnswer,pollAnswers:e.pollAnswers,poll:e.poll}})],1):e._e()])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{GloberPoll:n(666).default})}}]);