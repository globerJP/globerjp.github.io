(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{1303:function(e,t,o){"use strict";o.r(t),function(e){function n(e,t){const map=Object.create(null),o=e.split(",");for(let i=0;i<o.length;i++)map[o[i]]=!0;return t?e=>!!map[e.toLowerCase()]:e=>!!map[e]}o.d(t,"VueAdvancedChat",(function(){return l_})),o.d(t,"register",(function(){return d_}));const r=()=>{},l=Object.assign,c=Object.prototype.hasOwnProperty,d=(e,t)=>c.call(e,t),m=Array.isArray,h=e=>"[object Map]"===y(e),f=e=>"symbol"==typeof e,_=e=>null!==e&&"object"==typeof e,v=Object.prototype.toString,y=e=>v.call(e),x=e=>"string"==typeof e&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,w=(e,t)=>!Object.is(e,t);let k;class S{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&k&&(this.parent=k,this.index=(k.scopes||(k.scopes=[])).push(this)-1)}run(e){if(this.active){const t=k;try{return k=this,e()}finally{k=t}}}on(){k=this}off(){k=this.parent}stop(e){if(this.active){let i,t;for(i=0,t=this.effects.length;i<t;i++)this.effects[i].stop();for(i=0,t=this.cleanups.length;i<t;i++)this.cleanups[i]();if(this.scopes)for(i=0,t=this.scopes.length;i<t;i++)this.scopes[i].stop(!0);if(this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.active=!1}}}const M=e=>{const t=new Set(e);return t.w=0,t.n=0,t},R=e=>(e.w&B)>0,A=e=>(e.n&B)>0,E=new WeakMap;let T=0,B=1;let O;const C=Symbol(""),I=Symbol("");class j{constructor(e,t=null,o){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,function(e,t=k){t&&t.active&&t.effects.push(e)}(this,o)}run(){if(!this.active)return this.fn();let e=O,t=P;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=O,O=this,P=!0,B=1<<++T,T<=30?(({deps:e})=>{if(e.length)for(let i=0;i<e.length;i++)e[i].w|=B})(this):L(this),this.fn()}finally{T<=30&&(e=>{const{deps:t}=e;if(t.length){let o=0;for(let i=0;i<t.length;i++){const n=t[i];R(n)&&!A(n)?n.delete(e):t[o++]=n,n.w&=~B,n.n&=~B}t.length=o}})(this),B=1<<--T,O=this.parent,P=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){O===this?this.deferStop=!0:this.active&&(L(this),this.onStop&&this.onStop(),this.active=!1)}}function L(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}let P=!0;const N=[];function H(){N.push(P),P=!1}function $(){const e=N.pop();P=void 0===e||e}function track(e,t,o){if(P&&O){let t=E.get(e);t||E.set(e,t=new Map);let n=t.get(o);n||t.set(o,n=M()),F(n)}}function F(e,t){let o=!1;T<=30?A(e)||(e.n|=B,o=!R(e)):o=!e.has(O),o&&(e.add(O),O.deps.push(e))}function D(e,t,o,n,r,l){const c=E.get(e);if(!c)return;let d=[];if("clear"===t)d=[...c.values()];else if("length"===o&&m(e))c.forEach(((e,t)=>{("length"===t||t>=n)&&d.push(e)}));else switch(void 0!==o&&d.push(c.get(o)),t){case"add":m(e)?x(o)&&d.push(c.get("length")):(d.push(c.get(C)),h(e)&&d.push(c.get(I)));break;case"delete":m(e)||(d.push(c.get(C)),h(e)&&d.push(c.get(I)));break;case"set":h(e)&&d.push(c.get(C))}if(1===d.length)d[0]&&U(d[0]);else{const e=[];for(const t of d)t&&e.push(...t);U(M(e))}}function U(e,t){const o=m(e)?e:[...e];for(const e of o)e.computed&&V(e);for(const e of o)e.computed||V(e)}function V(e,t){(e!==O||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const z=n("__proto__,__v_isRef,__isVue"),X=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(f)),Y=Q(),K=Q(!1,!0),G=Q(!0),Z=W();function W(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const o=Pe(this);for(let i=0,e=this.length;i<e;i++)track(o,0,i+"");const n=o[t](...e);return-1===n||!1===n?o[t](...e.map(Pe)):n}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){H();const o=Pe(this)[t].apply(this,e);return $(),o}})),e}function Q(e=!1,t=!1){return function(o,n,r){if("__v_isReactive"===n)return!e;if("__v_isReadonly"===n)return e;if("__v_isShallow"===n)return t;if("__v_raw"===n&&r===(e?t?Ae:Re:t?Me:Se).get(o))return o;const l=m(o);if(!e&&l&&d(Z,n))return Reflect.get(Z,n,r);const c=Reflect.get(o,n,r);return(f(n)?X.has(n):z(n))?c:(e||track(o,0,n),t?c:Fe(c)?l&&x(n)?c:c.value:_(c)?e?Be(c):Te(c):c)}}function J(e=!1){return function(t,o,n,r){let l=t[o];if(Ie(l)&&Fe(l)&&!Fe(n))return!1;if(!e&&!Ie(n)&&(je(n)||(n=Pe(n),l=Pe(l)),!m(t)&&Fe(l)&&!Fe(n)))return l.value=n,!0;const c=m(t)&&x(o)?Number(o)<t.length:d(t,o),h=Reflect.set(t,o,n,r);return t===Pe(r)&&(c?w(n,l)&&D(t,"set",o,n):D(t,"add",o,n)),h}}const ee={get:Y,set:J(),deleteProperty:function(e,t){const o=d(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&o&&D(e,"delete",t,void 0),n},has:function(e,t){const o=Reflect.has(e,t);return f(t)&&X.has(t)||track(e,0,t),o},ownKeys:function(e){return track(e,0,m(e)?"length":C),Reflect.ownKeys(e)}},te={get:G,set:(e,t)=>!0,deleteProperty:(e,t)=>!0},se=l({},ee,{get:K,set:J(!0)}),ae=e=>e,oe=e=>Reflect.getPrototypeOf(e);function ne(e,t,o=!1,n=!1){const r=Pe(e=e.__v_raw),l=Pe(t);o||(t!==l&&track(r,0,t),track(r,0,l));const{has:c}=oe(r),d=n?ae:o?$e:He;return c.call(r,t)?d(e.get(t)):c.call(r,l)?d(e.get(l)):void(e!==r&&e.get(t))}function re(e,t=!1){const o=this.__v_raw,n=Pe(o),r=Pe(e);return t||(e!==r&&track(n,0,e),track(n,0,r)),e===r?o.has(e):o.has(e)||o.has(r)}function ie(e,t=!1){return e=e.__v_raw,!t&&track(Pe(e),0,C),Reflect.get(e,"size",e)}function le(e){e=Pe(e);const t=Pe(this);return oe(t).has.call(t,e)||(t.add(e),D(t,"add",e,e)),this}function ce(e,t){t=Pe(t);const o=Pe(this),{has:n,get:r}=oe(o);let l=n.call(o,e);l||(e=Pe(e),l=n.call(o,e));const c=r.call(o,e);return o.set(e,t),l?w(t,c)&&D(o,"set",e,t):D(o,"add",e,t),this}function de(e){const t=Pe(this),{has:o,get:n}=oe(t);let r=o.call(t,e);r||(e=Pe(e),r=o.call(t,e)),n&&n.call(t,e);const l=t.delete(e);return r&&D(t,"delete",e,void 0),l}function ue(){const e=Pe(this),t=0!==e.size,o=e.clear();return t&&D(e,"clear",void 0,void 0),o}function me(e,t){return function(o,n){const r=this,l=r.__v_raw,c=Pe(l),d=t?ae:e?$e:He;return!e&&track(c,0,C),l.forEach(((e,t)=>o.call(n,d(e),d(t),r)))}}function pe(e,t,o){return function(...n){const r=this.__v_raw,l=Pe(r),c=h(l),d="entries"===e||e===Symbol.iterator&&c,m="keys"===e&&c,f=r[e](...n),_=o?ae:t?$e:He;return!t&&track(l,0,m?I:C),{next(){const{value:e,done:t}=f.next();return t?{value:e,done:t}:{value:d?[_(e[0]),_(e[1])]:_(e),done:t}},[Symbol.iterator](){return this}}}}function he(e){return function(...t){return"delete"!==e&&this}}function fe(){const e={get(e){return ne(this,e)},get size(){return ie(this)},has:re,add:le,set:ce,delete:de,clear:ue,forEach:me(!1,!1)},t={get(e){return ne(this,e,!1,!0)},get size(){return ie(this)},has:re,add:le,set:ce,delete:de,clear:ue,forEach:me(!1,!0)},o={get(e){return ne(this,e,!0)},get size(){return ie(this,!0)},has(e){return re.call(this,e,!0)},add:he("add"),set:he("set"),delete:he("delete"),clear:he("clear"),forEach:me(!0,!1)},n={get(e){return ne(this,e,!0,!0)},get size(){return ie(this,!0)},has(e){return re.call(this,e,!0)},add:he("add"),set:he("set"),delete:he("delete"),clear:he("clear"),forEach:me(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((r=>{e[r]=pe(r,!1,!1),o[r]=pe(r,!0,!1),t[r]=pe(r,!1,!0),n[r]=pe(r,!0,!0)})),[e,o,t,n]}const[ge,_e,ve,be]=fe();function ye(e,t){const o=t?e?be:ve:e?_e:ge;return(t,n,r)=>"__v_isReactive"===n?!e:"__v_isReadonly"===n?e:"__v_raw"===n?t:Reflect.get(d(o,n)&&n in t?o:t,n,r)}const xe={get:ye(!1,!1)},we={get:ye(!1,!0)},ke={get:ye(!0,!1)},Se=new WeakMap,Me=new WeakMap,Re=new WeakMap,Ae=new WeakMap;function Ee(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((e=>y(e).slice(8,-1))(e))}function Te(e){return Ie(e)?e:Oe(e,!1,ee,xe,Se)}function Be(e){return Oe(e,!0,te,ke,Re)}function Oe(e,t,o,n,r){if(!_(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const l=r.get(e);if(l)return l;const c=Ee(e);if(0===c)return e;const d=new Proxy(e,2===c?n:o);return r.set(e,d),d}function Ce(e){return Ie(e)?Ce(e.__v_raw):!(!e||!e.__v_isReactive)}function Ie(e){return!(!e||!e.__v_isReadonly)}function je(e){return!(!e||!e.__v_isShallow)}function Le(e){return Ce(e)||Ie(e)}function Pe(e){const t=e&&e.__v_raw;return t?Pe(t):e}function Ne(e){return((e,t,o)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:o})})(e,"__v_skip",!0),e}const He=e=>_(e)?Te(e):e,$e=e=>_(e)?Be(e):e;function Fe(e){return!(!e||!0!==e.__v_isRef)}const De={get:(e,t,o)=>{return Fe(n=Reflect.get(e,t,o))?n.value:n;var n},set:(e,t,o,n)=>{const r=e[t];return Fe(r)&&!Fe(o)?(r.value=o,!0):Reflect.set(e,t,o,n)}};function Ue(e){return Ce(e)?e:new Proxy(e,De)}class qe{constructor(e,t,o,n){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new j(e,(()=>{var e;this._dirty||(this._dirty=!0,(e=Pe(e=this)).dep&&U(e.dep))})),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=o}get value(){const e=Pe(this);var t;return t=e,P&&O&&F((t=Pe(t)).dep||(t.dep=M())),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function Ve(e,t){const map=Object.create(null),o=e.split(",");for(let i=0;i<o.length;i++)map[o[i]]=!0;return t?e=>!!map[e.toLowerCase()]:e=>!!map[e]}function ze(e){if(mt(e)){const t={};for(let i=0;i<e.length;i++){const o=e[i],n=gt(o)?Ke(o):ze(o);if(n)for(const e in n)t[e]=n[e]}return t}return gt(e)||_t(e)?e:void 0}const Xe=/;(?![^(]*\))/g,Ye=/:(.+)/;function Ke(e){const t={};return e.split(Xe).forEach((e=>{if(e){const o=e.split(Ye);o.length>1&&(t[o[0].trim()]=o[1].trim())}})),t}function Ge(e){let t="";if(gt(e))t=e;else if(mt(e))for(let i=0;i<e.length;i++){const o=Ge(e[i]);o&&(t+=o+" ")}else if(_t(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}function Ze(e){if(!e)return null;let{class:t,style:style}=e;return t&&!gt(t)&&(e.class=Ge(t)),style&&(e.style=ze(style)),e}const We=e=>gt(e)?e:null==e?"":mt(e)||_t(e)&&(e.toString===bt||!ft(e.toString))?JSON.stringify(e,Qe,2):String(e),Qe=(e,t)=>t&&t.__v_isRef?Qe(e,t.value):pt(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,o])=>(e[`${t} =>`]=o,e)),{})}:ht(t)?{[`Set(${t.size})`]:[...t.values()]}:!_t(t)||mt(t)||xt(t)?t:String(t),Je={},et=[],tt=()=>{},st=()=>!1,at=/^on[^a-z]/,ot=e=>at.test(e),nt=e=>e.startsWith("onUpdate:"),it=Object.assign,lt=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},ct=Object.prototype.hasOwnProperty,ut=(e,t)=>ct.call(e,t),mt=Array.isArray,pt=e=>"[object Map]"===yt(e),ht=e=>"[object Set]"===yt(e),ft=e=>"function"==typeof e,gt=e=>"string"==typeof e,_t=e=>null!==e&&"object"==typeof e,vt=e=>_t(e)&&ft(e.then)&&ft(e.catch),bt=Object.prototype.toString,yt=e=>bt.call(e),xt=e=>"[object Object]"===yt(e),wt=Ve(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),kt=e=>{const t=Object.create(null);return o=>t[o]||(t[o]=e(o))},St=/-(\w)/g,Mt=kt((e=>e.replace(St,((e,t)=>t?t.toUpperCase():"")))),Rt=/\B([A-Z])/g,At=kt((e=>e.replace(Rt,"-$1").toLowerCase())),Et=kt((e=>e.charAt(0).toUpperCase()+e.slice(1))),Tt=kt((e=>e?`on${Et(e)}`:"")),Bt=(e,t)=>!Object.is(e,t),Ot=(e,t)=>{for(let i=0;i<e.length;i++)e[i](t)},Ct=(e,t,o)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:o})},It=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let jt;function Lt(e,t,o,n){let r;try{r=n?e(...n):e()}catch(e){Nt(e,t,o)}return r}function Pt(e,t,o,n){if(ft(e)){const r=Lt(e,t,o,n);return r&&vt(r)&&r.catch((e=>{Nt(e,t,o)})),r}const r=[];for(let i=0;i<e.length;i++)r.push(Pt(e[i],t,o,n));return r}function Nt(e,t,o,n=!0){t&&t.vnode;if(t){let n=t.parent;const r=t.proxy,l=o;for(;n;){const t=n.ec;if(t)for(let i=0;i<t.length;i++)if(!1===t[i](e,r,l))return;n=n.parent}const c=t.appContext.config.errorHandler;if(c)return void Lt(c,null,10,[e,r,l])}!function(e,t,o,n=!0){console.error(e)}(e,0,0,n)}let Ht=!1,$t=!1;const Ft=[];let Dt=0;const Ut=[];let qt=null,Vt=0;const zt=[];let Xt=null,Yt=0;const Kt=Promise.resolve();let Gt=null,Zt=null;function Wt(e){const t=Gt||Kt;return e?t.then(this?e.bind(this):e):t}function Qt(e){Ft.length&&Ft.includes(e,Ht&&e.allowRecurse?Dt+1:Dt)||e===Zt||(null==e.id?Ft.push(e):Ft.splice(function(e){let t=Dt+1,o=Ft.length;for(;t<o;){const n=t+o>>>1;as(Ft[n])<e?t=n+1:o=n}return t}(e.id),0,e),Jt())}function Jt(){Ht||$t||($t=!0,Gt=Kt.then(os))}function es(e,t,o,n){mt(e)?o.push(...e):t&&t.includes(e,e.allowRecurse?n+1:n)||o.push(e),Jt()}function ts(e,t=null){if(Ut.length){for(Zt=t,qt=[...new Set(Ut)],Ut.length=0,Vt=0;Vt<qt.length;Vt++)qt[Vt]();qt=null,Vt=0,Zt=null,ts(e,t)}}function ss(e){if(ts(),zt.length){const e=[...new Set(zt)];if(zt.length=0,Xt)return void Xt.push(...e);for(Xt=e,Xt.sort(((a,b)=>as(a)-as(b))),Yt=0;Yt<Xt.length;Yt++)Xt[Yt]();Xt=null,Yt=0}}const as=e=>null==e.id?1/0:e.id;function os(e){$t=!1,Ht=!0,ts(e),Ft.sort(((a,b)=>as(a)-as(b)));try{for(Dt=0;Dt<Ft.length;Dt++){const e=Ft[Dt];e&&!1!==e.active&&Lt(e,null,14)}}finally{Dt=0,Ft.length=0,ss(),Ht=!1,Gt=null,(Ft.length||Ut.length||zt.length)&&os(e)}}function ns(e,t,...o){if(e.isUnmounted)return;const n=e.vnode.props||Je;let r=o;const l=t.startsWith("update:"),c=l&&t.slice(7);if(c&&c in n){const e=`${"modelValue"===c?"model":c}Modifiers`,{number:t,trim:l}=n[e]||Je;l&&(r=o.map((a=>a.trim()))),t&&(r=o.map(It))}let d,m=n[d=Tt(t)]||n[d=Tt(Mt(t))];!m&&l&&(m=n[d=Tt(At(t))]),m&&Pt(m,e,6,r);const h=n[d+"Once"];if(h){if(e.emitted){if(e.emitted[d])return}else e.emitted={};e.emitted[d]=!0,Pt(h,e,6,r)}}function rs(e,t,o=!1){const n=t.emitsCache,r=n.get(e);if(void 0!==r)return r;const l=e.emits;let c={},d=!1;if(!ft(e)){const n=e=>{const o=rs(e,t,!0);o&&(d=!0,it(c,o))};!o&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}return l||d?(mt(l)?l.forEach((e=>c[e]=null)):it(c,l),n.set(e,c),c):(n.set(e,null),null)}function is(e,t){return!(!e||!ot(t))&&(t=t.slice(2).replace(/Once$/,""),ut(e,t[0].toLowerCase()+t.slice(1))||ut(e,At(t))||ut(e,t))}let ls=null,cs=null;function ds(e){const t=ls;return ls=e,cs=e&&e.type.__scopeId||null,t}function us(e,t=ls,o){if(!t)return e;if(e._n)return e;const n=(...o)=>{n._d&&Wa(-1);const r=ds(t),l=e(...o);return ds(r),n._d&&Wa(1),l};return n._n=!0,n._c=!0,n._d=!0,n}function ms(e){const{type:t,vnode:o,proxy:n,withProxy:r,props:l,propsOptions:[c],slots:d,attrs:m,emit:h,render:f,renderCache:_,data:data,setupState:v,ctx:y,inheritAttrs:x}=e;let w,k;const S=ds(e);try{if(4&o.shapeFlag){const e=r||n;w=po(f.call(e,e,_,l,v,data,y)),k=m}else{const e=t;0,w=po(e.length>1?e(l,{attrs:m,slots:d,emit:h}):e(l,null)),k=t.props?m:ps(m)}}catch(t){Ya.length=0,Nt(t,e,1),w=io(za)}let M=w;if(k&&!1!==x){const e=Object.keys(k),{shapeFlag:t}=M;e.length&&7&t&&(c&&e.some(nt)&&(k=hs(k,c)),M=co(M,k))}return o.dirs&&(M=co(M),M.dirs=M.dirs?M.dirs.concat(o.dirs):o.dirs),o.transition&&(M.transition=o.transition),w=M,ds(S),w}const ps=e=>{let t;for(const o in e)("class"===o||"style"===o||ot(o))&&((t||(t={}))[o]=e[o]);return t},hs=(e,t)=>{const o={};for(const n in e)nt(n)&&n.slice(9)in t||(o[n]=e[n]);return o};function fs(e,t,o){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const r=n[i];if(t[r]!==e[r]&&!is(o,r))return!0}return!1}function gs(e,t,o=!1){const n=yo||ls;if(n){const r=null==n.parent?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(r&&e in r)return r[e];if(arguments.length>1)return o&&ft(t)?t.call(n.proxy):t}}const _s={};function vs(source,e,t){return bs(source,e,t)}function bs(source,e,{immediate:t,deep:o,flush:n,onTrack:r,onTrigger:l}=Je){const c=yo;let d,m,h=!1,f=!1;if(Fe(source)?(d=()=>source.value,h=je(source)):Ce(source)?(d=()=>source,o=!0):mt(source)?(f=!0,h=source.some((s=>Ce(s)||je(s))),d=()=>source.map((s=>Fe(s)?s.value:Ce(s)?ws(s):ft(s)?Lt(s,c,2):void 0))):d=ft(source)?e?()=>Lt(source,c,2):()=>{if(!c||!c.isUnmounted)return m&&m(),Pt(source,c,3,[_])}:tt,e&&o){const e=d;d=()=>ws(e())}let _=e=>{m=w.onStop=()=>{Lt(e,c,4)}};if(Mo)return _=tt,e?t&&Pt(e,c,3,[d(),f?[]:void 0,_]):d(),tt;let v=f?[]:_s;const y=()=>{if(w.active)if(e){const t=w.run();(o||h||(f?t.some(((e,i)=>Bt(e,v[i]))):Bt(t,v)))&&(m&&m(),Pt(e,c,3,[t,v===_s?void 0:v,_]),v=t)}else w.run()};let x;y.allowRecurse=!!e,x="sync"===n?y:"post"===n?()=>$a(y,c&&c.suspense):()=>function(e){es(e,qt,Ut,Vt)}(y);const w=new j(d,x);return e?t?y():v=w.run():"post"===n?$a(w.run.bind(w),c&&c.suspense):w.run(),()=>{w.stop(),c&&c.scope&&lt(c.scope.effects,w)}}function ys(source,e,t){const o=this.proxy,n=gt(source)?source.includes(".")?xs(o,source):()=>o[source]:source.bind(o,o);let r;ft(e)?r=e:(r=e.handler,t=e);const l=yo;wo(this);const c=bs(n,r.bind(o),t);return l?wo(l):ko(),c}function xs(e,path){const t=path.split(".");return()=>{let o=e;for(let i=0;i<t.length&&o;i++)o=o[t[i]];return o}}function ws(e,t){if(!_t(e)||e.__v_skip)return e;if((t=t||new Set).has(e))return e;if(t.add(e),Fe(e))ws(e.value,t);else if(mt(e))for(let i=0;i<e.length;i++)ws(e[i],t);else if(ht(e)||pt(e))e.forEach((e=>{ws(e,t)}));else if(xt(e))for(const o in e)ws(e[o],t);return e}function ks(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ds((()=>{e.isMounted=!0})),Vs((()=>{e.isUnmounting=!0})),e}const Ss=[Function,Array],Ms={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ss,onEnter:Ss,onAfterEnter:Ss,onEnterCancelled:Ss,onBeforeLeave:Ss,onLeave:Ss,onAfterLeave:Ss,onLeaveCancelled:Ss,onBeforeAppear:Ss,onAppear:Ss,onAfterAppear:Ss,onAppearCancelled:Ss},setup(e,{slots:t}){const o=xo(),n=ks();let r;return()=>{const l=t.default&&Os(t.default(),!0);if(!l||!l.length)return;let c=l[0];if(l.length>1)for(const e of l)if(e.type!==za){c=e;break}const d=Pe(e),{mode:m}=d;if(n.isLeaving)return Es(c);const h=Ts(c);if(!h)return Es(c);const f=As(h,d,n,o);Bs(h,f);const _=o.subTree,v=_&&Ts(_);let y=!1;const{getTransitionKey:x}=h.type;if(x){const e=x();void 0===r?r=e:e!==r&&(r=e,y=!0)}if(v&&v.type!==za&&(!so(h,v)||y)){const e=As(v,d,n,o);if(Bs(v,e),"out-in"===m)return n.isLeaving=!0,e.afterLeave=()=>{n.isLeaving=!1,o.update()},Es(c);"in-out"===m&&h.type!==za&&(e.delayLeave=(e,t,o)=>{Rs(n,v)[String(v.key)]=v,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete f.delayedLeave},f.delayedLeave=o})}return c}}};function Rs(e,t){const{leavingVNodes:o}=e;let n=o.get(t.type);return n||(n=Object.create(null),o.set(t.type,n)),n}function As(e,t,o,n){const{appear:r,mode:l,persisted:c=!1,onBeforeEnter:d,onEnter:m,onAfterEnter:h,onEnterCancelled:f,onBeforeLeave:_,onLeave:v,onAfterLeave:y,onLeaveCancelled:x,onBeforeAppear:w,onAppear:k,onAfterAppear:S,onAppearCancelled:M}=t,R=String(e.key),A=Rs(o,e),E=(e,t)=>{e&&Pt(e,n,9,t)},T=(e,t)=>{const o=t[1];E(e,t),mt(e)?e.every((e=>e.length<=1))&&o():e.length<=1&&o()},B={mode:l,persisted:c,beforeEnter(t){let n=d;if(!o.isMounted){if(!r)return;n=w||d}t._leaveCb&&t._leaveCb(!0);const l=A[R];l&&so(e,l)&&l.el._leaveCb&&l.el._leaveCb(),E(n,[t])},enter(e){let t=m,n=h,l=f;if(!o.isMounted){if(!r)return;t=k||m,n=S||h,l=M||f}let c=!1;const d=e._enterCb=t=>{c||(c=!0,E(t?l:n,[e]),B.delayedLeave&&B.delayedLeave(),e._enterCb=void 0)};t?T(t,[e,d]):d()},leave(t,n){const r=String(e.key);if(t._enterCb&&t._enterCb(!0),o.isUnmounting)return n();E(_,[t]);let l=!1;const c=t._leaveCb=o=>{l||(l=!0,n(),E(o?x:y,[t]),t._leaveCb=void 0,A[r]===e&&delete A[r])};A[r]=e,v?T(v,[t,c]):c()},clone:e=>As(e,t,o,n)};return B}function Es(e){if(Is(e))return(e=co(e)).children=null,e}function Ts(e){return Is(e)?e.children?e.children[0]:void 0:e}function Bs(e,t){6&e.shapeFlag&&e.component?Bs(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Os(e,t=!1,o){let n=[],r=0;for(let i=0;i<e.length;i++){let l=e[i];const c=null==o?l.key:String(o)+String(null!=l.key?l.key:i);l.type===qa?(128&l.patchFlag&&r++,n=n.concat(Os(l.children,t,c))):(t||l.type!==za)&&n.push(null!=c?co(l,{key:c}):l)}if(r>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}const Cs=i=>!!i.type.__asyncLoader,Is=e=>e.type.__isKeepAlive;function js(e,t){Ps(e,"a",t)}function Ls(e,t){Ps(e,"da",t)}function Ps(e,t,o=yo){const n=e.__wdc||(e.__wdc=()=>{let t=o;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(Hs(t,n,o),o){let e=o.parent;for(;e&&e.parent;)Is(e.parent.vnode)&&Ns(n,t,o,e),e=e.parent}}function Ns(e,t,o,n){const r=Hs(t,e,n,!0);zs((()=>{lt(n[t],r)}),o)}function Hs(e,t,o=yo,n=!1){if(o){const r=o[e]||(o[e]=[]),l=t.__weh||(t.__weh=(...n)=>{if(o.isUnmounted)return;H(),wo(o);const r=Pt(t,o,e,n);return ko(),$(),r});return n?r.unshift(l):r.push(l),l}}const $s=e=>(t,o=yo)=>(!Mo||"sp"===e)&&Hs(e,t,o),Fs=$s("bm"),Ds=$s("m"),Us=$s("bu"),qs=$s("u"),Vs=$s("bum"),zs=$s("um"),Xs=$s("sp"),Ys=$s("rtg"),Ks=$s("rtc");function Gs(e,t=yo){Hs("ec",e,t)}function Zs(e,t){const o=ls;if(null===o)return e;const n=Eo(o)||o.proxy,r=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[e,o,l,c=Je]=t[i];ft(e)&&(e={mounted:e,updated:e}),e.deep&&ws(o),r.push({dir:e,instance:n,value:o,oldValue:void 0,arg:l,modifiers:c})}return e}function Ws(e,t,o,n){const r=e.dirs,l=t&&t.dirs;for(let i=0;i<r.length;i++){const c=r[i];l&&(c.oldValue=l[i].value);let d=c.dir[n];d&&(H(),Pt(d,o,8,[e.el,c,e,t]),$())}}const Qs="components";function Js(e,t){return sa(Qs,e,!0,t)||e}const ea=Symbol();function ta(e){return sa("directives",e)}function sa(e,t,o=!0,n=!1){const r=ls||yo;if(r){const o=r.type;if(e===Qs){const e=function(e,t=!0){return ft(e)?e.displayName||e.name:e.name||t&&e.__name}(o,!1);if(e&&(e===t||e===Mt(t)||e===Et(Mt(t))))return o}const l=aa(r[e]||o[e],t)||aa(r.appContext[e],t);return!l&&n?o:l}}function aa(e,t){return e&&(e[t]||e[Mt(t)]||e[Et(Mt(t))])}function oa(source,e,t,o){let n;const r=t&&t[o];if(mt(source)||gt(source)){n=new Array(source.length);for(let i=0,t=source.length;i<t;i++)n[i]=e(source[i],i,void 0,r&&r[i])}else if("number"==typeof source){n=new Array(source);for(let i=0;i<source;i++)n[i]=e(i+1,i,void 0,r&&r[i])}else if(_t(source))if(source[Symbol.iterator])n=Array.from(source,((t,i)=>e(t,i,void 0,r&&r[i])));else{const t=Object.keys(source);n=new Array(t.length);for(let i=0,o=t.length;i<o;i++){const o=t[i];n[i]=e(source[o],o,i,r&&r[i])}}else n=[];return t&&(t[o]=n),n}function na(e,t){for(let i=0;i<t.length;i++){const slot=t[i];if(mt(slot))for(let t=0;t<slot.length;t++)e[slot[t].name]=slot[t].fn;else slot&&(e[slot.name]=slot.fn)}return e}function ra(e,t,o={},n,r){if(ls.isCE||ls.parent&&Cs(ls.parent)&&ls.parent.isCE)return io("slot","default"===t?null:{name:t},n&&n());let slot=e[t];slot&&slot._c&&(slot._d=!1),Ga();const l=slot&&ia(slot(o)),c=eo(qa,{key:o.key||`_${t}`},l||(n?n():[]),l&&1===e._?64:-2);return!r&&c.scopeId&&(c.slotScopeIds=[c.scopeId+"-s"]),slot&&slot._c&&(slot._d=!0),c}function ia(e){return e.some((e=>!to(e)||e.type!==za&&!(e.type===qa&&!ia(e.children))))?e:null}const la=i=>i?So(i)?Eo(i)||i.proxy:la(i.parent):null,ca=it(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>la(i.parent),$root:i=>la(i.root),$emit:i=>i.emit,$options:i=>fa(i),$forceUpdate:i=>i.f||(i.f=()=>Qt(i.update)),$nextTick:i=>i.n||(i.n=Wt.bind(i.proxy)),$watch:i=>ys.bind(i)}),da={get({_:e},t){const{ctx:o,setupState:n,data:data,props:r,accessCache:l,type:c,appContext:d}=e;let m;if("$"!==t[0]){const c=l[t];if(void 0!==c)switch(c){case 1:return n[t];case 2:return data[t];case 4:return o[t];case 3:return r[t]}else{if(n!==Je&&ut(n,t))return l[t]=1,n[t];if(data!==Je&&ut(data,t))return l[t]=2,data[t];if((m=e.propsOptions[0])&&ut(m,t))return l[t]=3,r[t];if(o!==Je&&ut(o,t))return l[t]=4,o[t];ua&&(l[t]=0)}}const h=ca[t];let f,_;return h?("$attrs"===t&&track(e,0,t),h(e)):(f=c.__cssModules)&&(f=f[t])?f:o!==Je&&ut(o,t)?(l[t]=4,o[t]):(_=d.config.globalProperties,ut(_,t)?_[t]:void 0)},set({_:e},t,o){const{data:data,setupState:n,ctx:r}=e;return n!==Je&&ut(n,t)?(n[t]=o,!0):data!==Je&&ut(data,t)?(data[t]=o,!0):!ut(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(r[t]=o,!0))},has({_:{data:data,setupState:e,accessCache:t,ctx:o,appContext:n,propsOptions:r}},l){let c;return!!t[l]||data!==Je&&ut(data,l)||e!==Je&&ut(e,l)||(c=r[0])&&ut(c,l)||ut(o,l)||ut(ca,l)||ut(n.config.globalProperties,l)},defineProperty(e,t,o){return null!=o.get?e._.accessCache[t]=0:ut(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};let ua=!0;function ma(e){const t=fa(e),o=e.proxy,n=e.ctx;ua=!1,t.beforeCreate&&pa(t.beforeCreate,e,"bc");const{data:r,computed:l,methods:c,watch:d,provide:m,inject:h,created:f,beforeMount:_,mounted:v,beforeUpdate:y,updated:x,activated:w,deactivated:k,beforeDestroy:S,beforeUnmount:M,destroyed:R,unmounted:A,render:E,renderTracked:T,renderTriggered:B,errorCaptured:O,serverPrefetch:C,expose:I,inheritAttrs:j,components:L,directives:P,filters:N}=t;if(h&&function(e,t,o=tt,n=!1){mt(e)&&(e=ba(e));for(const o in e){const r=e[o];let l;l=_t(r)?"default"in r?gs(r.from||o,r.default,!0):gs(r.from||o):gs(r),Fe(l)&&n?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>l.value,set:e=>l.value=e}):t[o]=l}}(h,n,null,e.appContext.config.unwrapInjectedRef),c)for(const e in c){const t=c[e];ft(t)&&(n[e]=t.bind(o))}if(r){const data=r.call(o,o);_t(data)&&(e.data=Te(data))}if(ua=!0,l)for(const e in l){const t=l[e],r=ft(t)?t.bind(o,o):ft(t.get)?t.get.bind(o,o):tt,c=!ft(t)&&ft(t.set)?t.set.bind(o):tt,d=To({get:r,set:c});Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:()=>d.value,set:e=>d.value=e})}if(d)for(const e in d)ha(d[e],n,o,e);if(m){const e=ft(m)?m.call(o):m;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(yo){let o=yo.provides;const n=yo.parent&&yo.parent.provides;n===o&&(o=yo.provides=Object.create(n)),o[e]=t}}(t,e[t])}))}function H(e,t){mt(t)?t.forEach((t=>e(t.bind(o)))):t&&e(t.bind(o))}if(f&&pa(f,e,"c"),H(Fs,_),H(Ds,v),H(Us,y),H(qs,x),H(js,w),H(Ls,k),H(Gs,O),H(Ks,T),H(Ys,B),H(Vs,M),H(zs,A),H(Xs,C),mt(I))if(I.length){const t=e.exposed||(e.exposed={});I.forEach((e=>{Object.defineProperty(t,e,{get:()=>o[e],set:t=>o[e]=t})}))}else e.exposed||(e.exposed={});E&&e.render===tt&&(e.render=E),null!=j&&(e.inheritAttrs=j),L&&(e.components=L),P&&(e.directives=P)}function pa(e,t,o){Pt(mt(e)?e.map((h2=>h2.bind(t.proxy))):e.bind(t.proxy),t,o)}function ha(e,t,o,n){const r=n.includes(".")?xs(o,n):()=>o[n];if(gt(e)){const o=t[e];ft(o)&&vs(r,o)}else if(ft(e))vs(r,e.bind(o));else if(_t(e))if(mt(e))e.forEach((e=>ha(e,t,o,n)));else{const n=ft(e.handler)?e.handler.bind(o):t[e.handler];ft(n)&&vs(r,n,e)}}function fa(e){const base=e.type,{mixins:t,extends:o}=base,{mixins:n,optionsCache:r,config:{optionMergeStrategies:l}}=e.appContext,c=r.get(base);let d;return c?d=c:n.length||t||o?(d={},n.length&&n.forEach((e=>ga(d,e,l,!0))),ga(d,base,l)):d=base,r.set(base,d),d}function ga(e,t,o,n=!1){const{mixins:r,extends:l}=t;l&&ga(e,l,o,!0),r&&r.forEach((t=>ga(e,t,o,!0)));for(const r in t)if(n&&"expose"===r);else{const n=_a[r]||o&&o[r];e[r]=n?n(e[r],t[r]):t[r]}return e}const _a={data:va,props:xa,emits:xa,methods:xa,computed:xa,beforeCreate:ya,created:ya,beforeMount:ya,mounted:ya,beforeUpdate:ya,updated:ya,beforeDestroy:ya,beforeUnmount:ya,destroyed:ya,unmounted:ya,activated:ya,deactivated:ya,errorCaptured:ya,serverPrefetch:ya,components:xa,directives:xa,watch:function(e,t){if(!e)return t;if(!t)return e;const o=it(Object.create(null),e);for(const n in t)o[n]=ya(e[n],t[n]);return o},provide:va,inject:function(e,t){return xa(ba(e),ba(t))}};function va(e,t){return t?e?function(){return it(ft(e)?e.call(this,this):e,ft(t)?t.call(this,this):t)}:t:e}function ba(e){if(mt(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function ya(e,t){return e?[...new Set([].concat(e,t))]:t}function xa(e,t){return e?it(it(Object.create(null),e),t):t}function wa(e,t,o,n=!1){const r={},l={};Ct(l,ao,1),e.propsDefaults=Object.create(null),ka(e,t,r,l);for(const t in e.propsOptions[0])t in r||(r[t]=void 0);o?e.props=n?r:Oe(r,!1,se,we,Me):e.type.props?e.props=r:e.props=l,e.attrs=l}function ka(e,t,o,n){const[r,l]=e.propsOptions;let c,d=!1;if(t)for(let m in t){if(wt(m))continue;const h=t[m];let f;r&&ut(r,f=Mt(m))?l&&l.includes(f)?(c||(c={}))[f]=h:o[f]=h:is(e.emitsOptions,m)||m in n&&h===n[m]||(n[m]=h,d=!0)}if(l){const t=Pe(o),n=c||Je;for(let i=0;i<l.length;i++){const c=l[i];o[c]=Sa(r,t,c,n[c],e,!ut(n,c))}}return d}function Sa(e,t,o,n,r,l){const c=e[o];if(null!=c){const e=ut(c,"default");if(e&&void 0===n){const e=c.default;if(c.type!==Function&&ft(e)){const{propsDefaults:l}=r;o in l?n=l[o]:(wo(r),n=l[o]=e.call(null,t),ko())}else n=e}c[0]&&(l&&!e?n=!1:!c[1]||""!==n&&n!==At(o)||(n=!0))}return n}function Ma(e,t,o=!1){const n=t.propsCache,r=n.get(e);if(r)return r;const l=e.props,c={},d=[];let m=!1;if(!ft(e)){const n=e=>{m=!0;const[o,n]=Ma(e,t,!0);it(c,o),n&&d.push(...n)};!o&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}if(!l&&!m)return n.set(e,et),et;if(mt(l))for(let i=0;i<l.length;i++){const e=Mt(l[i]);Ra(e)&&(c[e]=Je)}else if(l)for(const e in l){const t=Mt(e);if(Ra(t)){const o=l[e],n=c[t]=mt(o)||ft(o)?{type:o}:o;if(n){const e=Ta(Boolean,n.type),o=Ta(String,n.type);n[0]=e>-1,n[1]=o<0||e<o,(e>-1||ut(n,"default"))&&d.push(t)}}}const h=[c,d];return n.set(e,h),h}function Ra(e){return"$"!==e[0]}function Aa(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function Ea(a,b){return Aa(a)===Aa(b)}function Ta(e,t){return mt(t)?t.findIndex((t=>Ea(t,e))):ft(t)&&Ea(t,e)?0:-1}const Ba=e=>"_"===e[0]||"$stable"===e,Oa=e=>mt(e)?e.map(po):[po(e)],Ca=(e,t,o)=>{if(t._n)return t;const n=us(((...e)=>Oa(t(...e))),o);return n._c=!1,n},Ia=(e,t,o)=>{const n=e._ctx;for(const o in e){if(Ba(o))continue;const r=e[o];if(ft(r))t[o]=Ca(0,r,n);else if(null!=r){const e=Oa(r);t[o]=()=>e}}},ja=(e,t)=>{const o=Oa(t);e.slots.default=()=>o};function La(){return{app:null,config:{isNativeTag:st,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Pa=0;function Na(e,t){return function(o,n=null){ft(o)||(o=Object.assign({},o)),null==n||_t(n)||(n=null);const r=La(),l=new Set;let c=!1;const d=r.app={_uid:Pa++,_component:o,_props:n,_container:null,_context:r,_instance:null,version:Bo,get config(){return r.config},set config(e){},use:(e,...t)=>(l.has(e)||(e&&ft(e.install)?(l.add(e),e.install(d,...t)):ft(e)&&(l.add(e),e(d,...t))),d),mixin:e=>(r.mixins.includes(e)||r.mixins.push(e),d),component:(e,component)=>component?(r.components[e]=component,d):r.components[e],directive:(e,t)=>t?(r.directives[e]=t,d):r.directives[e],mount(l,m,h){if(!c){const f=io(o,n);return f.appContext=r,m&&t?t(f,l):e(f,l,h),c=!0,d._container=l,l.__vue_app__=d,Eo(f.component)||f.component.proxy}},unmount(){c&&(e(null,d._container),delete d._container.__vue_app__)},provide:(e,t)=>(r.provides[e]=t,d)};return d}}function Ha(e,t,o,n,r=!1){if(mt(e))return void e.forEach(((e,i)=>Ha(e,t&&(mt(t)?t[i]:t),o,n,r)));if(Cs(n)&&!r)return;const l=4&n.shapeFlag?Eo(n.component)||n.component.proxy:n.el,c=r?null:l,{i:d,r:m}=e,h=t&&t.r,f=d.refs===Je?d.refs={}:d.refs,_=d.setupState;if(null!=h&&h!==m&&(gt(h)?(f[h]=null,ut(_,h)&&(_[h]=null)):Fe(h)&&(h.value=null)),ft(m))Lt(m,d,12,[c,f]);else{const t=gt(m),n=Fe(m);if(t||n){const d=()=>{if(e.f){const o=t?f[m]:m.value;r?mt(o)&&lt(o,l):mt(o)?o.includes(l)||o.push(l):t?(f[m]=[l],ut(_,m)&&(_[m]=f[m])):(m.value=[l],e.k&&(f[e.k]=m.value))}else t?(f[m]=c,ut(_,m)&&(_[m]=c)):n&&(m.value=c,e.k&&(f[e.k]=c))};c?(d.id=-1,$a(d,o)):d()}}}const $a=function(e,t){t&&t.pendingBranch?mt(e)?t.effects.push(...e):t.effects.push(e):es(e,Xt,zt,Yt)};function Fa(t){return function(t,o){(jt||(jt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{})).__VUE__=!0;const{insert:n,remove:r,patchProp:l,createElement:c,createText:d,createComment:m,setText:h,setElementText:f,parentNode:_,nextSibling:v,setScopeId:y=tt,cloneNode:x,insertStaticContent:w}=t,k=(e,t,o,n=null,r=null,l=null,c=!1,d=null,m=!!t.dynamicChildren)=>{if(e===t)return;e&&!so(e,t)&&(n=ae(e),Q(e,r,l,!0),e=null),-2===t.patchFlag&&(m=!1,t.dynamicChildren=null);const{type:h,ref:f,shapeFlag:_}=t;switch(h){case Va:M(e,t,o,n);break;case za:R(e,t,o,n);break;case Xa:null==e&&A(t,o,n,c);break;case qa:F(e,t,o,n,r,l,c,d,m);break;default:1&_?B(e,t,o,n,r,l,c,d,m):6&_?U(e,t,o,n,r,l,c,d,m):(64&_||128&_)&&h.process(e,t,o,n,r,l,c,d,m,ne)}null!=f&&r&&Ha(f,e&&e.ref,l,t||e,!t)},M=(e,t,o,r)=>{if(null==e)n(t.el=d(t.children),o,r);else{const o=t.el=e.el;t.children!==e.children&&h(o,t.children)}},R=(e,t,o,r)=>{null==e?n(t.el=m(t.children||""),o,r):t.el=e.el},A=(e,t,o,n)=>{[e.el,e.anchor]=w(e.children,t,o,n,e.el,e.anchor)},E=({el:e,anchor:t},o,r)=>{let l;for(;e&&e!==t;)l=v(e),n(e,o,r),e=l;n(t,o,r)},T=({el:e,anchor:t})=>{let o;for(;e&&e!==t;)o=v(e),r(e),e=o;r(t)},B=(e,t,o,n,r,l,c,d,m)=>{c=c||"svg"===t.type,null==e?O(t,o,n,r,l,c,d,m):L(e,t,r,l,c,d,m)},O=(e,t,o,r,d,m,h,_)=>{let v,y;const{type:w,props:k,shapeFlag:S,transition:M,patchFlag:R,dirs:A}=e;if(e.el&&void 0!==x&&-1===R)v=e.el=x(e.el);else{if(v=e.el=c(e.type,m,k&&k.is,k),8&S?f(v,e.children):16&S&&I(e.children,v,null,r,d,m&&"foreignObject"!==w,h,_),A&&Ws(e,null,r,"created"),k){for(const t in k)"value"===t||wt(t)||l(v,t,null,k[t],m,e.children,r,d,se);"value"in k&&l(v,"value",null,k.value),(y=k.onVnodeBeforeMount)&&_o(y,r,e)}C(v,e,e.scopeId,h,r)}A&&Ws(e,null,r,"beforeMount");const E=(!d||d&&!d.pendingBranch)&&M&&!M.persisted;E&&M.beforeEnter(v),n(v,t,o),((y=k&&k.onVnodeMounted)||E||A)&&$a((()=>{y&&_o(y,r,e),E&&M.enter(v),A&&Ws(e,null,r,"mounted")}),d)},C=(e,t,o,n,r)=>{if(o&&y(e,o),n)for(let i=0;i<n.length;i++)y(e,n[i]);if(r){if(t===r.subTree){const t=r.vnode;C(e,t,t.scopeId,t.slotScopeIds,r.parent)}}},I=(e,t,o,n,r,l,c,d,m=0)=>{for(let i=m;i<e.length;i++){const m=e[i]=d?ho(e[i]):po(e[i]);k(null,m,t,o,n,r,l,c,d)}},L=(e,t,o,n,r,c,d)=>{const m=t.el=e.el;let{patchFlag:h,dynamicChildren:_,dirs:v}=t;h|=16&e.patchFlag;const y=e.props||Je,x=t.props||Je;let w;o&&Da(o,!1),(w=x.onVnodeBeforeUpdate)&&_o(w,o,t,e),v&&Ws(t,e,o,"beforeUpdate"),o&&Da(o,!0);const k=r&&"foreignObject"!==t.type;if(_?P(e.dynamicChildren,_,m,o,n,k,c):d||K(e,t,m,null,o,n,k,c,!1),h>0){if(16&h)N(m,t,y,x,o,n,r);else if(2&h&&y.class!==x.class&&l(m,"class",null,x.class,r),4&h&&l(m,"style",y.style,x.style,r),8&h){const c=t.dynamicProps;for(let i=0;i<c.length;i++){const t=c[i],d=y[t],h=x[t];h===d&&"value"!==t||l(m,t,d,h,r,e.children,o,n,se)}}1&h&&e.children!==t.children&&f(m,t.children)}else d||null!=_||N(m,t,y,x,o,n,r);((w=x.onVnodeUpdated)||v)&&$a((()=>{w&&_o(w,o,t,e),v&&Ws(t,e,o,"updated")}),n)},P=(e,t,o,n,r,l,c)=>{for(let i=0;i<t.length;i++){const d=e[i],m=t[i],h=d.el&&(d.type===qa||!so(d,m)||70&d.shapeFlag)?_(d.el):o;k(d,m,h,null,n,r,l,c,!0)}},N=(e,t,o,n,r,c,d)=>{if(o!==n){for(const m in n){if(wt(m))continue;const h=n[m],f=o[m];h!==f&&"value"!==m&&l(e,m,f,h,d,t.children,r,c,se)}if(o!==Je)for(const m in o)wt(m)||m in n||l(e,m,o[m],null,d,t.children,r,c,se);"value"in n&&l(e,"value",o.value,n.value)}},F=(e,t,o,r,l,c,m,h,f)=>{const _=t.el=e?e.el:d(""),v=t.anchor=e?e.anchor:d("");let{patchFlag:y,dynamicChildren:x,slotScopeIds:w}=t;w&&(h=h?h.concat(w):w),null==e?(n(_,o,r),n(v,o,r),I(t.children,o,v,l,c,m,h,f)):y>0&&64&y&&x&&e.dynamicChildren?(P(e.dynamicChildren,x,o,l,c,m,h),(null!=t.key||l&&t===l.subTree)&&Ua(e,t,!0)):K(e,t,o,v,l,c,m,h,f)},U=(e,t,o,n,r,l,c,d,m)=>{t.slotScopeIds=d,null==e?512&t.shapeFlag?r.ctx.activate(t,o,n,c,m):V(t,o,n,r,l,c,m):z(e,t,m)},V=(e,t,o,n,r,l,c)=>{const d=e.component=function(e,t,o){const n=e.type,r=(t?t.appContext:e.appContext)||vo,l={uid:bo++,vnode:e,type:n,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new S(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ma(n,r),emitsOptions:rs(n,r),emit:null,emitted:null,propsDefaults:Je,inheritAttrs:n.inheritAttrs,ctx:Je,data:Je,props:Je,attrs:Je,slots:Je,refs:Je,setupState:Je,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};l.ctx={_:l},l.root=t?t.root:l,l.emit=ns.bind(null,l),e.ce&&e.ce(l);return l}(e,n,r);if(Is(e)&&(d.ctx.renderer=ne),function(e,t=!1){Mo=t;const{props:o,children:n}=e.vnode,r=So(e);wa(e,o,r,t),((e,t)=>{if(32&e.vnode.shapeFlag){const o=t._;o?(e.slots=Pe(t),Ct(t,"_",o)):Ia(t,e.slots={})}else e.slots={},t&&ja(e,t);Ct(e.slots,ao,1)})(e,n);const l=r?function(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=Ne(new Proxy(e.ctx,da));const{setup:n}=o;if(n){const o=e.setupContext=n.length>1?function(e){const t=t=>{e.exposed=t||{}};let o;return{get attrs(){return o||(o=function(e){return new Proxy(e.attrs,{get:(t,o)=>(track(e,0,"$attrs"),t[o])})}(e))},slots:e.slots,emit:e.emit,expose:t}}(e):null;wo(e),H();const r=Lt(n,e,0,[e.props,o]);if($(),ko(),vt(r)){if(r.then(ko,ko),t)return r.then((o=>{Ro(e,o,t)})).catch((t=>{Nt(t,e,0)}));e.asyncDep=r}else Ro(e,r,t)}else Ao(e,t)}(e,t):void 0;Mo=!1}(d),d.asyncDep){if(r&&r.registerDep(d,X),!e.el){const e=d.subTree=io(za);R(null,e,t,o)}}else X(d,e,t,o,r,l,c)},z=(e,t,o)=>{const n=t.component=e.component;if(function(e,t,o){const{props:n,children:r,component:component}=e,{props:l,children:c,patchFlag:d}=t,m=component.emitsOptions;if(t.dirs||t.transition)return!0;if(!(o&&d>=0))return!(!r&&!c||c&&c.$stable)||n!==l&&(n?!l||fs(n,l,m):!!l);if(1024&d)return!0;if(16&d)return n?fs(n,l,m):!!l;if(8&d){const e=t.dynamicProps;for(let i=0;i<e.length;i++){const t=e[i];if(l[t]!==n[t]&&!is(m,t))return!0}}return!1}(e,t,o)){if(n.asyncDep&&!n.asyncResolved)return void Y(n,t,o);n.next=t,function(e){const i=Ft.indexOf(e);i>Dt&&Ft.splice(i,1)}(n.update),n.update()}else t.el=e.el,n.vnode=t},X=(e,t,o,n,r,l,c)=>{const d=()=>{if(e.isMounted){let t,{next:o,bu:n,u:u,parent:d,vnode:m}=e,h=o;Da(e,!1),o?(o.el=m.el,Y(e,o,c)):o=m,n&&Ot(n),(t=o.props&&o.props.onVnodeBeforeUpdate)&&_o(t,d,o,m),Da(e,!0);const f=ms(e),v=e.subTree;e.subTree=f,k(v,f,_(v.el),ae(v),e,r,l),o.el=f.el,null===h&&function({vnode:e,parent:t},o){for(;t&&t.subTree===e;)(e=t.vnode).el=o,t=t.parent}(e,f.el),u&&$a(u,r),(t=o.props&&o.props.onVnodeUpdated)&&$a((()=>_o(t,d,o,m)),r)}else{let c;const{el:d,props:m}=t,{bm:h,m:f,parent:_}=e,v=Cs(t);if(Da(e,!1),h&&Ot(h),!v&&(c=m&&m.onVnodeBeforeMount)&&_o(c,_,t),Da(e,!0),d&&ie){const o=()=>{e.subTree=ms(e),ie(d,e.subTree,e,r,null)};v?t.type.__asyncLoader().then((()=>!e.isUnmounted&&o())):o()}else{const c=e.subTree=ms(e);k(null,c,o,n,e,r,l),t.el=c.el}if(f&&$a(f,r),!v&&(c=m&&m.onVnodeMounted)){const e=t;$a((()=>_o(c,_,e)),r)}(256&t.shapeFlag||_&&Cs(_.vnode)&&256&_.vnode.shapeFlag)&&e.a&&$a(e.a,r),e.isMounted=!0,t=o=n=null}},m=e.effect=new j(d,(()=>Qt(h)),e.scope),h=e.update=()=>m.run();h.id=e.uid,Da(e,!0),h()},Y=(e,t,o)=>{t.component=e;const n=e.vnode.props;e.vnode=t,e.next=null,function(e,t,o,n){const{props:r,attrs:l,vnode:{patchFlag:c}}=e,d=Pe(r),[m]=e.propsOptions;let h=!1;if(!(n||c>0)||16&c){let n;ka(e,t,r,l)&&(h=!0);for(const l in d)t&&(ut(t,l)||(n=At(l))!==l&&ut(t,n))||(m?!o||void 0===o[l]&&void 0===o[n]||(r[l]=Sa(m,d,l,void 0,e,!0)):delete r[l]);if(l!==d)for(const e in l)t&&ut(t,e)||(delete l[e],h=!0)}else if(8&c){const o=e.vnode.dynamicProps;for(let i=0;i<o.length;i++){let n=o[i];if(is(e.emitsOptions,n))continue;const c=t[n];if(m)if(ut(l,n))c!==l[n]&&(l[n]=c,h=!0);else{const t=Mt(n);r[t]=Sa(m,d,t,c,e,!1)}else c!==l[n]&&(l[n]=c,h=!0)}}h&&D(e,"set","$attrs")}(e,t.props,n,o),((e,t,o)=>{const{vnode:n,slots:r}=e;let l=!0,c=Je;if(32&n.shapeFlag){const e=t._;e?o&&1===e?l=!1:(it(r,t),o||1!==e||delete r._):(l=!t.$stable,Ia(t,r)),c=t}else t&&(ja(e,t),c={default:1});if(l)for(const e in r)Ba(e)||e in c||delete r[e]})(e,t.children,o),H(),ts(void 0,e.update),$()},K=(e,t,o,n,r,l,c,d,m=!1)=>{const h=e&&e.children,_=e?e.shapeFlag:0,v=t.children,{patchFlag:y,shapeFlag:x}=t;if(y>0){if(128&y)return void Z(h,v,o,n,r,l,c,d,m);if(256&y)return void G(h,v,o,n,r,l,c,d,m)}8&x?(16&_&&se(h,r,l),v!==h&&f(o,v)):16&_?16&x?Z(h,v,o,n,r,l,c,d,m):se(h,r,l,!0):(8&_&&f(o,""),16&x&&I(v,o,n,r,l,c,d,m))},G=(e,t,o,n,r,l,c,d,m)=>{t=t||et;const h=(e=e||et).length,f=t.length,_=Math.min(h,f);let i;for(i=0;i<_;i++){const n=t[i]=m?ho(t[i]):po(t[i]);k(e[i],n,o,null,r,l,c,d,m)}h>f?se(e,r,l,!0,!1,_):I(t,o,n,r,l,c,d,m,_)},Z=(e,t,o,n,r,l,c,d,m)=>{let i=0;const h=t.length;let f=e.length-1,_=h-1;for(;i<=f&&i<=_;){const n=e[i],h=t[i]=m?ho(t[i]):po(t[i]);if(!so(n,h))break;k(n,h,o,null,r,l,c,d,m),i++}for(;i<=f&&i<=_;){const n=e[f],h=t[_]=m?ho(t[_]):po(t[_]);if(!so(n,h))break;k(n,h,o,null,r,l,c,d,m),f--,_--}if(i>f){if(i<=_){const e=_+1,f=e<h?t[e].el:n;for(;i<=_;)k(null,t[i]=m?ho(t[i]):po(t[i]),o,f,r,l,c,d,m),i++}}else if(i>_)for(;i<=f;)Q(e[i],r,l,!0),i++;else{const v=i,y=i,x=new Map;for(i=y;i<=_;i++){const e=t[i]=m?ho(t[i]):po(t[i]);null!=e.key&&x.set(e.key,i)}let w,S=0;const M=_-y+1;let R=!1,A=0;const E=new Array(M);for(i=0;i<M;i++)E[i]=0;for(i=v;i<=f;i++){const n=e[i];if(S>=M){Q(n,r,l,!0);continue}let h;if(null!=n.key)h=x.get(n.key);else for(w=y;w<=_;w++)if(0===E[w-y]&&so(n,t[w])){h=w;break}void 0===h?Q(n,r,l,!0):(E[h-y]=i+1,h>=A?A=h:R=!0,k(n,t[h],o,null,r,l,c,d,m),S++)}const T=R?function(e){const t=e.slice(),o=[0];let i,n,u,r,l;const c=e.length;for(i=0;i<c;i++){const c=e[i];if(0!==c){if(n=o[o.length-1],e[n]<c){t[i]=n,o.push(i);continue}for(u=0,r=o.length-1;u<r;)l=u+r>>1,e[o[l]]<c?u=l+1:r=l;c<e[o[u]]&&(u>0&&(t[i]=o[u-1]),o[u]=i)}}u=o.length,r=o[u-1];for(;u-- >0;)o[u]=r,r=t[r];return o}(E):et;for(w=T.length-1,i=M-1;i>=0;i--){const e=y+i,f=t[e],_=e+1<h?t[e+1].el:n;0===E[i]?k(null,f,o,_,r,l,c,d,m):R&&(w<0||i!==T[w]?W(f,o,_,2):w--)}}},W=(e,t,o,r,l=null)=>{const{el:c,type:d,transition:m,children:h,shapeFlag:f}=e;if(6&f)return void W(e.component.subTree,t,o,r);if(128&f)return void e.suspense.move(t,o,r);if(64&f)return void d.move(e,t,o,ne);if(d===qa){n(c,t,o);for(let i=0;i<h.length;i++)W(h[i],t,o,r);return void n(e.anchor,t,o)}if(d===Xa)return void E(e,t,o);if(2!==r&&1&f&&m)if(0===r)m.beforeEnter(c),n(c,t,o),$a((()=>m.enter(c)),l);else{const{leave:e,delayLeave:r,afterLeave:l}=m,d=()=>n(c,t,o),h=()=>{e(c,(()=>{d(),l&&l()}))};r?r(c,d,h):h()}else n(c,t,o)},Q=(e,t,o,n=!1,r=!1)=>{const{type:l,props:c,ref:d,children:m,dynamicChildren:h,shapeFlag:f,patchFlag:_,dirs:v}=e;if(null!=d&&Ha(d,null,o,e,!0),256&f)return void t.ctx.deactivate(e);const y=1&f&&v,x=!Cs(e);let w;if(x&&(w=c&&c.onVnodeBeforeUnmount)&&_o(w,t,e),6&f)te(e.component,o,n);else{if(128&f)return void e.suspense.unmount(o,n);y&&Ws(e,null,t,"beforeUnmount"),64&f?e.type.remove(e,t,o,r,ne,n):h&&(l!==qa||_>0&&64&_)?se(h,t,o,!1,!0):(l===qa&&384&_||!r&&16&f)&&se(m,t,o),n&&J(e)}(x&&(w=c&&c.onVnodeUnmounted)||y)&&$a((()=>{w&&_o(w,t,e),y&&Ws(e,null,t,"unmounted")}),o)},J=e=>{const{type:t,el:o,anchor:n,transition:l}=e;if(t===qa)return void ee(o,n);if(t===Xa)return void T(e);const c=()=>{r(o),l&&!l.persisted&&l.afterLeave&&l.afterLeave()};if(1&e.shapeFlag&&l&&!l.persisted){const{leave:t,delayLeave:n}=l,r=()=>t(o,c);n?n(e.el,c,r):r()}else c()},ee=(e,t)=>{let o;for(;e!==t;)o=v(e),r(e),e=o;r(t)},te=(e,t,o)=>{const{bum:n,scope:r,update:l,subTree:c,um:d}=e;n&&Ot(n),r.stop(),l&&(l.active=!1,Q(c,e,t,o)),d&&$a(d,t),$a((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},se=(e,t,o,n=!1,r=!1,l=0)=>{for(let i=l;i<e.length;i++)Q(e[i],t,o,n,r)},ae=e=>6&e.shapeFlag?ae(e.component.subTree):128&e.shapeFlag?e.suspense.next():v(e.anchor||e.el),oe=(e,t,o)=>{null==e?t._vnode&&Q(t._vnode,null,null,!0):k(t._vnode||null,e,t,null,null,null,o),ss(),t._vnode=e},ne={p:k,um:Q,m:W,r:J,mt:V,mc:I,pc:K,pbc:P,n:ae,o:t};let re,ie;o&&([re,ie]=o(ne));return{render:oe,hydrate:re,createApp:Na(oe,re)}}(t)}function Da({effect:e,update:t},o){e.allowRecurse=t.allowRecurse=o}function Ua(e,t,o=!1){const n=e.children,r=t.children;if(mt(n)&&mt(r))for(let i=0;i<n.length;i++){const e=n[i];let t=r[i];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=r[i]=ho(r[i]),t.el=e.el),o||Ua(e,t))}}const qa=Symbol(void 0),Va=Symbol(void 0),za=Symbol(void 0),Xa=Symbol(void 0),Ya=[];let Ka=null;function Ga(e=!1){Ya.push(Ka=e?null:[])}let Za=1;function Wa(e){Za+=e}function Qa(e){return e.dynamicChildren=Za>0?Ka||et:null,Ya.pop(),Ka=Ya[Ya.length-1]||null,Za>0&&Ka&&Ka.push(e),e}function Ja(e,t,o,n,r,l){return Qa(ro(e,t,o,n,r,l,!0))}function eo(e,t,o,n,r){return Qa(io(e,t,o,n,r,!0))}function to(e){return!!e&&!0===e.__v_isVNode}function so(e,t){return e.type===t.type&&e.key===t.key}const ao="__vInternal",oo=({key:e})=>null!=e?e:null,no=({ref:e,ref_key:t,ref_for:o})=>null!=e?gt(e)||Fe(e)||ft(e)?{i:ls,r:e,k:t,f:!!o}:e:null;function ro(e,t=null,o=null,n=0,r=null,l=(e===qa?0:1),c=!1,d=!1){const m={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&oo(t),ref:t&&no(t),scopeId:cs,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:l,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null};return d?(fo(m,o),128&l&&e.normalize(m)):o&&(m.shapeFlag|=gt(o)?8:16),Za>0&&!c&&Ka&&(m.patchFlag>0||6&l)&&32!==m.patchFlag&&Ka.push(m),m}const io=function(e,t=null,o=null,n=0,r=null,l=!1){e&&e!==ea||(e=za);if(to(e)){const n=co(e,t,!0);return o&&fo(n,o),Za>0&&!l&&Ka&&(6&n.shapeFlag?Ka[Ka.indexOf(e)]=n:Ka.push(n)),n.patchFlag|=-2,n}c=e,ft(c)&&"__vccOpts"in c&&(e=e.__vccOpts);var c;if(t){t=lo(t);let{class:e,style:style}=t;e&&!gt(e)&&(t.class=Ge(e)),_t(style)&&(Le(style)&&!mt(style)&&(style=it({},style)),t.style=ze(style))}const d=gt(e)?1:(e=>e.__isSuspense)(e)?128:(e=>e.__isTeleport)(e)?64:_t(e)?4:ft(e)?2:0;return ro(e,t,o,n,r,d,l,!0)};function lo(e){return e?Le(e)||ao in e?it({},e):e:null}function co(e,t,o=!1){const{props:n,ref:r,patchFlag:l,children:c}=e,d=t?go(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:d,key:d&&oo(d),ref:t&&t.ref?o&&r?mt(r)?r.concat(no(t)):[r,no(t)]:no(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:c,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==qa?-1===l?16:16|l:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&co(e.ssContent),ssFallback:e.ssFallback&&co(e.ssFallback),el:e.el,anchor:e.anchor}}function uo(e=" ",t=0){return io(Va,null,e,t)}function mo(e="",t=!1){return t?(Ga(),eo(za,null,e)):io(za,null,e)}function po(e){return null==e||"boolean"==typeof e?io(za):mt(e)?io(qa,null,e.slice()):"object"==typeof e?ho(e):io(Va,null,String(e))}function ho(e){return null===e.el||e.memo?e:co(e)}function fo(e,t){let o=0;const{shapeFlag:n}=e;if(null==t)t=null;else if(mt(t))o=16;else if("object"==typeof t){if(65&n){const slot=t.default;return void(slot&&(slot._c&&(slot._d=!1),fo(e,slot()),slot._c&&(slot._d=!0)))}{o=32;const n=t._;n||ao in t?3===n&&ls&&(1===ls.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=ls}}else ft(t)?(t={default:t,_ctx:ls},o=32):(t=String(t),64&n?(o=16,t=[uo(t)]):o=8);e.children=t,e.shapeFlag|=o}function go(...e){const t={};for(let i=0;i<e.length;i++){const o=e[i];for(const e in o)if("class"===e)t.class!==o.class&&(t.class=Ge([t.class,o.class]));else if("style"===e)t.style=ze([t.style,o.style]);else if(ot(e)){const n=t[e],r=o[e];!r||n===r||mt(n)&&n.includes(r)||(t[e]=n?[].concat(n,r):r)}else""!==e&&(t[e]=o[e])}return t}function _o(e,t,o,n=null){Pt(e,t,7,[o,n])}const vo=La();let bo=0;let yo=null;const xo=()=>yo||ls,wo=e=>{yo=e,e.scope.on()},ko=()=>{yo&&yo.scope.off(),yo=null};function So(e){return 4&e.vnode.shapeFlag}let Mo=!1;function Ro(e,t,o){ft(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:_t(t)&&(e.setupState=Ue(t)),Ao(e,o)}function Ao(e,t,o){const n=e.type;e.render||(e.render=n.render||tt),wo(e),H(),ma(e),$(),ko()}function Eo(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Ue(Ne(e.exposed)),{get:(t,o)=>o in t?t[o]:o in ca?ca[o](e):void 0}))}const To=(e,t)=>function(e,t,o=!1){let n,l;const c="function"==typeof e;return c?(n=e,l=r):(n=e.get,l=e.set),new qe(n,l,c||!l,o)}(e,0,Mo);const Bo="3.2.37";function Oo(e,t){const map=Object.create(null),o=e.split(",");for(let i=0;i<o.length;i++)map[o[i]]=!0;return t?e=>!!map[e.toLowerCase()]:e=>!!map[e]}const Co=Oo("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Io(e){return!!e||""===e}const jo=/^on[^a-z]/,Lo=Object.assign,Po=Array.isArray,No=e=>"string"==typeof e,Ho=e=>{const t=Object.create(null);return o=>t[o]||(t[o]=e(o))},$o=/-(\w)/g,Fo=Ho((e=>e.replace($o,((e,t)=>t?t.toUpperCase():"")))),Do=/\B([A-Z])/g,Uo=Ho((e=>e.replace(Do,"-$1").toLowerCase())),qo=Ho((e=>e.charAt(0).toUpperCase()+e.slice(1))),Vo=e=>{const t=parseFloat(e);return isNaN(t)?e:t},zo="undefined"!=typeof document?document:null,Xo=zo&&zo.createElement("template"),Yo={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,n)=>{const r=t?zo.createElementNS("http://www.w3.org/2000/svg",e):zo.createElement(e,o?{is:o}:void 0);return"select"===e&&n&&null!=n.multiple&&r.setAttribute("multiple",n.multiple),r},createText:e=>zo.createTextNode(e),createComment:e=>zo.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>zo.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(content,e,t,o,n,r){const l=t?t.previousSibling:e.lastChild;if(n&&(n===r||n.nextSibling))for(;e.insertBefore(n.cloneNode(!0),t),n!==r&&(n=n.nextSibling););else{Xo.innerHTML=o?`<svg>${content}</svg>`:content;const template=Xo.content;if(o){const e=template.firstChild;for(;e.firstChild;)template.appendChild(e.firstChild);template.removeChild(e)}e.insertBefore(template,t)}return[l?l.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}};const Ko=/\s*!important$/;function Go(style,e,t){if(Po(t))t.forEach((t=>Go(style,e,t)));else if(null==t&&(t=""),e.startsWith("--"))style.setProperty(e,t);else{const o=function(style,e){const t=Wo[e];if(t)return t;let o=Mt(e);if("filter"!==o&&o in style)return Wo[e]=o;o=qo(o);for(let i=0;i<Zo.length;i++){const t=Zo[i]+o;if(t in style)return Wo[e]=t}return e}(style,e);Ko.test(t)?style.setProperty(Uo(o),t.replace(Ko,""),"important"):style[o]=t}}const Zo=["Webkit","Moz","ms"],Wo={};const Qo="http://www.w3.org/1999/xlink";const[Jo,en]=(()=>{let e=Date.now,t=!1;if("undefined"!=typeof window){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const o=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(o&&Number(o[1])<=53)}return[e,t]})();let tn=0;const p=Promise.resolve(),sn=()=>{tn=0};function an(e,t,o,n,r=null){const l=e._vei||(e._vei={}),c=l[t];if(n&&c)c.value=n;else{const[o,d]=function(e){let t;if(on.test(e)){let o;for(t={};o=e.match(on);)e=e.slice(0,e.length-o[0].length),t[o[0].toLowerCase()]=!0}return[Uo(e.slice(2)),t]}(t);if(n){const c=l[t]=function(e,t){const o=e=>{const n=e.timeStamp||Jo();(en||n>=o.attached-1)&&Pt(function(e,t){if(Po(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,o.value),t,5,[e])};return o.value=e,o.attached=(()=>tn||(p.then(sn),tn=Jo()))(),o}(n,r);!function(e,t,o,n){e.addEventListener(t,o,n)}(e,o,c,d)}else c&&(!function(e,t,o,n){e.removeEventListener(t,o,n)}(e,o,c,d),l[t]=void 0)}}const on=/(?:Once|Passive|Capture)$/;const nn=/^on[a-z]/;const rn="undefined"!=typeof HTMLElement?HTMLElement:class{};class ln extends rn{constructor(e,t={},o){super(),this._def=e,this._props=t,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&o?o(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,Wt((()=>{this._connected||(qn(null,this.shadowRoot),this._instance=null)}))}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);new MutationObserver((e=>{for(const t of e)this._setAttr(t.attributeName)})).observe(this,{attributes:!0});const e=e=>{const{props:t,styles:o}=e,n=!Po(t),r=t?n?Object.keys(t):t:[];let l;if(n)for(const e in this._props){const o=t[e];(o===Number||o&&o.type===Number)&&(this._props[e]=Vo(this._props[e]),(l||(l=Object.create(null)))[e]=!0)}this._numberProps=l;for(const e of Object.keys(this))"_"!==e[0]&&this._setProp(e,this[e],!0,!1);for(const e of r.map(Fo))Object.defineProperty(this,e,{get(){return this._getProp(e)},set(t){this._setProp(e,t)}});this._applyStyles(o),this._update()},t=this._def.__asyncLoader;t?t().then(e):e(this._def)}_setAttr(e){let t=this.getAttribute(e);this._numberProps&&this._numberProps[e]&&(t=Vo(t)),this._setProp(Fo(e),t,!1)}_getProp(e){return this._props[e]}_setProp(e,t,o=!0,n=!0){t!==this._props[e]&&(this._props[e]=t,n&&this._instance&&this._update(),o&&(!0===t?this.setAttribute(Uo(e),""):"string"==typeof t||"number"==typeof t?this.setAttribute(Uo(e),t+""):t||this.removeAttribute(Uo(e))))}_update(){qn(this._createVNode(),this.shadowRoot)}_createVNode(){const e=io(this._def,Lo({},this._props));return this._instance||(e.ce=e=>{this._instance=e,e.isCE=!0,e.emit=(e,...t)=>{this.dispatchEvent(new CustomEvent(e,{detail:t}))};let t=this;for(;t=t&&(t.parentNode||t.host);)if(t instanceof ln){e.parent=t._instance;break}}),e}_applyStyles(e){e&&e.forEach((e=>{const s=document.createElement("style");s.textContent=e,this.shadowRoot.appendChild(s)}))}}const cn="transition",dn="animation",un=(e,{slots:t})=>function(e,t,o){const n=arguments.length;return 2===n?_t(t)&&!mt(t)?to(t)?io(e,null,[t]):io(e,t):io(e,null,t):(n>3?o=Array.prototype.slice.call(arguments,2):3===n&&to(o)&&(o=[o]),io(e,t,o))}(Ms,gn(e),t);un.displayName="Transition";const mn={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},pn=un.props=Lo({},Ms.props,mn),hn=(e,t=[])=>{Po(e)?e.forEach((h2=>h2(...t))):e&&e(...t)},fn=e=>!!e&&(Po(e)?e.some((h2=>h2.length>1)):e.length>1);function gn(e){const t={};for(const o in e)o in mn||(t[o]=e[o]);if(!1===e.css)return t;const{name:o="v",type:n,duration:r,enterFromClass:l=`${o}-enter-from`,enterActiveClass:c=`${o}-enter-active`,enterToClass:d=`${o}-enter-to`,appearFromClass:m=l,appearActiveClass:h=c,appearToClass:f=d,leaveFromClass:_=`${o}-leave-from`,leaveActiveClass:v=`${o}-leave-active`,leaveToClass:y=`${o}-leave-to`}=e,x=function(e){if(null==e)return null;if(null!==(t=e)&&"object"==typeof t)return[_n(e.enter),_n(e.leave)];{const t=_n(e);return[t,t]}var t}(r),w=x&&x[0],k=x&&x[1],{onBeforeEnter:S,onEnter:M,onEnterCancelled:R,onLeave:A,onLeaveCancelled:E,onBeforeAppear:T=S,onAppear:B=M,onAppearCancelled:O=R}=t,C=(e,t,o)=>{bn(e,t?f:d),bn(e,t?h:c),o&&o()},I=(e,t)=>{e._isLeaving=!1,bn(e,_),bn(e,y),bn(e,v),t&&t()},j=e=>(t,o)=>{const r=e?B:M,c=()=>C(t,e,o);hn(r,[t,c]),yn((()=>{bn(t,e?m:l),vn(t,e?f:d),fn(r)||wn(t,n,w,c)}))};return Lo(t,{onBeforeEnter(e){hn(S,[e]),vn(e,l),vn(e,c)},onBeforeAppear(e){hn(T,[e]),vn(e,m),vn(e,h)},onEnter:j(!1),onAppear:j(!0),onLeave(e,t){e._isLeaving=!0;const o=()=>I(e,t);vn(e,_),Rn(),vn(e,v),yn((()=>{e._isLeaving&&(bn(e,_),vn(e,y),fn(A)||wn(e,n,k,o))})),hn(A,[e,o])},onEnterCancelled(e){C(e,!1),hn(R,[e])},onAppearCancelled(e){C(e,!0),hn(O,[e])},onLeaveCancelled(e){I(e),hn(E,[e])}})}function _n(e){return Vo(e)}function vn(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e._vtc||(e._vtc=new Set)).add(t)}function bn(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const{_vtc:o}=e;o&&(o.delete(t),o.size||(e._vtc=void 0))}function yn(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let xn=0;function wn(e,t,o,n){const r=e._endId=++xn,l=()=>{r===e._endId&&n()};if(o)return setTimeout(l,o);const{type:c,timeout:d,propCount:m}=kn(e,t);if(!c)return n();const h=c+"end";let f=0;const _=()=>{e.removeEventListener(h,v),l()},v=t=>{t.target===e&&++f>=m&&_()};setTimeout((()=>{f<m&&_()}),d+1),e.addEventListener(h,v)}function kn(e,t){const o=window.getComputedStyle(e),n=e=>(o[e]||"").split(", "),r=n("transitionDelay"),l=n("transitionDuration"),c=Sn(r,l),d=n("animationDelay"),m=n("animationDuration"),h=Sn(d,m);let f=null,_=0,v=0;t===cn?c>0&&(f=cn,_=c,v=l.length):t===dn?h>0&&(f=dn,_=h,v=m.length):(_=Math.max(c,h),f=_>0?c>h?cn:dn:null,v=f?f===cn?l.length:m.length:0);return{type:f,timeout:_,propCount:v,hasTransform:f===cn&&/\b(transform|all)(,|$)/.test(o.transitionProperty)}}function Sn(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map(((t,i)=>Mn(t)+Mn(e[i]))))}function Mn(s){return 1e3*Number(s.slice(0,-1).replace(",","."))}function Rn(){return document.body.offsetHeight}const An=new WeakMap,En=new WeakMap,Tn={name:"TransitionGroup",props:Lo({},pn,{tag:String,moveClass:String}),setup(e,{slots:t}){const o=xo(),n=ks();let r,l;return qs((()=>{if(!r.length)return;const t=e.moveClass||`${e.name||"v"}-move`;if(!function(e,t,o){const n=e.cloneNode();e._vtc&&e._vtc.forEach((e=>{e.split(/\s+/).forEach((e=>e&&n.classList.remove(e)))}));o.split(/\s+/).forEach((e=>e&&n.classList.add(e))),n.style.display="none";const r=1===t.nodeType?t:t.parentNode;r.appendChild(n);const{hasTransform:l}=kn(n);return r.removeChild(n),l}(r[0].el,o.vnode.el,t))return;r.forEach(On),r.forEach(Cn);const n=r.filter(In);Rn(),n.forEach((e=>{const o=e.el,style=o.style;vn(o,t),style.transform=style.webkitTransform=style.transitionDuration="";const n=o._moveCb=e=>{e&&e.target!==o||e&&!/transform$/.test(e.propertyName)||(o.removeEventListener("transitionend",n),o._moveCb=null,bn(o,t))};o.addEventListener("transitionend",n)}))})),()=>{const c=Pe(e),d=gn(c);let m=c.tag||qa;r=l,l=t.default?Os(t.default()):[];for(let i=0;i<l.length;i++){const e=l[i];null!=e.key&&Bs(e,As(e,d,n,o))}if(r)for(let i=0;i<r.length;i++){const e=r[i];Bs(e,As(e,d,n,o)),An.set(e,e.el.getBoundingClientRect())}return io(m,null,l)}}},Bn=Tn;function On(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Cn(e){En.set(e,e.el.getBoundingClientRect())}function In(e){const t=An.get(e),o=En.get(e),n=t.left-o.left,r=t.top-o.top;if(n||r){const s=e.el.style;return s.transform=s.webkitTransform=`translate(${n}px,${r}px)`,s.transitionDuration="0s",e}}const jn=["ctrl","shift","alt","meta"],Ln={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>jn.some((o=>e[`${o}Key`]&&!t.includes(o)))},Pn=(e,t)=>(o,...n)=>{for(let i=0;i<t.length;i++){const e=Ln[t[i]];if(e&&e(o,t))return}return e(o,...n)},Nn={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Hn=(e,t)=>o=>{if(!("key"in o))return;const n=Uo(o.key);return t.some((e=>e===n||Nn[e]===n))?e(o):void 0},$n={beforeMount(e,{value:t},{transition:o}){e._vod="none"===e.style.display?"":e.style.display,o&&t?o.beforeEnter(e):Fn(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:n}){!t!=!o&&(n?t?(n.beforeEnter(e),Fn(e,!0),n.enter(e)):n.leave(e,(()=>{Fn(e,!1)})):Fn(e,t))},beforeUnmount(e,{value:t}){Fn(e,t)}};function Fn(e,t){e.style.display=t?e._vod:"none"}const Dn=Lo({patchProp:(e,t,o,n,r=!1,l,c,d,m)=>{"class"===t?function(e,t,o){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),null==t?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}(e,n,r):"style"===t?function(e,t,o){const style=e.style,n=No(o);if(o&&!n){for(const e in o)Go(style,e,o[e]);if(t&&!No(t))for(const e in t)null==o[e]&&Go(style,e,"")}else{const r=style.display;n?t!==o&&(style.cssText=o):t&&e.removeAttribute("style"),"_vod"in e&&(style.display=r)}}(e,o,n):(e=>jo.test(e))(t)?(e=>e.startsWith("onUpdate:"))(t)||an(e,t,0,n,c):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,o,n){if(n)return"innerHTML"===t||"textContent"===t||!(!(t in e)||!nn.test(t)||(r=o,"function"!=typeof r));var r;if("spellcheck"===t||"draggable"===t||"translate"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if(nn.test(t)&&No(o))return!1;return t in e}(e,t,n,r))?function(e,t,o,n,r,l,c){if("innerHTML"===t||"textContent"===t)return n&&c(n,r,l),void(e[t]=null==o?"":o);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=o;const n=null==o?"":o;return e.value===n&&"OPTION"!==e.tagName||(e.value=n),void(null==o&&e.removeAttribute(t))}let d=!1;if(""===o||null==o){const n=typeof e[t];"boolean"===n?o=Io(o):null==o&&"string"===n?(o="",d=!0):"number"===n&&(o=0,d=!0)}try{e[t]=o}catch(e){}d&&e.removeAttribute(t)}(e,t,n,l,c,d,m):("true-value"===t?e._trueValue=n:"false-value"===t&&(e._falseValue=n),function(e,t,o,n,r){if(n&&t.startsWith("xlink:"))null==o?e.removeAttributeNS(Qo,t.slice(6,t.length)):e.setAttributeNS(Qo,t,o);else{const n=Co(t);null==o||n&&!Io(o)?e.removeAttribute(t):e.setAttribute(t,n?"":o)}}(e,t,n,r))}},Yo);let Un;const qn=(...e)=>{(Un||(Un=Fa(Dn))).render(...e)};var Vn=(e,t)=>{const o=e.__vccOpts||e;for(const[e,n]of t)o[e]=n;return o};const zn={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},Xn=ro("div",{id:"vac-circle"},null,-1),Yn=ro("div",{id:"vac-circle"},null,-1),Kn=ro("div",{id:"vac-circle"},null,-1),Gn=ro("div",{id:"vac-circle"},null,-1),Zn=ro("div",{id:"vac-circle"},null,-1),Wn=ro("div",{id:"vac-circle"},null,-1);var Qn=Vn(zn,[["render",function(e,t,o,n,r,l){return Ga(),eo(un,{name:"vac-fade-spinner",appear:""},{default:us((()=>[o.show?(Ga(),Ja("div",{key:0,class:Ge(["vac-loader-wrapper",{"vac-container-center":!o.infinite,"vac-container-top":o.infinite}])},["rooms"===o.type?ra(e.$slots,"spinner-icon-rooms",{key:0},(()=>[Xn])):mo("",!0),"infinite-rooms"===o.type?ra(e.$slots,"spinner-icon-infinite-rooms",{key:1},(()=>[Yn])):mo("",!0),"message-file"===o.type?ra(e.$slots,"spinner-icon-message-file_"+o.messageId,{key:2},(()=>[Kn])):mo("",!0),"room-file"===o.type?ra(e.$slots,"spinner-icon-room-file",{key:3},(()=>[Gn])):mo("",!0),"messages"===o.type?ra(e.$slots,"spinner-icon-messages",{key:4},(()=>[Zn])):mo("",!0),"infinite-messages"===o.type?ra(e.$slots,"spinner-icon-infinite-messages",{key:5},(()=>[Wn])):mo("",!0)],2)):mo("",!0)])),_:3})}]]);const Jn=["viewBox"],er=["id","d"],sr=["id","d"];var ar=Vn({name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data:()=>({svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}),computed:{svgId(){const param=this.param?"-"+this.param:"";return`vac-icon-${this.name}${param}`},size(){const e=this.svgItem[this.name];return"large"===e.size?512:"medium"===e.size?48:24}}},[["render",function(e,t,o,n,r,l){return Ga(),Ja("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${l.size} ${l.size}`},[ro("path",{id:l.svgId,d:r.svgItem[o.name].path},null,8,er),r.svgItem[o.name].path2?(Ga(),Ja("path",{key:0,id:l.svgId,d:r.svgItem[o.name].path2},null,8,sr)):mo("",!0)],8,Jn)}]]);const or={name:"RoomsSearch",components:{SvgIcon:ar},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},nr={key:0,class:"vac-icon-search"},rr=["placeholder"];var ir=Vn(or,[["render",function(e,t,o,n,r,l){const c=Js("svg-icon");return Ga(),Ja("div",{class:Ge({"vac-box-search":l.showSearchBar,"vac-box-empty":!l.showSearchBar})},[o.showSearch?(Ga(),Ja(qa,{key:0},[!o.loadingRooms&&o.rooms.length?(Ga(),Ja("div",nr,[ra(e.$slots,"search-icon",{},(()=>[io(c,{name:"search"})]))])):mo("",!0),!o.loadingRooms&&o.rooms.length?(Ga(),Ja("input",{key:1,type:"search",placeholder:o.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=t=>e.$emit("search-room",t))},null,40,rr)):mo("",!0)],64)):mo("",!0),o.showAddRoom?(Ga(),Ja("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=t=>e.$emit("add-room"))},[ra(e.$slots,"add-icon",{},(()=>[io(c,{name:"add"})]))])):mo("",!0)],2)}]]),lr={},cr={};cr.__esModule=!0,cr.inherits=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Object.create(e.prototype);for(var r in o)n[r]=o[r];return n.constructor=t,t.prototype=n,t};var dr={__esModule:!0},ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mr={defaultProtocol:"http",events:null,format:fr,formatHref:fr,nl2br:!1,tagName:"a",target:function(e,t){return"url"===t?"_blank":null},validate:!0,ignoreTags:[],attributes:null,className:"linkified"};function pr(e){e=e||{},this.defaultProtocol=e.hasOwnProperty("defaultProtocol")?e.defaultProtocol:mr.defaultProtocol,this.events=e.hasOwnProperty("events")?e.events:mr.events,this.format=e.hasOwnProperty("format")?e.format:mr.format,this.formatHref=e.hasOwnProperty("formatHref")?e.formatHref:mr.formatHref,this.nl2br=e.hasOwnProperty("nl2br")?e.nl2br:mr.nl2br,this.tagName=e.hasOwnProperty("tagName")?e.tagName:mr.tagName,this.target=e.hasOwnProperty("target")?e.target:mr.target,this.validate=e.hasOwnProperty("validate")?e.validate:mr.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||mr.attributes,this.className=e.hasOwnProperty("className")?e.className:e.linkClass||mr.className;for(var t=e.hasOwnProperty("ignoreTags")?e.ignoreTags:mr.ignoreTags,i=0;i<t.length;i++)this.ignoreTags.push(t[i].toUpperCase())}function fr(e){return e}dr.defaults=mr,dr.Options=pr,dr.contains=function(e,t){for(var i=0;i<e.length;i++)if(e[i]===t)return!0;return!1},pr.prototype={resolve:function(e){var t=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",t,e),tagName:this.get("tagName",t,e),className:this.get("className",t,e),target:this.get("target",t,e),events:this.getObject("events",t,e),attributes:this.getObject("attributes",t,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(e,t,o){var n=void 0,option=this[e];if(!option)return option;switch(void 0===option?"undefined":ur(option)){case"function":return option(t,o.type);case"object":return"function"==typeof(n=option.hasOwnProperty(o.type)?option[o.type]:mr[e])?n(t,o.type):n}return option},getObject:function(e,t,o){var option=this[e];return"function"==typeof option?option(t,o.type):option}};var gr={},_r={__esModule:!0};_r.stateify=_r.TokenState=_r.CharacterState=void 0;var vr=cr;var yr=function(e){this.j=[],this.T=e||null};yr.prototype={defaultTransition:!1,on:function(symbol,e){if(symbol instanceof Array){for(var i=0;i<symbol.length;i++)this.j.push([symbol[i],e]);return this}return this.j.push([symbol,e]),this},next:function(e){for(var i=0;i<this.j.length;i++){var t=this.j[i],symbol=t[0],o=t[1];if(this.test(e,symbol))return o}return this.defaultTransition},accepts:function(){return!!this.T},test:function(e,symbol){return e===symbol},emit:function(){return this.T}};var xr=(0,vr.inherits)(yr,(function(e){this.j=[],this.T=e||null}),{test:function(e,t){return e===t||t instanceof RegExp&&t.test(e)}}),wr=(0,vr.inherits)(yr,(function(e){this.j=[],this.T=e||null}),{jump:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=this.next(new e(""));return o===this.defaultTransition?(o=new this.constructor(t),this.on(e,o)):t&&(o.T=t),o},test:function(e,t){return e instanceof t}});_r.CharacterState=xr,_r.TokenState=wr,_r.stateify=function(e,t,o,n){for(var i=0,r=e.length,l=t,c=[],d=void 0;i<r&&(d=l.next(e[i]));)l=d,i++;if(i>=r)return[];for(;i<r-1;)d=new xr(n),c.push(d),l.on(e[i],d),l=d,i++;return d=new xr(o),c.push(d),l.on(e[r-1],d),c};var kr={},Sr={};Sr.__esModule=!0,Sr.createTokenClass=function(){return function(e){e&&(this.v=e)}},kr.__esModule=!0,kr.AMPERSAND=kr.CLOSEPAREN=kr.CLOSEANGLEBRACKET=kr.CLOSEBRACKET=kr.CLOSEBRACE=kr.OPENPAREN=kr.OPENANGLEBRACKET=kr.OPENBRACKET=kr.OPENBRACE=kr.WS=kr.TLD=kr.SYM=kr.UNDERSCORE=kr.SLASH=kr.MAILTO=kr.PROTOCOL=kr.QUERY=kr.POUND=kr.PLUS=kr.NUM=kr.NL=kr.LOCALHOST=kr.PUNCTUATION=kr.DOT=kr.COLON=kr.AT=kr.DOMAIN=kr.Base=void 0;var Mr=Sr,Rr=cr,Ar=(0,Mr.createTokenClass)();function Er(e){var t=e?{v:e}:{};return(0,Rr.inherits)(Ar,(0,Mr.createTokenClass)(),t)}Ar.prototype={toString:function(){return this.v+""}};var Tr=Er(),Br=Er("@"),Or=Er(":"),Cr=Er("."),Ir=Er(),jr=Er(),Lr=Er("\n"),Pr=Er(),Nr=Er("+"),Hr=Er("#"),$r=Er(),Fr=Er("mailto:"),Dr=Er("?"),Ur=Er("/"),qr=Er("_"),Vr=Er(),zr=Er(),Xr=Er(),Yr=Er("{"),Kr=Er("["),Gr=Er("<"),Zr=Er("("),Wr=Er("}"),Qr=Er("]"),Jr=Er(">"),ei=Er(")"),ti=Er("&");kr.Base=Ar,kr.DOMAIN=Tr,kr.AT=Br,kr.COLON=Or,kr.DOT=Cr,kr.PUNCTUATION=Ir,kr.LOCALHOST=jr,kr.NL=Lr,kr.NUM=Pr,kr.PLUS=Nr,kr.POUND=Hr,kr.QUERY=Dr,kr.PROTOCOL=$r,kr.MAILTO=Fr,kr.SLASH=Ur,kr.UNDERSCORE=qr,kr.SYM=Vr,kr.TLD=zr,kr.WS=Xr,kr.OPENBRACE=Yr,kr.OPENBRACKET=Kr,kr.OPENANGLEBRACKET=Gr,kr.OPENPAREN=Zr,kr.CLOSEBRACE=Wr,kr.CLOSEBRACKET=Qr,kr.CLOSEANGLEBRACKET=Jr,kr.CLOSEPAREN=ei,kr.AMPERSAND=ti,gr.__esModule=!0,gr.start=gr.run=gr.TOKENS=gr.State=void 0;var si=_r,ai=kr,oi=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(ai);var ni="aaa|aarp|abarth|abb|abbott|abbvie|abc|able|abogado|abudhabi|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|aetna|af|afamilycompany|afl|africa|ag|agakhan|agency|ai|aig|aigo|airbus|airforce|airtel|akdn|al|alfaromeo|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|am|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|ao|aol|apartments|app|apple|aq|aquarelle|ar|arab|aramco|archi|army|arpa|art|arte|as|asda|asia|associates|at|athleta|attorney|au|auction|audi|audible|audio|auspost|author|auto|autos|avianca|aw|aws|ax|axa|az|azure|ba|baby|baidu|banamex|bananarepublic|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bb|bbc|bbt|bbva|bcg|bcn|bd|be|beats|beauty|beer|bentley|berlin|best|bestbuy|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|blanco|blockbuster|blog|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bofa|bom|bond|boo|book|booking|boots|bosch|bostik|boston|bot|boutique|box|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|calvinklein|cam|camera|camp|cancerresearch|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|cartier|casa|case|caseih|cash|casino|cat|catering|catholic|cba|cbn|cbre|cbs|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chintai|chloe|christmas|chrome|chrysler|church|ci|cipriani|circle|cisco|citadel|citi|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|comcast|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cookingchannel|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|data|date|dating|datsun|day|dclk|dds|de|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dj|dk|dm|dnp|do|docs|doctor|dodge|dog|doha|domains|dot|download|drive|dtv|dubai|duck|dunlop|duns|dupont|durban|dvag|dvr|dz|earth|eat|ec|eco|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epost|epson|equipment|er|ericsson|erni|es|esq|estate|esurance|et|etisalat|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fi|fiat|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|flir|florist|flowers|fly|fm|fo|foo|food|foodnetwork|football|ford|forex|forsale|forum|foundation|fox|fr|free|fresenius|frl|frogans|frontdoor|frontier|ftr|fujitsu|fujixerox|fun|fund|furniture|futbol|fyi|ga|gal|gallery|gallo|gallup|game|games|gap|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|george|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glade|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|godaddy|gold|goldpoint|golf|goo|goodhands|goodyear|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|grocery|group|gs|gt|gu|guardian|gucci|guge|guide|guitars|guru|gw|gy|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hgtv|hiphop|hisamitsu|hitachi|hiv|hk|hkt|hm|hn|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|honeywell|horse|hospital|host|hosting|hot|hoteles|hotels|hotmail|house|how|hr|hsbc|ht|htc|hu|hughes|hyatt|hyundai|ibm|icbc|ice|icu|id|ie|ieee|ifm|ikano|il|im|imamat|imdb|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|intel|international|intuit|investments|io|ipiranga|iq|ir|irish|is|iselect|ismaili|ist|istanbul|it|itau|itv|iveco|iwc|jaguar|java|jcb|jcp|je|jeep|jetzt|jewelry|jio|jlc|jll|jm|jmp|jnj|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|juniper|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kindle|kitchen|kiwi|km|kn|koeln|komatsu|kosher|kp|kpmg|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|ladbrokes|lamborghini|lamer|lancaster|lancia|lancome|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|linde|link|lipsy|live|living|lixil|lk|loan|loans|locker|locus|loft|lol|london|lotte|lotto|love|lpl|lplfinancial|lr|ls|lt|ltd|ltda|lu|lundbeck|lupin|luxe|luxury|lv|ly|ma|macys|madrid|maif|maison|makeup|man|management|mango|map|market|marketing|markets|marriott|marshalls|maserati|mattel|mba|mc|mckinsey|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|merckmsd|metlife|mg|mh|miami|microsoft|mil|mini|mint|mit|mitsubishi|mk|ml|mlb|mls|mm|mma|mn|mo|mobi|mobile|mobily|moda|moe|moi|mom|monash|money|monster|mopar|mormon|mortgage|moscow|moto|motorcycles|mov|movie|movistar|mp|mq|mr|ms|msd|mt|mtn|mtr|mu|museum|mutual|mv|mw|mx|my|mz|na|nab|nadex|nagoya|name|nationwide|natura|navy|nba|nc|ne|nec|net|netbank|netflix|network|neustar|new|newholland|news|next|nextdirect|nexus|nf|nfl|ng|ngo|nhk|ni|nico|nike|nikon|ninja|nissan|nissay|nl|no|nokia|northwesternmutual|norton|now|nowruz|nowtv|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|observer|off|office|okinawa|olayan|olayangroup|oldnavy|ollo|om|omega|one|ong|onl|online|onyourside|ooo|open|oracle|orange|org|organic|origins|osaka|otsuka|ott|ovh|pa|page|panasonic|panerai|paris|pars|partners|parts|party|passagens|pay|pccw|pe|pet|pf|pfizer|pg|ph|pharmacy|phd|philips|phone|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pnc|pohl|poker|politie|porn|post|pr|pramerica|praxi|press|prime|pro|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|qvc|racing|radio|raid|re|read|realestate|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|rightathome|ril|rio|rip|rmit|ro|rocher|rocks|rodeo|rogers|room|rs|rsvp|ru|rugby|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|save|saxo|sb|sbi|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scjohnson|scor|scot|sd|se|search|seat|secure|security|seek|select|sener|services|ses|seven|sew|sex|sexy|sfr|sg|sh|shangrila|sharp|shaw|shell|shia|shiksha|shoes|shop|shopping|shouji|show|showtime|shriram|si|silk|sina|singles|site|sj|sk|ski|skin|sky|skype|sl|sling|sm|smart|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|srt|st|stada|staples|star|starhub|statebank|statefarm|statoil|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiftcover|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|tdk|team|tech|technology|tel|telecity|telefonica|temasek|tennis|teva|tf|tg|th|thd|theater|theatre|tiaa|tickets|tienda|tiffany|tips|tires|tirol|tj|tjmaxx|tjx|tk|tkmaxx|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tr|trade|trading|training|travel|travelchannel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubank|ubs|uconnect|ug|uk|unicom|university|uno|uol|ups|us|uy|uz|va|vacations|vana|vanguard|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|vista|vistaprint|viva|vivo|vlaanderen|vn|vodka|volkswagen|volvo|vote|voting|voto|voyage|vu|vuelos|wales|walmart|walter|wang|wanggou|warman|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|ws|wtc|wtf|xbox|xerox|xfinity|xihuan|xin|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--30rr7y|xn--3bst00m|xn--3ds443g|xn--3e0b707e|xn--3hcrj9c|xn--3oq18vl8pn36a|xn--3pxu8k|xn--42c2d9a|xn--45br5cyl|xn--45brj9c|xn--45q11c|xn--4gbrim|xn--54b7fta0cc|xn--55qw42g|xn--55qx5d|xn--5su34j936bgsg|xn--5tzm5g|xn--6frz82g|xn--6qq986b3xl|xn--80adxhks|xn--80ao21a|xn--80aqecdr1a|xn--80asehdb|xn--80aswg|xn--8y0a063a|xn--90a3ac|xn--90ae|xn--90ais|xn--9dbq2a|xn--9et52u|xn--9krt00a|xn--b4w605ferd|xn--bck1b9a5dre4c|xn--c1avg|xn--c2br7g|xn--cck2b3b|xn--cg4bki|xn--clchc0ea0b2g2a9gcd|xn--czr694b|xn--czrs0t|xn--czru2d|xn--d1acj3b|xn--d1alf|xn--e1a4c|xn--eckvdtc9d|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fhbei|xn--fiq228c5hs|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--fjq720a|xn--flw351e|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--fzys8d69uvgm|xn--g2xx48c|xn--gckr3f0f|xn--gecrj9c|xn--gk3at1e|xn--h2breg3eve|xn--h2brj9c|xn--h2brj9c8c|xn--hxt814e|xn--i1b6b1a6a2e|xn--imr513n|xn--io0a7i|xn--j1aef|xn--j1amh|xn--j6w193g|xn--jlq61u9w7b|xn--jvr189m|xn--kcrx77d1x4a|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--kput3i|xn--l1acc|xn--lgbbat1ad8j|xn--mgb9awbf|xn--mgba3a3ejt|xn--mgba3a4f16a|xn--mgba7c0bbn0a|xn--mgbaakc7dvf|xn--mgbaam7a8h|xn--mgbab2bd|xn--mgbai9azgqp6j|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a|xn--mgbbh1a71e|xn--mgbc0a9azcg|xn--mgbca7dzdo|xn--mgberp4a5d4ar|xn--mgbgu82a|xn--mgbi4ecexp|xn--mgbpl2fh|xn--mgbt3dhd|xn--mgbtx2b|xn--mgbx4cd0ab|xn--mix891f|xn--mk1bu44c|xn--mxtq1m|xn--ngbc5azd|xn--ngbe9e0a|xn--ngbrx|xn--node|xn--nqv7f|xn--nqv7fs00ema|xn--nyqy26a|xn--o3cw4h|xn--ogbpf8fl|xn--p1acf|xn--p1ai|xn--pbt977c|xn--pgbs0dh|xn--pssy2u|xn--q9jyb4c|xn--qcka1pmc|xn--qxam|xn--rhqv96g|xn--rovu88b|xn--rvc1e0am3e|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--tckwe|xn--tiq49xqyj|xn--unup4y|xn--vermgensberater-ctb|xn--vermgensberatung-pwb|xn--vhquv|xn--vuq861b|xn--w4r85el8fhu5dnra|xn--w4rs40l|xn--wgbh1c|xn--wgbl6a|xn--xhq521b|xn--xkc2al3hye2a|xn--xkc2dl3a5ee0h|xn--y9a3aq|xn--yfro4i67o|xn--ygbi2ammx|xn--zfr164b|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|you|youtube|yt|yun|za|zappos|zara|zero|zip|zippo|zm|zone|zuerich|zw".split("|"),ri="0123456789".split(""),ii="0123456789abcdefghijklmnopqrstuvwxyz".split(""),ci=[" ","\f","\r","\t","\v"," "," ","᠎"],di=[],ui=function(e){return new si.CharacterState(e)},mi=ui(),pi=ui(ai.NUM),hi=ui(ai.DOMAIN),fi=ui(),gi=ui(ai.WS);mi.on("@",ui(ai.AT)).on(".",ui(ai.DOT)).on("+",ui(ai.PLUS)).on("#",ui(ai.POUND)).on("?",ui(ai.QUERY)).on("/",ui(ai.SLASH)).on("_",ui(ai.UNDERSCORE)).on(":",ui(ai.COLON)).on("{",ui(ai.OPENBRACE)).on("[",ui(ai.OPENBRACKET)).on("<",ui(ai.OPENANGLEBRACKET)).on("(",ui(ai.OPENPAREN)).on("}",ui(ai.CLOSEBRACE)).on("]",ui(ai.CLOSEBRACKET)).on(">",ui(ai.CLOSEANGLEBRACKET)).on(")",ui(ai.CLOSEPAREN)).on("&",ui(ai.AMPERSAND)).on([",",";","!",'"',"'"],ui(ai.PUNCTUATION)),mi.on("\n",ui(ai.NL)).on(ci,gi),gi.on(ci,gi);for(var i=0;i<ni.length;i++){var _i=(0,si.stateify)(ni[i],mi,ai.TLD,ai.DOMAIN);di.push.apply(di,_i)}var vi=(0,si.stateify)("file",mi,ai.DOMAIN,ai.DOMAIN),bi=(0,si.stateify)("ftp",mi,ai.DOMAIN,ai.DOMAIN),yi=(0,si.stateify)("http",mi,ai.DOMAIN,ai.DOMAIN),xi=(0,si.stateify)("mailto",mi,ai.DOMAIN,ai.DOMAIN);di.push.apply(di,vi),di.push.apply(di,bi),di.push.apply(di,yi),di.push.apply(di,xi);var wi=vi.pop(),ki=bi.pop(),Si=yi.pop(),Mi=xi.pop(),Ri=ui(ai.DOMAIN),Ai=ui(ai.PROTOCOL),Ei=ui(ai.MAILTO);ki.on("s",Ri).on(":",Ai),Si.on("s",Ri).on(":",Ai),di.push(Ri),wi.on(":",Ai),Ri.on(":",Ai),Mi.on(":",Ei);var Ti=(0,si.stateify)("localhost",mi,ai.LOCALHOST,ai.DOMAIN);di.push.apply(di,Ti),mi.on(ri,pi),pi.on("-",fi).on(ri,pi).on(ii,hi),hi.on("-",fi).on(ii,hi);for(var Bi=0;Bi<di.length;Bi++)di[Bi].on("-",fi).on(ii,hi);fi.on("-",fi).on(ri,hi).on(ii,hi),mi.defaultTransition=ui(ai.SYM);var Oi=mi;gr.State=si.CharacterState,gr.TOKENS=oi,gr.run=function(e){for(var t=e.replace(/[A-Z]/g,(function(e){return e.toLowerCase()})),o=e.length,n=[],cursor=0;cursor<o;){for(var r=mi,l=null,c=0,d=null,m=-1;cursor<o&&(l=r.next(t[cursor]));)(r=l).accepts()?(m=0,d=r):m>=0&&m++,c++,cursor++;if(!(m<0)){cursor-=m,c-=m;var h=d.emit();n.push(new h(e.substr(cursor-c,c)))}}return n},gr.start=Oi;var Ci={},Ii={__esModule:!0};Ii.URL=Ii.TEXT=Ii.NL=Ii.EMAIL=Ii.MAILTOEMAIL=Ii.Base=void 0;var ji=Sr,Li=cr,Pi=kr;function Ni(e){return e instanceof Pi.DOMAIN||e instanceof Pi.TLD}var Hi=(0,ji.createTokenClass)();Hi.prototype={type:"token",isLink:!1,toString:function(){for(var e=[],i=0;i<this.v.length;i++)e.push(this.v[i].toString());return e.join("")},toHref:function(){return this.toString()},toObject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(e)}}};var $i=(0,Li.inherits)(Hi,(0,ji.createTokenClass)(),{type:"email",isLink:!0}),Fi=(0,Li.inherits)(Hi,(0,ji.createTokenClass)(),{type:"email",isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),Di=(0,Li.inherits)(Hi,(0,ji.createTokenClass)(),{type:"text"}),Ui=(0,Li.inherits)(Hi,(0,ji.createTokenClass)(),{type:"nl"}),qi=(0,Li.inherits)(Hi,(0,ji.createTokenClass)(),{type:"url",isLink:!0,toHref:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http",t=!1,o=!1,n=this.v,r=[],i=0;n[i]instanceof Pi.PROTOCOL;)t=!0,r.push(n[i].toString().toLowerCase()),i++;for(;n[i]instanceof Pi.SLASH;)o=!0,r.push(n[i].toString()),i++;for(;Ni(n[i]);)r.push(n[i].toString().toLowerCase()),i++;for(;i<n.length;i++)r.push(n[i].toString());return r=r.join(""),t||o||(r=e+"://"+r),r},hasProtocol:function(){return this.v[0]instanceof Pi.PROTOCOL}});Ii.Base=Hi,Ii.MAILTOEMAIL=$i,Ii.EMAIL=Fi,Ii.NL=Ui,Ii.TEXT=Di,Ii.URL=qi,Ci.__esModule=!0,Ci.start=Ci.run=Ci.TOKENS=Ci.State=void 0;var Vi=_r,zi=Ii,Xi=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(zi),Yi=kr;var Ki=function(e){return new Vi.TokenState(e)},Gi=Ki(),Zi=Ki(),Wi=Ki(),Qi=Ki(),Ji=Ki(),el=Ki(),tl=Ki(),sl=Ki(zi.URL),al=Ki(),nl=Ki(zi.URL),rl=Ki(zi.URL),il=Ki(),ll=Ki(),cl=Ki(),ml=Ki(),pl=Ki(),hl=Ki(zi.URL),fl=Ki(zi.URL),gl=Ki(zi.URL),_l=Ki(zi.URL),vl=Ki(),bl=Ki(),yl=Ki(),xl=Ki(),wl=Ki(),kl=Ki(),Sl=Ki(zi.EMAIL),Ml=Ki(),Rl=Ki(zi.EMAIL),Al=Ki(zi.MAILTOEMAIL),El=Ki(),Tl=Ki(),Bl=Ki(),Ol=Ki(),Cl=Ki(zi.NL);Gi.on(Yi.NL,Cl).on(Yi.PROTOCOL,Zi).on(Yi.MAILTO,Wi).on(Yi.SLASH,Qi),Zi.on(Yi.SLASH,Qi),Qi.on(Yi.SLASH,Ji),Gi.on(Yi.TLD,el).on(Yi.DOMAIN,el).on(Yi.LOCALHOST,sl).on(Yi.NUM,el),Ji.on(Yi.TLD,rl).on(Yi.DOMAIN,rl).on(Yi.NUM,rl).on(Yi.LOCALHOST,rl),el.on(Yi.DOT,tl),wl.on(Yi.DOT,kl),tl.on(Yi.TLD,sl).on(Yi.DOMAIN,el).on(Yi.NUM,el).on(Yi.LOCALHOST,el),kl.on(Yi.TLD,Sl).on(Yi.DOMAIN,wl).on(Yi.NUM,wl).on(Yi.LOCALHOST,wl),sl.on(Yi.DOT,tl),Sl.on(Yi.DOT,kl),sl.on(Yi.COLON,al).on(Yi.SLASH,rl),al.on(Yi.NUM,nl),nl.on(Yi.SLASH,rl),Sl.on(Yi.COLON,Ml),Ml.on(Yi.NUM,Rl);var Il=[Yi.DOMAIN,Yi.AT,Yi.LOCALHOST,Yi.NUM,Yi.PLUS,Yi.POUND,Yi.PROTOCOL,Yi.SLASH,Yi.TLD,Yi.UNDERSCORE,Yi.SYM,Yi.AMPERSAND],jl=[Yi.COLON,Yi.DOT,Yi.QUERY,Yi.PUNCTUATION,Yi.CLOSEBRACE,Yi.CLOSEBRACKET,Yi.CLOSEANGLEBRACKET,Yi.CLOSEPAREN,Yi.OPENBRACE,Yi.OPENBRACKET,Yi.OPENANGLEBRACKET,Yi.OPENPAREN];rl.on(Yi.OPENBRACE,ll).on(Yi.OPENBRACKET,cl).on(Yi.OPENANGLEBRACKET,ml).on(Yi.OPENPAREN,pl),il.on(Yi.OPENBRACE,ll).on(Yi.OPENBRACKET,cl).on(Yi.OPENANGLEBRACKET,ml).on(Yi.OPENPAREN,pl),ll.on(Yi.CLOSEBRACE,rl),cl.on(Yi.CLOSEBRACKET,rl),ml.on(Yi.CLOSEANGLEBRACKET,rl),pl.on(Yi.CLOSEPAREN,rl),hl.on(Yi.CLOSEBRACE,rl),fl.on(Yi.CLOSEBRACKET,rl),gl.on(Yi.CLOSEANGLEBRACKET,rl),_l.on(Yi.CLOSEPAREN,rl),vl.on(Yi.CLOSEBRACE,rl),bl.on(Yi.CLOSEBRACKET,rl),yl.on(Yi.CLOSEANGLEBRACKET,rl),xl.on(Yi.CLOSEPAREN,rl),ll.on(Il,hl),cl.on(Il,fl),ml.on(Il,gl),pl.on(Il,_l),ll.on(jl,vl),cl.on(jl,bl),ml.on(jl,yl),pl.on(jl,xl),hl.on(Il,hl),fl.on(Il,fl),gl.on(Il,gl),_l.on(Il,_l),hl.on(jl,hl),fl.on(jl,fl),gl.on(jl,gl),_l.on(jl,_l),vl.on(Il,hl),bl.on(Il,fl),yl.on(Il,gl),xl.on(Il,_l),vl.on(jl,vl),bl.on(jl,bl),yl.on(jl,yl),xl.on(jl,xl),rl.on(Il,rl),il.on(Il,rl),rl.on(jl,il),il.on(jl,il),Wi.on(Yi.TLD,Al).on(Yi.DOMAIN,Al).on(Yi.NUM,Al).on(Yi.LOCALHOST,Al),Al.on(Il,Al).on(jl,El),El.on(Il,Al).on(jl,El);var Ll=[Yi.DOMAIN,Yi.NUM,Yi.PLUS,Yi.POUND,Yi.QUERY,Yi.UNDERSCORE,Yi.SYM,Yi.AMPERSAND,Yi.TLD];el.on(Ll,Tl).on(Yi.AT,Bl),sl.on(Ll,Tl).on(Yi.AT,Bl),tl.on(Ll,Tl),Tl.on(Ll,Tl).on(Yi.AT,Bl).on(Yi.DOT,Ol),Ol.on(Ll,Tl),Bl.on(Yi.TLD,wl).on(Yi.DOMAIN,wl).on(Yi.LOCALHOST,Sl);Ci.State=Vi.TokenState,Ci.TOKENS=Xi,Ci.run=function(e){for(var t=e.length,cursor=0,o=[],n=[];cursor<t;){for(var r=Gi,l=null,c=null,d=0,m=null,h=-1;cursor<t&&!(l=r.next(e[cursor]));)n.push(e[cursor++]);for(;cursor<t&&(c=l||r.next(e[cursor]));)l=null,(r=c).accepts()?(h=0,m=r):h>=0&&h++,cursor++,d++;if(h<0)for(var i=cursor-d;i<cursor;i++)n.push(e[i]);else{n.length>0&&(o.push(new zi.TEXT(n)),n=[]),cursor-=h,d-=h;var f=m.emit();o.push(new f(e.slice(cursor-d,cursor)))}}return n.length>0&&o.push(new zi.TEXT(n)),o},Ci.start=Gi,lr.__esModule=!0,lr.tokenize=lr.test=lr.scanner=lr.parser=lr.options=lr.inherits=lr.find=void 0;var Pl=cr,Nl=Fl(dr),Hl=Fl(gr),$l=Fl(Ci);function Fl(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var Dl=function(e){return $l.run(Hl.run(e))};lr.find=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=Dl(e),n=[],i=0;i<o.length;i++){var r=o[i];!r.isLink||t&&r.type!==t||n.push(r.toObject())}return n},lr.inherits=Pl.inherits,lr.options=Nl,lr.parser=$l,lr.scanner=Hl,lr.test=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=Dl(e);return 1===o.length&&o[0].isLink&&(!t||o[0].type===t)},lr.tokenize=Dl;var Ul=lr,ql=(e,t,o)=>{const n={bold:o.bold,italic:o.italic,strike:o.strike,underline:o.underline,multilineCode:o.multilineCode,inlineCode:o.inlineCode},r={[n.bold]:{end:"\\"+n.bold,allowed_chars:".",type:"bold"},[n.italic]:{end:n.italic,allowed_chars:".",type:"italic"},[n.strike]:{end:n.strike,allowed_chars:".",type:"strike"},[n.underline]:{end:n.underline,allowed_chars:".",type:"underline"},[n.multilineCode]:{end:n.multilineCode,allowed_chars:"(.|\n)",type:"multiline-code"},[n.inlineCode]:{end:n.inlineCode,allowed_chars:".",type:"inline-code"},"<usertag>":{allowed_chars:".",end:"</usertag>",type:"tag"}},html=function(e,t){const o=[];return e.forEach((e=>{"string"==typeof e?o.push({types:[],value:e}):t[e.start]&&o.push(function(e){const t=[];return zl(e,t,[]),t}(e))})),o}(Vl(e,r),r),l=[].concat.apply([],html);return t&&function(e){const t=[];e.forEach((e=>{const o=Ul.find(e.value);if(o.length){const n=e.value.replace(o[0].value,"");t.push({types:e.types,value:n}),e.types=["url"].concat(e.types),e.href=o[0].href,e.value=o[0].value}t.push(e)}))}(l),l};function Vl(e,t){let o=[],n=-1,r=null,l=Ul.find(e),c=!1;if(l.length>0&&(n=e.indexOf(l[0].value),c=!0),Object.keys(t).forEach((t=>{const o=e.indexOf(t);o>=0&&(n<0||o<n)&&(n=o,r=t,c=!1)})),c&&-1!==r){let r=e.substr(0,n),c=e.substr(n,l[0].value.length),d=e.substr(n+l[0].value.length);return o.push(r),o.push(c),o=o.concat(Vl(d,t)),o}if(r){let l=e.substr(0,n);const c=r;let d=e.substr(n+c.length);if(e.replace(/\s/g,"").length===2*c.length)return[e];const m=d.match(new RegExp("^("+(t[c].allowed_chars||".")+"*"+(t[c].end?"?":"")+")"+(t[c].end?"("+t[c].end+")":""),"m"));if(m&&m[1]){l&&o.push(l);const object={start:c,content:Vl(m[1],t),end:m[2],type:t[c].type};o.push(object),d=d.substr(m[0].length)}else l+=c,o.push(l);return o=o.concat(Vl(d,t)),o}return e?[e]:[]}function zl(e,t,o){e.content.forEach((n=>{"string"==typeof n?t.push({types:Xl(o.concat([e.type])),value:n}):zl(n,t,Xl([n.type].concat([e.type]).concat(o)))}))}function Xl(e){return[...new Set(e)]}const Yl=["png","jpg","jpeg","webp","svg","gif"],Kl=["mp4","video/ogg","webm","quicktime"],Gl=["mp3","audio/ogg","wav","mpeg"],Zl={name:"FormatMessage",components:{SvgIcon:ar},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{linkifiedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];const e=ql(this.formatTags(this.content),this.linkify&&!this.linkOptions.disabled,this.textFormatting);return e.forEach((e=>{e.url=this.checkType(e,"url"),e.bold=this.checkType(e,"bold"),e.italic=this.checkType(e,"italic"),e.strike=this.checkType(e,"strike"),e.underline=this.checkType(e,"underline"),e.inline=this.checkType(e,"inline-code"),e.multiline=this.checkType(e,"multiline-code"),e.tag=this.checkType(e,"tag"),e.image=this.checkImageType(e),e.value=this.replaceEmojiByElement(e.value)})),e},formattedContent(){return this.deleted?this.textMessages.MESSAGE_DELETED:this.formatTags(this.content)}},methods:{checkType:(e,t)=>-1!==e.types.indexOf(t),checkImageType(e){let t=e.value.lastIndexOf(".");e.value.lastIndexOf("/")>t&&(t=-1);const o=e.value.substring(t+1,e.value.length),n=t>0&&Yl.some((e=>o.toLowerCase().includes(e)));return n&&this.setImageSize(e),n},setImageSize(e){const image=new Image;image.src=e.value,image.addEventListener("load",(function t(img){const o=img.path[0].width/150;e.height=Math.round(img.path[0].height/o)+"px",image.removeEventListener("load",t)}))},formatTags(content){const e="<usertag>",t=[...content.matchAll(new RegExp(e,"gi"))].map((a=>a.index)),o=content;return t.forEach((t=>{const n=o.substring(t+e.length,o.indexOf("</usertag>",t)),r=this.users.find((e=>e._id===n));content=content.replaceAll(n,`@${(null==r?void 0:r.username)||"unknown"}`)})),content},openTag(e){if(!this.singleLine&&this.checkType(e,"tag")){const t=this.users.find((u=>-1!==e.value.indexOf(u.username)));this.$emit("open-user-tag",t)}},replaceEmojiByElement(e){let t;if(this.singleLine)t=16;else{const e=this.containsOnlyEmojis();t=e?28:20}return e.replaceAll(/[\p{Extended_Pictographic}\u{1F3FB}-\u{1F3FF}\u{1F9B0}-\u{1F9B3}]/gu,(e=>`<span style="font-size: ${t}px">${e}</span>`))},containsOnlyEmojis(){const e=this.content.replace(new RegExp("[\0-ữf]","g"),""),t=this.content.replace(new RegExp("[\n\rs]+|( )+","g"),"");return e.length===t.length}}},Wl={class:"vac-image-link-container"},Ql={class:"vac-image-link-message"},Jl=["innerHTML"],ec=["innerHTML"];var tc=Vn(Zl,[["render",function(e,t,o,n,r,l){const c=Js("svg-icon");return Ga(),Ja("div",{class:Ge(["vac-format-message-wrapper",{"vac-text-ellipsis":o.singleLine}])},[o.textFormatting.disabled?(Ga(),Ja("div",{key:1,innerHTML:l.formattedContent},null,8,ec)):(Ga(),Ja("div",{key:0,class:Ge({"vac-text-ellipsis":o.singleLine})},[(Ga(!0),Ja(qa,null,oa(l.linkifiedMessage,((t,i)=>{return Ga(),Ja("div",{key:i,class:"vac-format-container"},[(Ga(),eo((component=t.url?"a":"span",gt(component)?sa(Qs,component,!1)||component:component||ea),{class:Ge({"vac-text-ellipsis":o.singleLine,"vac-text-bold":t.bold,"vac-text-italic":o.deleted||t.italic,"vac-text-strike":t.strike,"vac-text-underline":t.underline,"vac-text-inline-code":!o.singleLine&&t.inline,"vac-text-multiline-code":!o.singleLine&&t.multiline,"vac-text-tag":!o.singleLine&&!o.reply&&t.tag}),href:t.href,target:t.href?o.linkOptions.target:null,rel:t.href?o.linkOptions.rel:null,onClick:e=>l.openTag(t)},{default:us((()=>[o.deleted?(Ga(),Ja(qa,{key:0},[ra(e.$slots,o.roomList?"deleted-icon-room_"+o.roomId:"deleted-icon_"+o.messageId,{},(()=>[io(c,{name:"deleted",class:Ge(["vac-icon-deleted",{"vac-icon-deleted-room":o.roomList}])},null,8,["class"])])),uo(" "+We(o.textMessages.MESSAGE_DELETED),1)],64)):t.url&&t.image?(Ga(),Ja(qa,{key:1},[ro("div",Wl,[ro("div",{class:"vac-image-link",style:ze({"background-image":`url('${t.value}')`,height:t.height})},null,4)]),ro("div",Ql,[ro("span",null,We(t.value),1)])],64)):(Ga(),Ja("span",{key:2,innerHTML:t.value},null,8,Jl))])),_:2},1032,["class","href","target","rel","onClick"]))]);var component})),128))],2))],2)}]]);const sc="__v-click-outside",ac="undefined"!=typeof window,oc="undefined"!=typeof navigator,nc=ac&&("ontouchstart"in window||oc&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"],rc=({event:e,handler:t,middleware:o})=>{o(e)&&t(e)},ic=(e,{value:t})=>{const{events:o,handler:n,middleware:r,isActive:l,detectIframe:c,capture:d}=(e=>{const t="function"==typeof e;if(!t&&"object"!=typeof e)throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(e=>e),events:e.events||nc,isActive:!(!1===e.isActive),detectIframe:!(!1===e.detectIframe),capture:Boolean(e.capture)}})(t);if(l){if(e[sc]=o.map((t=>({event:t,srcTarget:document.documentElement,handler:t=>(({el:e,event:t,handler:o,middleware:n})=>{const path=t.path||t.composedPath&&t.composedPath();(path?path.indexOf(e)<0:!e.contains(t.target))&&rc({event:t,handler:o,middleware:n})})({el:e,event:t,handler:n,middleware:r}),capture:d}))),c){const t={event:"blur",srcTarget:window,handler:t=>(({el:e,event:t,handler:o,middleware:n})=>{setTimeout((()=>{const{activeElement:r}=document;r&&"IFRAME"===r.tagName&&!e.contains(r)&&rc({event:t,handler:o,middleware:n})}),0)})({el:e,event:t,handler:n,middleware:r}),capture:d};e[sc]=[...e[sc],t]}e[sc].forEach((({event:t,srcTarget:o,handler:n})=>setTimeout((()=>{e[sc]&&o.addEventListener(t,n,d)}),0)))}},lc=e=>{(e[sc]||[]).forEach((({event:e,srcTarget:t,handler:o,capture:n})=>t.removeEventListener(e,o,n))),delete e[sc]};var cc=ac?{beforeMount:ic,updated:(e,{value:t,oldValue:o})=>{JSON.stringify(t)!==JSON.stringify(o)&&(lc(e),ic(e,{value:t}))},unmounted:lc}:{},dc=(e,t,o)=>{if(e.typingUsers&&e.typingUsers.length){const n=e.users.filter((o=>{if(o._id!==t&&-1!==e.typingUsers.indexOf(o._id)&&(!o.status||"offline"!==o.status.state))return!0}));if(!n.length)return;return 2===e.users.length?o.IS_TYPING:n.map((e=>e.username)).join(", ")+" "+o.IS_TYPING}};function uc(e,t){if(t&&t.type)return e.some((e=>t.type.toLowerCase().includes(e)))}function mc(e){return uc(Yl,e)}function pc(e){return uc(Kl,e)}function hc(e){return uc(Yl,e)||uc(Kl,e)}function fc(e){return uc(Gl,e)}const gc={class:"vac-room-container"},_c={class:"vac-name-container vac-text-ellipsis"},vc={class:"vac-title-container"},bc={class:"vac-room-name vac-text-ellipsis"},yc={key:1,class:"vac-text-date"},xc={key:0},wc={key:1,class:"vac-text-ellipsis"},kc={key:3,class:"vac-text-ellipsis"},Sc={class:"vac-room-options-container"},Mc={key:0,class:"vac-badge-counter vac-room-badge"},Rc={key:0,class:"vac-menu-options"},Ac={class:"vac-menu-list"},Ec=["onClick"];var Tc=(e,t,o,n=!1)=>o&&""!==o?e.filter((e=>n?Bc(e[t]).startsWith(Bc(o)):Bc(e[t]).includes(Bc(o)))):e;function Bc(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const Oc={name:"RoomsList",components:{Loader:Qn,RoomsSearch:ir,RoomContent:Vn({name:"RoomsContent",components:{SvgIcon:ar,FormatMessage:tc},directives:{clickOutside:cc},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data:()=>({roomMenuOpened:null}),computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const content=this.room.lastMessage.content;if(this.room.users.length<=2)return content;const t=this.room.users.find((e=>e._id===this.room.lastMessage.senderId));return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${content}`:t&&t._id!==this.currentUserId?`${t.username} - ${content}`:content},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find((u=>u._id!==this.currentUserId));return e&&e.status?e.status.state:null},typingUsers(){return dc(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var e,t;const o=null==(t=null==(e=this.room.lastMessage)?void 0:e.files)?void 0:t[0];if(o){if(!o.duration)return`${o.name}.${o.extension}`;let s=Math.floor(o.duration);return(s-(s%=60))/60+(s>9?":":":0")+s}return""},isAudio(){return!!this.room.lastMessage.files&&fc(this.room.lastMessage.files[0])}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},[["render",function(e,t,o,n,r,l){const c=Js("svg-icon"),d=Js("format-message"),m=ta("click-outside");return Ga(),Ja("div",gc,[ra(e.$slots,"room-list-item_"+o.room.roomId,{},(()=>[ra(e.$slots,"room-list-avatar_"+o.room.roomId,{},(()=>[o.room.avatar?(Ga(),Ja("div",{key:0,class:"vac-avatar",style:ze({"background-image":`url('${o.room.avatar}')`})},null,4)):mo("",!0)])),ro("div",_c,[ro("div",vc,[l.userStatus?(Ga(),Ja("div",{key:0,class:Ge(["vac-state-circle",{"vac-state-online":"online"===l.userStatus}])},null,2)):mo("",!0),ro("div",bc,We(o.room.roomName),1),o.room.lastMessage?(Ga(),Ja("div",yc,We(o.room.lastMessage.timestamp),1)):mo("",!0)]),ro("div",{class:Ge(["vac-text-last",{"vac-message-new":o.room.lastMessage&&o.room.lastMessage.new&&!l.typingUsers}])},[l.isMessageCheckmarkVisible?(Ga(),Ja("span",xc,[ra(e.$slots,"checkmark-icon_"+o.room.roomId,{},(()=>[io(c,{name:o.room.lastMessage.distributed?"double-checkmark":"checkmark",param:o.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])]))])):mo("",!0),o.room.lastMessage&&!o.room.lastMessage.deleted&&l.isAudio?(Ga(),Ja("div",wc,[ra(e.$slots,"microphone-icon_"+o.room.roomId,{},(()=>[io(c,{name:"microphone",class:"vac-icon-microphone"})])),uo(" "+We(l.formattedDuration),1)])):o.room.lastMessage?(Ga(),eo(d,{key:2,"message-id":o.room.lastMessage._id,"room-id":o.room.roomId,"room-list":!0,content:l.getLastMessage,deleted:!!o.room.lastMessage.deleted&&!l.typingUsers,users:o.room.users,"text-messages":o.textMessages,linkify:!1,"text-formatting":o.textFormatting,"link-options":o.linkOptions,"single-line":!0},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):mo("",!0),!o.room.lastMessage&&l.typingUsers?(Ga(),Ja("div",kc,We(l.typingUsers),1)):mo("",!0),ro("div",Sc,[o.room.unreadCount?(Ga(),Ja("div",Mc,We(o.room.unreadCount),1)):mo("",!0),ra(e.$slots,"room-list-options_"+o.room.roomId,{},(()=>[o.roomActions.length?(Ga(),Ja("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=Pn((e=>r.roomMenuOpened=o.room.roomId),["stop"]))},[ra(e.$slots,"room-list-options-icon_"+o.room.roomId,{},(()=>[io(c,{name:"dropdown",param:"room"})]))])):mo("",!0),o.roomActions.length?(Ga(),eo(un,{key:1,name:"vac-slide-left"},{default:us((()=>[r.roomMenuOpened===o.room.roomId?Zs((Ga(),Ja("div",Rc,[ro("div",Ac,[(Ga(!0),Ja(qa,null,oa(o.roomActions,(e=>(Ga(),Ja("div",{key:e.name},[ro("div",{class:"vac-menu-item",onClick:Pn((t=>l.roomActionHandler(e)),["stop"])},We(e.title),9,Ec)])))),128))])])),[[m,l.closeRoomMenu]]):mo("",!0)])),_:1})):mo("",!0)]))])],2)])]))])}]])},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout((()=>this.initIntersectionObserver()))},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=document.querySelector("vue-advanced-chat").shadowRoot.getElementById("infinite-loader-rooms");if(e){const t={root:document.querySelector("vue-advanced-chat").shadowRoot.getElementById("rooms-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver((e=>{e[0].isIntersecting&&this.loadMoreRooms()}),t),this.observer.observe(e)}},searchRoom(e){this.filteredRooms=Tc(this.rooms,"roomName",e.target.value)},openRoom(e){(e.roomId!==this.room.roomId||this.isMobile)&&(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded)return this.loadingMoreRooms=!1,void(this.showLoader=!1);this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},Cc={key:0,class:"vac-rooms-empty"},Ic={key:1,id:"rooms-list",class:"vac-room-list"},jc=["id","onClick"],Lc={key:0,id:"infinite-loader-rooms"};var Pc=Vn(Oc,[["render",function(e,t,o,n,r,l){const c=Js("rooms-search"),d=Js("loader"),m=Js("room-content");return Zs((Ga(),Ja("div",{class:Ge(["vac-rooms-container",{"vac-rooms-container-full":o.isMobile,"vac-app-border-r":!o.isMobile}])},[ra(e.$slots,"rooms-header"),ra(e.$slots,"rooms-list-search",{},(()=>[io(c,{rooms:o.rooms,"loading-rooms":o.loadingRooms,"text-messages":o.textMessages,"show-search":o.showSearch,"show-add-room":o.showAddRoom,onSearchRoom:l.searchRoom,onAddRoom:t[0]||(t[0]=t=>e.$emit("add-room"))},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])])),io(d,{show:o.loadingRooms,type:"rooms"},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["show"]),o.loadingRooms||o.rooms.length?mo("",!0):(Ga(),Ja("div",Cc,[ra(e.$slots,"rooms-empty",{},(()=>[uo(We(o.textMessages.ROOMS_EMPTY),1)]))])),o.loadingRooms?mo("",!0):(Ga(),Ja("div",Ic,[(Ga(!0),Ja(qa,null,oa(r.filteredRooms,(n=>(Ga(),Ja("div",{id:n.roomId,key:n.roomId,class:Ge(["vac-room-item",{"vac-room-selected":r.selectedRoomId===n.roomId}]),onClick:e=>l.openRoom(n)},[io(m,{"current-user-id":o.currentUserId,room:n,"text-formatting":o.textFormatting,"link-options":o.linkOptions,"text-messages":o.textMessages,"room-actions":o.roomActions,onRoomActionHandler:t[1]||(t[1]=t=>e.$emit("room-action-handler",t))},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,jc)))),128)),io(un,{name:"vac-fade-message"},{default:us((()=>[o.rooms.length&&!o.loadingRooms?(Ga(),Ja("div",Lc,[io(d,{show:r.showLoader,infinite:!0,type:"infinite-rooms"},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["show"])])):mo("",!0)])),_:3})]))],2)),[[$n,o.showRoomsList]])}]]);const Nc={name:"RoomHeader",components:{SvgIcon:ar},directives:{clickOutside:cc},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data:()=>({menuOpened:!1,messageSelectionAnimationEnded:!0}),computed:{typingUsers(){return dc(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find((u=>u._id!==this.currentUserId));if(!e.status)return;let t="";return"online"===e.status.state?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout((()=>{this.messageSelectionAnimationEnded=!0}),300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},Hc={class:"vac-room-header vac-app-border-b"},$c={class:"vac-room-wrapper"},Fc={key:0,class:"vac-room-selection"},Dc=["id"],Uc=["onClick"],qc={class:"vac-selection-button-count"},Vc={class:"vac-text-ellipsis"},zc={class:"vac-room-name vac-text-ellipsis"},Xc={key:0,class:"vac-room-info vac-text-ellipsis"},Yc={key:1,class:"vac-room-info vac-text-ellipsis"},Kc={key:0,class:"vac-menu-options"},Gc={class:"vac-menu-list"},Zc=["onClick"];var Wc=Vn(Nc,[["render",function(e,t,o,n,r,l){const c=Js("svg-icon"),d=ta("click-outside");return Ga(),Ja("div",Hc,[ra(e.$slots,"room-header",{},(()=>[ro("div",$c,[io(un,{name:"vac-slide-up"},{default:us((()=>[o.messageSelectionEnabled?(Ga(),Ja("div",Fc,[(Ga(!0),Ja(qa,null,oa(o.messageSelectionActions,(e=>(Ga(),Ja("div",{id:e.name,key:e.name},[ro("div",{class:"vac-selection-button",onClick:t=>l.messageSelectionActionHandler(e)},[uo(We(e.title)+" ",1),ro("span",qc,We(o.selectedMessagesTotal),1)],8,Uc)],8,Dc)))),128)),ro("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=t=>e.$emit("cancel-message-selection"))},We(o.textMessages.CANCEL_SELECT_MESSAGE),1)])):mo("",!0)])),_:1}),!o.messageSelectionEnabled&&r.messageSelectionAnimationEnded?(Ga(),Ja(qa,{key:0},[o.singleRoom?mo("",!0):(Ga(),Ja("div",{key:0,class:Ge(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!o.isMobile,"vac-rotate-icon":!o.showRoomsList&&!o.isMobile}]),onClick:t[1]||(t[1]=t=>e.$emit("toggle-rooms-list"))},[ra(e.$slots,"toggle-icon",{},(()=>[io(c,{name:"toggle"})]))],2)),ro("div",{class:Ge(["vac-info-wrapper",{"vac-item-clickable":o.roomInfoEnabled}]),onClick:t[2]||(t[2]=t=>e.$emit("room-info"))},[ra(e.$slots,"room-header-avatar",{},(()=>[o.room.avatar?(Ga(),Ja("div",{key:0,class:"vac-avatar",style:ze({"background-image":`url('${o.room.avatar}')`})},null,4)):mo("",!0)])),ra(e.$slots,"room-header-info",{},(()=>[ro("div",Vc,[ro("div",zc,We(o.room.roomName),1),l.typingUsers?(Ga(),Ja("div",Xc,We(l.typingUsers),1)):(Ga(),Ja("div",Yc,We(l.userStatus),1))])]))],2),o.room.roomId?ra(e.$slots,"room-options",{key:1},(()=>[o.menuActions.length?(Ga(),Ja("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=e=>r.menuOpened=!r.menuOpened)},[ra(e.$slots,"menu-icon",{},(()=>[io(c,{name:"menu"})]))])):mo("",!0),o.menuActions.length?(Ga(),eo(un,{key:1,name:"vac-slide-left"},{default:us((()=>[r.menuOpened?Zs((Ga(),Ja("div",Kc,[ro("div",Gc,[(Ga(!0),Ja(qa,null,oa(o.menuActions,(e=>(Ga(),Ja("div",{key:e.name},[ro("div",{class:"vac-menu-item",onClick:t=>l.menuActionHandler(e)},We(e.title),9,Zc)])))),128))])])),[[d,l.closeMenu]]):mo("",!0)])),_:1})):mo("",!0)])):mo("",!0)],64)):mo("",!0)])]))])}]]);function Qc(e){if("string"!=typeof e||!e)throw new Error("expected a non-empty string, got: "+e)}function Jc(e){if("number"!=typeof e)throw new Error("expected a number, got: "+e)}const ed="emoji",sd="keyvalue",ad="favorites",od="tokens",nd="count",rd="group-order",id="eTag",ld="url",cd="skinTone",ud="readonly",md="readwrite",pd="skinUnicodes";function hd(e){return function(e,t){const o=new Set,n=[];for(const r of e){const e=t(r);o.has(e)||(o.add(e),n.push(r))}return n}(e,(e=>e.unicode))}const fd={},gd={},_d={};function vd(e,t,o){o.onerror=()=>t(o.error),o.onblocked=()=>t(new Error("IDB blocked")),o.onsuccess=()=>e(o.result)}async function bd(e){const t=await new Promise(((t,o)=>{const n=indexedDB.open(e,1);fd[e]=n,n.onupgradeneeded=e=>{e.oldVersion<1&&function(e){function t(t,o,n){const r=o?e.createObjectStore(t,{keyPath:o}):e.createObjectStore(t);if(n)for(const[e,[t,o]]of Object.entries(n))r.createIndex(e,t,{multiEntry:o});return r}t(sd),t(ed,"unicode",{[od]:["tokens",!0],[rd]:[["group","order"]],[pd]:["skinUnicodes",!0]}),t(ad,void 0,{[nd]:[""]})}(n.result)},vd(t,o,n)}));return t.onclose=()=>xd(e),t}function yd(e,t,o,n){return new Promise(((r,l)=>{const c=e.transaction(t,o,{durability:"relaxed"}),d="string"==typeof t?c.objectStore(t):t.map((e=>c.objectStore(e)));let m;n(d,c,(e=>{m=e})),c.oncomplete=()=>r(m),c.onerror=()=>l(c.error)}))}function xd(e){const t=fd[e],o=t&&t.result;if(o){o.close();const t=_d[e];if(t)for(const e of t)e()}delete fd[e],delete gd[e],delete _d[e]}const wd=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function kd(e){return e.split(/[\s_]+/).map((e=>!e.match(/\w/)||wd.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase())).filter(Boolean)}function Sd(e){return e.filter(Boolean).map((e=>e.toLowerCase())).filter((e=>e.length>=2))}function Md(e,t,o,n){e[t](o).onsuccess=e=>n&&n(e.target.result)}function Rd(e,t,o){Md(e,"get",t,o)}function Ad(e,t,o){Md(e,"getAll",t,o)}function Ed(e){e.commit&&e.commit()}function Td(e,t){const o=function(e,t){let o=e[0];for(let i=1;i<e.length;i++){const n=e[i];t(o)>t(n)&&(o=n)}return o}(e,(e=>e.length)),n=[];for(const r of o)e.some((e=>-1===e.findIndex((e=>t(e)===t(r)))))||n.push(r);return n}async function Bd(e,t,o,n){try{const r=function(e){return e.map((({annotation:e,emoticon:t,group:o,order:n,shortcodes:r,skins:l,tags:c,emoji:d,version:m})=>{const h=[...new Set(Sd([...(r||[]).map(kd).flat(),...c.map(kd).flat(),...kd(e),t]))].sort(),f={annotation:e,group:o,order:n,tags:c,tokens:h,unicode:d,version:m};if(t&&(f.emoticon=t),r&&(f.shortcodes=r),l){f.skinTones=[],f.skinUnicodes=[],f.skinVersions=[];for(const{tone:e,emoji:t,version:o}of l)f.skinTones.push(e),f.skinUnicodes.push(t),f.skinVersions.push(o)}return f}))}(t);await yd(e,[ed,sd],md,(([e,t],l)=>{let c,d,m=0;function h(){2==++m&&function(){if(c===n&&d===o)return;e.clear();for(const data of r)e.put(data);t.put(n,id),t.put(o,ld),Ed(l)}()}Rd(t,id,(e=>{c=e,h()})),Rd(t,ld,(e=>{d=e,h()}))}))}finally{}}async function Od(e,t){const o=Sd(kd(t));return o.length?yd(e,ed,ud,((e,t,n)=>{const r=[],l=()=>{const e=Td(r,(e=>e.unicode));n(e.sort(((a,b)=>a.order<b.order?-1:1)))};for(let i=0;i<o.length;i++){const t=o[i],n=i===o.length-1?IDBKeyRange.bound(t,t+"￿",!1,!0):IDBKeyRange.only(t);Ad(e.index(od),n,(e=>{r.push(e),r.length===o.length&&l()}))}})):[]}async function Cd(e,t){const o=await Od(e,t);if(!o.length){const o=e=>(e.shortcodes||[]).includes(t.toLowerCase());return await async function(e,t){return yd(e,ed,ud,((e,o,n)=>{let r;const l=()=>{e.getAll(r&&IDBKeyRange.lowerBound(r,!0),50).onsuccess=e=>{const o=e.target.result;for(const e of o)if(r=e.unicode,t(e))return n(e);if(o.length<50)return n();l()}};l()}))}(e,o)||null}return o.filter((e=>(e.shortcodes||[]).map((e=>e.toLowerCase())).includes(t.toLowerCase())))[0]||null}function Id(e,t,o){return yd(e,t,ud,((e,t,n)=>Rd(e,o,n)))}const jd=["name","url"];function Ld(e){!function(e){const t=e&&Array.isArray(e),o=t&&e.length&&(!e[0]||jd.some((t=>!(t in e[0]))));if(!t||o)throw new Error("Custom emojis are in the wrong format")}(e);const t=(a,b)=>a.name.toLowerCase()<b.name.toLowerCase()?-1:1,o=e.sort(t),n=function(e,t){const map=new Map;for(const o of e){const e=t(o);for(const t of e){let e=map;for(let i=0;i<t.length;i++){const o=t.charAt(i);let n=e.get(o);n||(n=new Map,e.set(o,n)),e=n}let n=e.get("");n||(n=[],e.set("",n)),n.push(o)}}return(e,t)=>{let o=map;for(let i=0;i<e.length;i++){const t=e.charAt(i),n=o.get(t);if(!n)return[];o=n}if(t)return o.get("")||[];const n=[],r=[o];for(;r.length;){const e=[...r.shift().entries()].sort(((a,b)=>a[0]<b[0]?-1:1));for(const[t,o]of e)""===t?n.push(...o):r.push(o)}return n}}(e,(e=>[...new Set((e.shortcodes||[]).map((e=>kd(e))).flat())])),r=e=>n(e,!0),l=e=>n(e,!1),c=new Map,d=new Map;for(const t of e){d.set(t.name.toLowerCase(),t);for(const e of t.shortcodes||[])c.set(e.toLowerCase(),t)}return{all:o,search:e=>{const o=kd(e),n=o.map(((e,i)=>(i<o.length-1?r:l)(e)));return Td(n,(e=>e.name)).sort(t)},byShortcode:e=>c.get(e.toLowerCase()),byName:e=>d.get(e.toLowerCase())}}function Pd(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let i=0;i<t;i++)e.skins[i]={tone:e.skinTones[i],unicode:e.skinUnicodes[i],version:e.skinVersions[i]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function Nd(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const Hd=["annotation","emoji","group","order","tags","version"];function $d(e,t){if(2!==Math.floor(e.status/100))throw new Error("Failed to fetch: "+t+":  "+e.status)}async function Fd(e){const t=await fetch(e);$d(t,e);const o=t.headers.get("etag");Nd(o);const n=await t.json();return function(e){if(!e||!Array.isArray(e)||!e[0]||"object"!=typeof e[0]||Hd.some((t=>!(t in e[0]))))throw new Error("Emoji data is in the wrong format")}(n),[o,n]}async function Dd(object){const e=function(e){for(var t=e.length,o=new ArrayBuffer(t),n=new Uint8Array(o),i=-1;++i<t;)n[i]=e.charCodeAt(i);return o}(JSON.stringify(object)),t=function(e){for(var t="",o=new Uint8Array(e),n=o.byteLength,i=-1;++i<n;)t+=String.fromCharCode(o[i]);return t}(await crypto.subtle.digest("SHA-1",e));return btoa(t)}async function Ud(e,t){let o,n=await async function(e){const t=await fetch(e,{method:"HEAD"});$d(t,e);const o=t.headers.get("etag");return Nd(o),o}(t);if(!n){const e=await Fd(t);n=e[0],o=e[1],n||(n=await Dd(o))}if(await async function(e,t,o){const[n,r]=await Promise.all([id,ld].map((t=>Id(e,sd,t))));return n===o&&r===t}(e,t,n));else{if(!o){o=(await Fd(t))[1]}await Bd(e,o,t,n)}}class qd{constructor({dataSource:e="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",locale:t="en",customEmoji:o=[]}={}){this.dataSource=e,this.locale=t,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=Ld(o),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await(t=this._dbName,gd[t]||(gd[t]=bd(t)),gd[t]);var t;!function(e,t){let o=_d[e];o||(o=_d[e]=[]),o.push(t)}(this._dbName,this._clear);const o=this.dataSource,n=await async function(e){return!await Id(e,sd,ld)}(e);n?await async function(e,t){let[o,n]=await Fd(t);o||(o=await Dd(n)),await Bd(e,n,t,o)}(e,o):this._lazyUpdate=Ud(e,o)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return Jc(e),await this.ready(),hd(await async function(e,t){return yd(e,ed,ud,((e,o,n)=>{const r=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);Ad(e.index(rd),r,n)}))}(this._db,e)).map(Pd)}async getEmojiBySearchQuery(e){Qc(e),await this.ready();return[...this._custom.search(e),...hd(await Od(this._db,e)).map(Pd)]}async getEmojiByShortcode(e){Qc(e),await this.ready();const t=this._custom.byShortcode(e);return t||Pd(await Cd(this._db,e))}async getEmojiByUnicodeOrName(e){Qc(e),await this.ready();const t=this._custom.byName(e);return t||Pd(await async function(e,t){return yd(e,ed,ud,((e,o,n)=>Rd(e,t,(o=>{if(o)return n(o);Rd(e.index(pd),t,(e=>n(e||null)))}))))}(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await Id(this._db,sd,cd)||0}async setPreferredSkinTone(e){return Jc(e),await this.ready(),t=this._db,o=cd,n=e,yd(t,sd,md,((e,t)=>{e.put(n,o),Ed(t)}));var t,o,n}async incrementFavoriteEmojiCount(e){return Qc(e),await this.ready(),t=this._db,o=e,yd(t,ad,md,((e,t)=>Rd(e,o,(n=>{e.put((n||0)+1,o),Ed(t)}))));var t,o}async getTopFavoriteEmoji(e){return Jc(e),await this.ready(),(await function(e,t,o){return 0===o?[]:yd(e,[ad,ed],ud,(([e,n],r,l)=>{const c=[];e.index(nd).openCursor(void 0,"prev").onsuccess=e=>{const cursor=e.target.result;if(!cursor)return l(c);function r(e){if(c.push(e),c.length===o)return l(c);cursor.continue()}const d=cursor.primaryKey,m=t.byName(d);if(m)return r(m);Rd(n,d,(e=>{if(e)return r(e);cursor.continue()}))}}))}(this._db,this._custom,e)).map(Pd)}set customEmoji(e){this._custom=Ld(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(e){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await xd(this._dbName)}async delete(){var e;await this._shutdown(),await(e=this._dbName,new Promise(((t,o)=>{xd(e),vd(t,o,indexedDB.deleteDatabase(e))})))}}function Vd(){}function zd(e){return e()}function Xd(){return Object.create(null)}function Yd(e){e.forEach(zd)}function Kd(e){return"function"==typeof e}function Gd(a,b){return a!=a?b==b:a!==b||a&&"object"==typeof a||"function"==typeof a}let Zd,Wd;function Qd(e,t){return Zd||(Zd=document.createElement("a")),Zd.href=t,e===Zd.href}function Jd(e,t){e.appendChild(t)}function eu(e,t,o){e.insertBefore(t,o||null)}function tu(e){e.parentNode.removeChild(e)}function element(e){return document.createElement(e)}function text(data){return document.createTextNode(data)}function su(e,t,o,n){return e.addEventListener(t,o,n),()=>e.removeEventListener(t,o,n)}function au(e,t,o){null==o?e.removeAttribute(t):e.getAttribute(t)!==o&&e.setAttribute(t,o)}function ou(e,data){data=""+data,e.wholeText!==data&&(e.data=data)}function nu(input,e){input.value=null==e?"":e}function ru(e,t,o,n){null===o?e.style.removeProperty(t):e.style.setProperty(t,o,n?"important":"")}function iu(component){Wd=component}const lu=[],cu=[],du=[],uu=[],mu=Promise.resolve();let pu=!1;function hu(){pu||(pu=!0,mu.then(vu))}function fu(e){du.push(e)}const gu=new Set;let _u=0;function vu(){const e=Wd;do{for(;_u<lu.length;){const component=lu[_u];_u++,iu(component),bu(component.$$)}for(iu(null),lu.length=0,_u=0;cu.length;)cu.pop()();for(let i=0;i<du.length;i+=1){const e=du[i];gu.has(e)||(gu.add(e),e())}du.length=0}while(lu.length);for(;uu.length;)uu.pop()();pu=!1,gu.clear(),iu(e)}function bu(e){if(null!==e.fragment){e.update(),Yd(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(fu)}}const yu=new Set;const xu="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:e;function wu(e,t){e.d(1),t.delete(e.key)}function ku(e,t,o,n,r,l,c,d,m,h,f,_){let v=e.length,y=l.length,i=v;const x={};for(;i--;)x[e[i].key]=i;const w=[],k=new Map,S=new Map;for(i=y;i--;){const e=_(r,l,i),d=o(e);let m=c.get(d);m?n&&m.p(e,t):(m=h(d,e),m.c()),k.set(d,w[i]=m),d in x&&S.set(d,Math.abs(i-x[d]))}const M=new Set,R=new Set;function A(e){!function(e,t){e&&e.i&&(yu.delete(e),e.i(t))}(e,1),e.m(d,f),c.set(e.key,e),f=e.first,y--}for(;v&&y;){const t=w[y-1],o=e[v-1],n=t.key,r=o.key;t===o?(f=t.first,v--,y--):k.has(r)?!c.has(n)||M.has(n)?A(t):R.has(r)?v--:S.get(n)>S.get(r)?(R.add(n),A(t)):(M.add(r),v--):(m(o,c),v--)}for(;v--;){const t=e[v];k.has(t.key)||m(t,c)}for(;y;)A(w[y-1]);return w}function Su(component,e,t,o,n,r,l,c=[-1]){const d=Wd;iu(component);const m=component.$$={fragment:null,ctx:null,props:r,update:Vd,not_equal:n,bound:Xd(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:Xd(),dirty:c,skip_bound:!1,root:e.target||d.$$.root};l&&l(m.root);let h=!1;m.ctx=t?t(component,e.props||{},((i,e,...t)=>{const o=t.length?t[0]:e;return m.ctx&&n(m.ctx[i],m.ctx[i]=o)&&(!m.skip_bound&&m.bound[i]&&m.bound[i](o),h&&function(component,i){-1===component.$$.dirty[0]&&(lu.push(component),hu(),component.$$.dirty.fill(0)),component.$$.dirty[i/31|0]|=1<<i%31}(component,i)),e})):[],m.update(),h=!0,Yd(m.before_update),m.fragment=!!o&&o(m.ctx),e.target&&(m.fragment&&m.fragment.c(),function(component,e,t,o){const{fragment:n,on_mount:r,on_destroy:l,after_update:c}=component.$$;n&&n.m(e,t),o||fu((()=>{const e=r.map(zd).filter(Kd);l?l.push(...e):Yd(e),component.$$.on_mount=[]})),c.forEach(fu)}(component,e.target,void 0,void 0),vu()),iu(d)}const Mu=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map((([e,t,o])=>({id:e,emoji:t,name:o}))),Ru=Mu.slice(1),Au=Mu[0],Eu="function"==typeof requestIdleCallback?requestIdleCallback:setTimeout;function Tu(e){return e.unicode.includes("‍")}const Bu={"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},Ou=["😊","😒","♥️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],Cu='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',Iu=(a,b)=>a<b?-1:a>b?1:0,ju=(e,t)=>{const canvas=document.createElement("canvas");canvas.width=canvas.height=1;const o=canvas.getContext("2d");return o.textBaseline="top",o.font=`100px ${Cu}`,o.fillStyle=t,o.scale(.01,.01),o.fillText(e,0,0),o.getImageData(0,0,1,1).data};function Lu(e){const t=ju(e,"#000"),o=ju(e,"#fff");return t&&o&&((e,t)=>{const o=[...e].join(",");return o===[...t].join(",")&&!o.startsWith("0,0,0,")})(t,o)}const Pu=new Promise((e=>Eu((()=>e(function(){const e=Object.entries(Bu);try{for(const[t,o]of e)if(Lu(t))return o}catch(e){}return e[0][1]}()))))),Nu=new Map;function Hu(e){e.preventDefault(),e.stopPropagation()}function $u(e,t,o){return(t+=e?-1:1)<0?t=o.length-1:t>=o.length&&(t=0),t}function Fu(e,t){const o=new Set,n=[];for(const r of e){const e=t(r);o.has(e)||(o.add(e),n.push(r))}return n}const Du=requestAnimationFrame;let Uu,qu="function"==typeof ResizeObserver;function Vu(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}const{Map:zu}=xu;function Xu(e,t,i){const o=e.slice();return o[63]=t[i],o[65]=i,o}function Yu(e,t,i){const o=e.slice();return o[66]=t[i],o[65]=i,o}function Ku(e,t,i){const o=e.slice();return o[63]=t[i],o[65]=i,o}function Gu(e,t,i){const o=e.slice();return o[69]=t[i],o}function Zu(e,t,i){const o=e.slice();return o[72]=t[i],o[65]=i,o}function Wu(e,t){let div,o,n,r,l,c,d,m=t[72]+"";return{key:e,first:null,c(){div=element("div"),o=text(m),au(div,"id",n="skintone-"+t[65]),au(div,"class",r="emoji hide-focus "+(t[65]===t[20]?"active":"")),au(div,"aria-selected",l=t[65]===t[20]),au(div,"role","option"),au(div,"title",c=t[0].skinTones[t[65]]),au(div,"tabindex","-1"),au(div,"aria-label",d=t[0].skinTones[t[65]]),this.first=div},m(e,t){eu(e,div,t),Jd(div,o)},p(e,h){t=e,512&h[0]&&m!==(m=t[72]+"")&&ou(o,m),512&h[0]&&n!==(n="skintone-"+t[65])&&au(div,"id",n),1049088&h[0]&&r!==(r="emoji hide-focus "+(t[65]===t[20]?"active":""))&&au(div,"class",r),1049088&h[0]&&l!==(l=t[65]===t[20])&&au(div,"aria-selected",l),513&h[0]&&c!==(c=t[0].skinTones[t[65]])&&au(div,"title",c),513&h[0]&&d!==(d=t[0].skinTones[t[65]])&&au(div,"aria-label",d)},d(e){e&&tu(div)}}}function Qu(e,t){let button,div,o,n,r,l,c,d,m,h=t[69].emoji+"";function f(){return t[49](t[69])}return{key:e,first:null,c(){button=element("button"),div=element("div"),o=text(h),au(div,"class","nav-emoji emoji"),au(button,"role","tab"),au(button,"class","nav-button"),au(button,"aria-controls",n="tab-"+t[69].id),au(button,"aria-label",r=t[0].categories[t[69].name]),au(button,"aria-selected",l=!t[4]&&t[13].id===t[69].id),au(button,"title",c=t[0].categories[t[69].name]),this.first=button},m(e,t){eu(e,button,t),Jd(button,div),Jd(div,o),d||(m=su(button,"click",f),d=!0)},p(e,d){t=e,4096&d[0]&&h!==(h=t[69].emoji+"")&&ou(o,h),4096&d[0]&&n!==(n="tab-"+t[69].id)&&au(button,"aria-controls",n),4097&d[0]&&r!==(r=t[0].categories[t[69].name])&&au(button,"aria-label",r),12304&d[0]&&l!==(l=!t[4]&&t[13].id===t[69].id)&&au(button,"aria-selected",l),4097&d[0]&&c!==(c=t[0].categories[t[69].name])&&au(button,"title",c)},d(e){e&&tu(button),d=!1,m()}}}function Ju(e){let img,t;return{c(){img=element("img"),au(img,"class","custom-emoji"),Qd(img.src,t=e[63].url)||au(img,"src",t),au(img,"alt",""),au(img,"loading","lazy")},m(e,t){eu(e,img,t)},p(e,o){32768&o[0]&&!Qd(img.src,t=e[63].url)&&au(img,"src",t)},d(e){e&&tu(img)}}}function tm(e){let t,o=e[27](e[63],e[8])+"";return{c(){t=text(o)},m(e,o){eu(e,t,o)},p(e,n){33024&n[0]&&o!==(o=e[27](e[63],e[8])+"")&&ou(t,o)},d(e){e&&tu(t)}}}function sm(e,t){let button,o,n,r,l,c,d;function m(e,t){return e[63].unicode?tm:Ju}let h=m(t),f=h(t);return{key:e,first:null,c(){button=element("button"),f.c(),au(button,"role",o=t[4]?"option":"menuitem"),au(button,"aria-selected",n=t[4]?t[65]==t[5]:""),au(button,"aria-label",r=t[28](t[63],t[8])),au(button,"title",l=t[63].title),au(button,"class",c="emoji "+(t[4]&&t[65]===t[5]?"active":"")),au(button,"id",d="emo-"+t[63].id),this.first=button},m(e,t){eu(e,button,t),f.m(button,null)},p(e,_){h===(h=m(t=e))&&f?f.p(t,_):(f.d(1),f=h(t),f&&(f.c(),f.m(button,null))),16&_[0]&&o!==(o=t[4]?"option":"menuitem")&&au(button,"role",o),32816&_[0]&&n!==(n=t[4]?t[65]==t[5]:"")&&au(button,"aria-selected",n),33024&_[0]&&r!==(r=t[28](t[63],t[8]))&&au(button,"aria-label",r),32768&_[0]&&l!==(l=t[63].title)&&au(button,"title",l),32816&_[0]&&c!==(c="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&au(button,"class",c),32768&_[0]&&d!==(d="emo-"+t[63].id)&&au(button,"id",d)},d(e){e&&tu(button),f.d()}}}function am(e,t){let o,n,r,l,c,d,m,h,f=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",_=[],v=new zu,y=t[66].emojis;const x=e=>e[63].id;for(let i=0;i<y.length;i+=1){let e=Ku(t,y,i),o=x(e);v.set(o,_[i]=sm(o,e))}return{key:e,first:null,c(){o=element("div"),n=text(f),c=element("div");for(let i=0;i<_.length;i+=1)_[i].c();au(o,"id",r="menu-label-"+t[65]),au(o,"class",l="category "+(1===t[15].length&&""===t[15][0].category?"gone":"")),au(o,"aria-hidden","true"),au(c,"class","emoji-menu"),au(c,"role",d=t[4]?"listbox":"menu"),au(c,"aria-labelledby",m="menu-label-"+t[65]),au(c,"id",h=t[4]?"search-results":""),this.first=o},m(e,t){eu(e,o,t),Jd(o,n),eu(e,c,t);for(let i=0;i<_.length;i+=1)_[i].m(c,null)},p(e,w){t=e,40977&w[0]&&f!==(f=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&ou(n,f),32768&w[0]&&r!==(r="menu-label-"+t[65])&&au(o,"id",r),32768&w[0]&&l!==(l="category "+(1===t[15].length&&""===t[15][0].category?"gone":""))&&au(o,"class",l),402686256&w[0]&&(y=t[66].emojis,_=ku(_,w,x,1,t,y,v,c,wu,sm,null,Ku)),16&w[0]&&d!==(d=t[4]?"listbox":"menu")&&au(c,"role",d),32768&w[0]&&m!==(m="menu-label-"+t[65])&&au(c,"aria-labelledby",m),16&w[0]&&h!==(h=t[4]?"search-results":"")&&au(c,"id",h)},d(e){e&&tu(o),e&&tu(c);for(let i=0;i<_.length;i+=1)_[i].d()}}}function om(e){let img,t;return{c(){img=element("img"),au(img,"class","custom-emoji"),Qd(img.src,t=e[63].url)||au(img,"src",t),au(img,"alt",""),au(img,"loading","lazy")},m(e,t){eu(e,img,t)},p(e,o){1024&o[0]&&!Qd(img.src,t=e[63].url)&&au(img,"src",t)},d(e){e&&tu(img)}}}function nm(e){let t,o=e[27](e[63],e[8])+"";return{c(){t=text(o)},m(e,o){eu(e,t,o)},p(e,n){1280&n[0]&&o!==(o=e[27](e[63],e[8])+"")&&ou(t,o)},d(e){e&&tu(t)}}}function rm(e,t){let button,o,n,r;function l(e,t){return e[63].unicode?nm:om}let c=l(t),d=c(t);return{key:e,first:null,c(){button=element("button"),d.c(),au(button,"role","menuitem"),au(button,"aria-label",o=t[28](t[63],t[8])),au(button,"title",n=t[63].title),au(button,"class","emoji"),au(button,"id",r="fav-"+t[63].id),this.first=button},m(e,t){eu(e,button,t),d.m(button,null)},p(e,m){c===(c=l(t=e))&&d?d.p(t,m):(d.d(1),d=c(t),d&&(d.c(),d.m(button,null))),1280&m[0]&&o!==(o=t[28](t[63],t[8]))&&au(button,"aria-label",o),1024&m[0]&&n!==(n=t[63].title)&&au(button,"title",n),1024&m[0]&&r!==(r="fav-"+t[63].id)&&au(button,"id",r)},d(e){e&&tu(button),d.d()}}}function im(e){let section,t,o,n,input,r,l,c,label,d,m,h,f,_,v,y,x,w,k,S,M,R,A,E,T,B,O,C,I,j,L,P,N,H,$,F,D,U,V,z,X,Y,K,G,Z=e[0].searchLabel+"",W=e[0].searchDescription+"",Q=e[0].skinToneDescription+"",J=[],ee=new zu,te=[],se=new zu,ae=[],oe=new zu,ne=[],re=new zu,ie=e[9];const le=e=>e[72];for(let i=0;i<ie.length;i+=1){let t=Zu(e,ie,i),o=le(t);ee.set(o,J[i]=Wu(o,t))}let ce=e[12];const de=e=>e[69].id;for(let i=0;i<ce.length;i+=1){let t=Gu(e,ce,i),o=de(t);se.set(o,te[i]=Qu(o,t))}let ue=e[15];const me=e=>e[66].category;for(let i=0;i<ue.length;i+=1){let t=Yu(e,ue,i),o=me(t);oe.set(o,ae[i]=am(o,t))}let pe=e[10];const he=e=>e[63].id;for(let i=0;i<pe.length;i+=1){let t=Xu(e,pe,i),o=he(t);re.set(o,ne[i]=rm(o,t))}return{c(){section=element("section"),t=element("div"),o=element("div"),n=element("div"),input=element("input"),label=element("label"),d=text(Z),m=element("span"),h=text(W),f=element("div"),_=element("button"),v=text(e[21]),w=element("span"),k=text(Q),S=element("div");for(let i=0;i<J.length;i+=1)J[i].c();T=element("div");for(let i=0;i<te.length;i+=1)te[i].c();O=element("div"),C=element("div"),I=element("div"),j=text(e[18]),P=element("div"),N=element("div");for(let i=0;i<ae.length;i+=1)ae[i].c();U=element("div");for(let i=0;i<ne.length;i+=1)ne[i].c();X=element("button"),X.textContent="😀",au(t,"class","pad-top"),au(input,"id","search"),au(input,"class","search"),au(input,"type","search"),au(input,"role","combobox"),au(input,"enterkeyhint","search"),au(input,"placeholder",r=e[0].searchLabel),au(input,"autocapitalize","none"),au(input,"autocomplete","off"),au(input,"spellcheck","true"),au(input,"aria-expanded",l=!(!e[4]||!e[1].length)),au(input,"aria-controls","search-results"),au(input,"aria-describedby","search-description"),au(input,"aria-autocomplete","list"),au(input,"aria-activedescendant",c=e[26]?`emo-${e[26]}`:""),au(label,"class","sr-only"),au(label,"for","search"),au(m,"id","search-description"),au(m,"class","sr-only"),au(n,"class","search-wrapper"),au(_,"id","skintone-button"),au(_,"class",y="emoji "+(e[6]?"hide-focus":"")),au(_,"aria-label",e[23]),au(_,"title",e[23]),au(_,"aria-describedby","skintone-description"),au(_,"aria-haspopup","listbox"),au(_,"aria-expanded",e[6]),au(_,"aria-controls","skintone-list"),au(f,"class",x="skintone-button-wrapper "+(e[19]?"expanded":"")),au(w,"id","skintone-description"),au(w,"class","sr-only"),au(S,"id","skintone-list"),au(S,"class",M="skintone-list "+(e[6]?"":"hidden no-animate")),ru(S,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),au(S,"role","listbox"),au(S,"aria-label",R=e[0].skinTonesLabel),au(S,"aria-activedescendant",A="skintone-"+e[20]),au(S,"aria-hidden",E=!e[6]),au(o,"class","search-row"),au(T,"class","nav"),au(T,"role","tablist"),ru(T,"grid-template-columns","repeat("+e[12].length+", 1fr)"),au(T,"aria-label",B=e[0].categoriesLabel),au(C,"class","indicator"),ru(C,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),au(O,"class","indicator-wrapper"),au(I,"class",L="message "+(e[18]?"":"gone")),au(I,"role","alert"),au(I,"aria-live","polite"),au(P,"class",H="tabpanel "+(!e[14]||e[18]?"gone":"")),au(P,"role",$=e[4]?"region":"tabpanel"),au(P,"aria-label",F=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),au(P,"id",D=e[4]?"":`tab-${e[13].id}`),au(P,"tabindex","0"),au(U,"class",V="favorites emoji-menu "+(e[18]?"gone":"")),au(U,"role","menu"),au(U,"aria-label",z=e[0].favoritesLabel),ru(U,"padding-inline-end",e[25]+"px"),au(X,"aria-hidden","true"),au(X,"tabindex","-1"),au(X,"class","abs-pos hidden emoji"),au(section,"class","picker"),au(section,"aria-label",Y=e[0].regionLabel),au(section,"style",e[22])},m(r,l){eu(r,section,l),Jd(section,t),Jd(section,o),Jd(o,n),Jd(n,input),nu(input,e[2]),Jd(n,label),Jd(label,d),Jd(n,m),Jd(m,h),Jd(o,f),Jd(f,_),Jd(_,v),Jd(o,w),Jd(w,k),Jd(o,S);for(let i=0;i<J.length;i+=1)J[i].m(S,null);e[48](S),Jd(section,T);for(let i=0;i<te.length;i+=1)te[i].m(T,null);Jd(section,O),Jd(O,C),Jd(section,I),Jd(I,j),Jd(section,P),Jd(P,N);for(let i=0;i<ae.length;i+=1)ae[i].m(N,null);e[50](P),Jd(section,U);for(let i=0;i<ne.length;i+=1)ne[i].m(U,null);var c;Jd(section,X),e[51](X),e[52](section),K||(G=[su(input,"input",e[47]),su(input,"keydown",e[30]),su(_,"click",e[35]),su(S,"focusout",e[38]),su(S,"click",e[34]),su(S,"keydown",e[36]),su(S,"keyup",e[37]),su(T,"keydown",e[32]),(c=e[29].call(null,N),c&&Kd(c.destroy)?c.destroy:Vd),su(P,"click",e[33]),su(U,"click",e[33])],K=!0)},p(e,t){1&t[0]&&r!==(r=e[0].searchLabel)&&au(input,"placeholder",r),18&t[0]&&l!==(l=!(!e[4]||!e[1].length))&&au(input,"aria-expanded",l),67108864&t[0]&&c!==(c=e[26]?`emo-${e[26]}`:"")&&au(input,"aria-activedescendant",c),4&t[0]&&nu(input,e[2]),1&t[0]&&Z!==(Z=e[0].searchLabel+"")&&ou(d,Z),1&t[0]&&W!==(W=e[0].searchDescription+"")&&ou(h,W),2097152&t[0]&&ou(v,e[21]),64&t[0]&&y!==(y="emoji "+(e[6]?"hide-focus":""))&&au(_,"class",y),8388608&t[0]&&au(_,"aria-label",e[23]),8388608&t[0]&&au(_,"title",e[23]),64&t[0]&&au(_,"aria-expanded",e[6]),524288&t[0]&&x!==(x="skintone-button-wrapper "+(e[19]?"expanded":""))&&au(f,"class",x),1&t[0]&&Q!==(Q=e[0].skinToneDescription+"")&&ou(k,Q),1049089&t[0]&&(ie=e[9],J=ku(J,t,le,1,e,ie,ee,S,wu,Wu,null,Zu)),64&t[0]&&M!==(M="skintone-list "+(e[6]?"":"hidden no-animate"))&&au(S,"class",M),64&t[0]&&ru(S,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),1&t[0]&&R!==(R=e[0].skinTonesLabel)&&au(S,"aria-label",R),1048576&t[0]&&A!==(A="skintone-"+e[20])&&au(S,"aria-activedescendant",A),64&t[0]&&E!==(E=!e[6])&&au(S,"aria-hidden",E),12305&t[0]|1&t[1]&&(ce=e[12],te=ku(te,t,de,1,e,ce,se,T,wu,Qu,null,Gu)),4096&t[0]&&ru(T,"grid-template-columns","repeat("+e[12].length+", 1fr)"),1&t[0]&&B!==(B=e[0].categoriesLabel)&&au(T,"aria-label",B),16779264&t[0]&&ru(C,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),262144&t[0]&&ou(j,e[18]),262144&t[0]&&L!==(L="message "+(e[18]?"":"gone"))&&au(I,"class",L),402694449&t[0]&&(ue=e[15],ae=ku(ae,t,me,1,e,ue,oe,N,wu,am,null,Yu)),278528&t[0]&&H!==(H="tabpanel "+(!e[14]||e[18]?"gone":""))&&au(P,"class",H),16&t[0]&&$!==($=e[4]?"region":"tabpanel")&&au(P,"role",$),8209&t[0]&&F!==(F=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name])&&au(P,"aria-label",F),8208&t[0]&&D!==(D=e[4]?"":`tab-${e[13].id}`)&&au(P,"id",D),402654464&t[0]&&(pe=e[10],ne=ku(ne,t,he,1,e,pe,re,U,wu,rm,null,Xu)),262144&t[0]&&V!==(V="favorites emoji-menu "+(e[18]?"gone":""))&&au(U,"class",V),1&t[0]&&z!==(z=e[0].favoritesLabel)&&au(U,"aria-label",z),33554432&t[0]&&ru(U,"padding-inline-end",e[25]+"px"),1&t[0]&&Y!==(Y=e[0].regionLabel)&&au(section,"aria-label",Y),4194304&t[0]&&au(section,"style",e[22])},i:Vd,o:Vd,d(t){t&&tu(section);for(let i=0;i<J.length;i+=1)J[i].d();e[48](null);for(let i=0;i<te.length;i+=1)te[i].d();for(let i=0;i<ae.length;i+=1)ae[i].d();e[50](null);for(let i=0;i<ne.length;i+=1)ne[i].d();e[51](null),e[52](null),K=!1,Yd(G)}}}function lm(e,t,o){let n,r,l,c,d,m,h,f,_,v,{skinToneEmoji:y}=t,{i18n:x}=t,{database:w}=t,{customEmoji:k}=t,{customCategorySorting:S}=t,M=[],R=[],A="",E="",T=!1,B=-1,O=!1,C=!1,I=0,j=0,L="",P=[],N=[],H=8,$=!1,F=0,D=0,U=Ru,V=!1;const z=e=>{n.getRootNode().getElementById(e).focus()},X=(e,t)=>{n.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},Y=(e,t)=>t&&e.skins&&e.skins[t]||e.unicode,K=e=>/^skintone-/.test(e.id);function G(e){const t=n.getRootNode();!function(e,t,o){for(const n of e){const e=Vu(o(n));void 0===Uu&&(Uu=Vu(t));const r=e/1.8<Uu;Nu.set(n.unicode,r)}}(e,r,(e=>t.getElementById(`emo-${e.id}`))),o(1,M)}function Z(e){return!e.unicode||!Tu(e)||Nu.get(e.unicode)}async function W(e){const t=await Pu;return e.filter((({version:e})=>!e||e<=t))}async function Q(e){return function(e,t){const o=e=>{const o={};for(const n of e)"number"==typeof n.tone&&n.version<=t&&(o[n.tone]=n.unicode);return o};return e.map((({unicode:e,skins:t,shortcodes:n,url:r,name:l,category:c})=>({unicode:e,name:l,shortcodes:n,url:r,category:c,id:e||l,skins:t&&o(t),title:(n||[]).join(", ")})))}(e,await Pu)}function J(e){o(2,A=""),o(44,E=""),o(5,B=-1),o(11,D=U.findIndex((t=>t.id===e.id)))}async function ee(e){const t=await w.getEmojiByUnicodeOrName(e),o=[...M,...N].find((t=>t.id===e)),n=o.unicode&&Y(o,I);await w.incrementFavoriteEmojiCount(e),X("emoji-click",{emoji:t,skinTone:I,...n&&{unicode:n},...o.name&&{name:o.name}})}async function te(e){const{target:t}=e;if(!K(t))return;Hu(e);const n=parseInt(t.id.slice(9),10);o(8,I=n),o(6,O=!1),z("skintone-button"),X("skin-tone-change",{skinTone:n}),w.setPreferredSkinTone(n)}Pu.then((e=>{e||o(18,c=x.emojiUnsupportedMessage)}));return e.$$set=e=>{"skinToneEmoji"in e&&o(40,y=e.skinToneEmoji),"i18n"in e&&o(0,x=e.i18n),"database"in e&&o(39,w=e.database),"customEmoji"in e&&o(41,k=e.customEmoji),"customCategorySorting"in e&&o(42,S=e.customCategorySorting)},e.$$.update=()=>{if(1280&e.$$.dirty[1]&&k&&w&&o(39,w.customEmoji=k,w),1&e.$$.dirty[0]|256&e.$$.dirty[1]){async function t(){let e=!1;const t=setTimeout((()=>{e=!0,o(18,c=x.loadingMessage)}),1e3);try{await w.ready(),o(14,V=!0)}catch(e){console.error(e),o(18,c=x.networkErrorMessage)}finally{clearTimeout(t),e&&(e=!1,o(18,c=""))}}w&&t()}if(6144&e.$$.dirty[0]|1024&e.$$.dirty[1]&&(k&&k.length?o(12,U=[Au,...Ru]):U!==Ru&&(D&&o(11,D--,D),o(12,U=Ru))),4&e.$$.dirty[0]&&Eu((()=>{o(44,E=(A||"").trim()),o(5,B=-1)})),6144&e.$$.dirty[0]&&o(13,_=U[D]),24576&e.$$.dirty[0]|8192&e.$$.dirty[1]){async function n(){if(V){if(E.length>=2){const e=E,t=await async function(e){return Q(await W(await w.getEmojiBySearchQuery(e)))}(e);e===E&&(o(1,M=t),o(4,T=!0))}else if(_){const e=_.id,t=await async function(e){if(void 0===e)return[];const t=-1===e?k:await w.getEmojiByGroup(e);return Q(await W(t))}(e);e===_.id&&(o(1,M=t),o(4,T=!1))}}else o(1,M=[]),o(4,T=!1)}n()}if(4112&e.$$.dirty[0]&&o(22,h=`\n  --font-family: ${Cu};\n  --num-groups: ${U.length}; \n  --indicator-opacity: ${T?0:1}; \n  --num-skintones: 6;`),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function r(){V&&o(8,I=await w.getPreferredSkinTone())}r()}if(512&e.$$.dirty[1]&&o(9,P=Array(6).fill().map(((e,i)=>function(e,t){if(0===t)return e;const o=e.indexOf("‍");return-1!==o?e.substring(0,o)+String.fromCodePoint(127995+t-1)+e.substring(o):(e.endsWith("️")&&(e=e.substring(0,e.length-1)),e+"\ud83c"+String.fromCodePoint(57339+t-1))}(y,i)))),768&e.$$.dirty[0]&&o(21,m=P[I]),257&e.$$.dirty[0]&&o(23,L=x.skinToneLabel.replace("{skinTone}",x.skinTones[I])),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function j(){o(45,f=(await Promise.all(Ou.map((e=>w.getEmojiByUnicodeOrName(e))))).filter(Boolean))}V&&j()}if(16384&e.$$.dirty[0]|49408&e.$$.dirty[1]){async function $(){const e=await w.getTopFavoriteEmoji(H),t=await Q(Fu([...e,...f],(e=>e.unicode||e.name)).slice(0,H));o(10,N=t)}V&&f&&$()}if(10&e.$$.dirty[0]){const F=M.filter((e=>e.unicode)).filter((e=>Tu(e)&&!Nu.has(e.unicode)));F.length?Du((()=>G(F))):(o(1,M=M.filter(Z)),Du((()=>{(l||{}).scrollTop=0})))}if(e.$$.dirty[0],e.$$.dirty[1],18&e.$$.dirty[0]|2048&e.$$.dirty[1]){o(15,R=function(){if(T)return[{category:"",emojis:M}];const e=new Map;for(const t of M){const o=t.category||"";let n=e.get(o);n||(n=[],e.set(o,n)),n.push(t)}return[...e.entries()].map((([e,t])=>({category:e,emojis:t}))).sort(((a,b)=>S(a.category,b.category)))}())}34&e.$$.dirty[0]&&o(26,v=-1!==B&&M[B].id),192&e.$$.dirty[0]&&(O?d.addEventListener("transitionend",(()=>{o(19,C=!0)}),{once:!0}):o(19,C=!1))},[x,M,A,l,T,B,O,d,I,P,N,D,U,_,V,R,n,r,c,C,j,m,h,L,$,F,v,Y,(e,t)=>{return(o=[e.name||Y(e,t),...e.shortcodes||[]],Fu(o,(e=>e))).join(", ");var o},function(e){return function(e,t){let o;return qu?(o=new ResizeObserver((e=>t(e[0].contentRect.width))),o.observe(e)):Du((()=>t(e.getBoundingClientRect().width))),{destroy(){o&&o.disconnect()}}}(e,(t=>{{const style=getComputedStyle(n),r=parseInt(style.getPropertyValue("--num-columns"),10),l="rtl"===style.getPropertyValue("direction"),c=e.parentElement.getBoundingClientRect().width-t;o(46,H=r),o(25,F=c),o(24,$=l)}}))},function(e){if(!T||!M.length)return;const t=t=>{Hu(e),o(5,B=$u(t,B,M))};switch(e.key){case"ArrowDown":return t(!1);case"ArrowUp":return t(!0);case"Enter":if(-1!==B)return Hu(e),ee(M[B].id);M.length&&o(5,B=0)}},J,function(e){const{target:t,key:o}=e,n=t=>{t&&(Hu(e),t.focus())};switch(o){case"ArrowLeft":return n(t.previousSibling);case"ArrowRight":return n(t.nextSibling);case"Home":return n(t.parentElement.firstChild);case"End":return n(t.parentElement.lastChild)}},async function(e){const{target:t}=e;if(!t.classList.contains("emoji"))return;Hu(e),ee(t.id.substring(4))},te,async function(e){o(6,O=!O),o(20,j=I),O&&(Hu(e),Du((()=>z(`skintone-${j}`))))},function(e){if(!O)return;const t=async t=>{Hu(e),o(20,j=t),await(hu(),mu),z(`skintone-${j}`)};switch(e.key){case"ArrowUp":return t($u(!0,j,P));case"ArrowDown":return t($u(!1,j,P));case"Home":return t(0);case"End":return t(P.length-1);case"Enter":return te(e);case"Escape":return Hu(e),o(6,O=!1),z("skintone-button")}},function(e){if(O)return" "===e.key?te(e):void 0},async function(e){const{relatedTarget:t}=e;t&&K(t)||o(6,O=!1)},w,y,k,S,!0,E,f,H,function(){A=this.value,o(2,A)},function(e){cu[e?"unshift":"push"]((()=>{d=e,o(7,d)}))},e=>J(e),function(e){cu[e?"unshift":"push"]((()=>{l=e,o(3,l)}))},function(e){cu[e?"unshift":"push"]((()=>{r=e,o(17,r)}))},function(e){cu[e?"unshift":"push"]((()=>{n=e,o(16,n)}))}]}class cm extends class{$destroy(){!function(component,e){const t=component.$$;null!==t.fragment&&(Yd(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}(this,1),this.$destroy=Vd}$on(e,t){const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(t),()=>{const e=o.indexOf(t);-1!==e&&o.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){super(),Su(this,e,lm,im,Gd,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}var dm={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const um=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class mm extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const style=document.createElement("style");style.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(style),this._ctx={locale:"en",dataSource:"https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",skinToneEmoji:"🖐️",customCategorySorting:Iu,customEmoji:null,i18n:dm,...e};for(const e of um)"database"!==e&&Object.prototype.hasOwnProperty.call(this,e)&&(this._ctx[e]=this[e],delete this[e]);this._dbFlush()}connectedCallback(){this._cmp=new cm({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e&&e.close().catch((e=>console.error(e)))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(e,t,o){this._set(e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase())),o)}_set(e,t){this._ctx[e]=t,this._cmp&&this._cmp.$set({[e]:t}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:t,database:o}=this._ctx;o&&o.locale===e&&o.dataSource===t||this._set("database",new qd({locale:e,dataSource:t}))}_dbFlush(){Promise.resolve().then((()=>this._dbCreate()))}}const pm={};for(const e of um)pm[e]={get(){return"database"===e&&this._dbCreate(),this._ctx[e]},set(t){if("database"===e)throw new Error("database is read-only");this._set(e,t)}};Object.defineProperties(mm.prototype,pm),customElements.get("emoji-picker")||customElements.define("emoji-picker",mm);const hm={name:"EmojiPickerContainer",components:{SvgIcon:ar},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""}},emits:["add-emoji","open-emoji"],data:()=>({emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}),watch:{emojiOpened(e){e&&setTimeout((()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",(({detail:e})=>{this.$emit("add-emoji",{unicode:e.unicode})}))}),0)}},methods:{addCustomStyling(){const style=document.createElement("style");style.textContent=".picker {\n\t\t\t\tborder: none;\n\t\t\t}.nav {\n\t\t\t\toverflow-x: auto;\n\t\t\t}.search-wrapper {\n\t\t\t\tpadding-right: 2px;\n\t\t\t\tpadding-left: 2px;\n\t\t\t}input.search {\n\t\t\t\theight: 32px;\n\t\t\t\tfont-size: 14px;\n\t\t\t\tborder-radius: 10rem;\n\t\t\t\tborder: var(--chat-border-style);\n\t\t\t\tpadding: 5px 10px;\n\t\t\t\toutline: none;\n\t\t\t\tbackground: var(--chat-bg-color-input);\n\t\t\t\tcolor: var(--chat-color);\n\t\t\t}",this.$refs.emojiPicker.shadowRoot.appendChild(style)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,o){const n=t<500||o<700,r=document.querySelector("vue-advanced-chat").shadowRoot.getElementById("room-footer");if(r)if(n)this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=o-200;else{const t=r.getBoundingClientRect().top-e>this.emojiPickerHeight-50;this.emojiPickerTop=t?e+10:e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":""}else n&&(this.emojiPickerRight="-50px")}}},fm={class:"vac-emoji-wrapper"},gm={ref:"emojiPicker","v-if":"emojiOpened"};var _m=Vn(hm,[["render",function(e,t,o,n,r,l){const c=Js("svg-icon");return Ga(),Ja("div",fm,[ro("div",{class:Ge(["vac-svg-button",{"vac-emoji-reaction":o.emojiReaction}]),onClick:t[0]||(t[0]=(...e)=>l.openEmoji&&l.openEmoji(...e))},[ra(e.$slots,o.messageId?"emoji-picker-reaction-icon_"+o.messageId:"emoji-picker-icon",{},(()=>[io(c,{name:"emoji",param:o.emojiReaction?"reaction":""},null,8,["param"])]))],2),o.emojiOpened?(Ga(),eo(un,{key:0,name:"vac-slide-up",appear:""},{default:us((()=>[ro("div",{class:Ge(["vac-emoji-picker",{"vac-picker-reaction":o.emojiReaction}]),style:ze({height:`${r.emojiPickerHeight}px`,top:o.positionTop?r.emojiPickerHeight:`${r.emojiPickerTop}px`,right:r.emojiPickerRight,display:r.emojiPickerTop||!o.emojiReaction?"initial":"none"})},[ro("emoji-picker",gm,null,512)],6)])),_:1})):mo("",!0)])}]]);const vm={class:"vac-room-file-container"},bm=["src"],ym={class:"vac-text-ellipsis"},xm={key:0,class:"vac-text-ellipsis vac-text-extension"};const wm={class:"vac-files-box"},km={class:"vac-icon-close"};var Sm=Vn({name:"RoomFiles",components:{SvgIcon:ar,RoomFile:Vn({name:"RoomFiles",components:{Loader:Qn,SvgIcon:ar},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return mc(this.file)},isVideo(){return pc(this.file)}}},[["render",function(e,t,o,n,r,l){const c=Js("loader"),d=Js("svg-icon");return Ga(),Ja("div",vm,[io(c,{show:o.file.loading,type:"room-file"},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["show"]),ro("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=t=>e.$emit("remove-file",o.index))},[ra(e.$slots,"image-close-icon",{},(()=>[io(d,{name:"close",param:"image"})]))]),l.isImage?(Ga(),Ja("div",{key:0,class:Ge(["vac-message-image",{"vac-blur-loading":o.file.loading}]),style:ze({"background-image":`url('${o.file.localUrl||o.file.url}')`})},null,6)):l.isVideo?(Ga(),Ja("video",{key:1,controls:"",class:Ge({"vac-blur-loading":o.file.loading})},[ro("source",{src:o.file.localUrl||o.file.url},null,8,bm)],2)):(Ga(),Ja("div",{key:2,class:Ge(["vac-file-container",{"vac-blur-loading":o.file.loading}])},[ro("div",null,[ra(e.$slots,"file-icon",{},(()=>[io(d,{name:"file"})]))]),ro("div",ym,We(o.file.name),1),o.file.extension?(Ga(),Ja("div",xm,We(o.file.extension),1)):mo("",!0)],2))])}]])},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{footerHeight:()=>document.querySelector("vue-advanced-chat").shadowRoot.getElementById("room-footer").clientHeight}},[["render",function(e,t,o,n,r,l){const c=Js("room-file"),d=Js("svg-icon");return Ga(),eo(un,{name:"vac-slide-up"},{default:us((()=>[o.files.length?(Ga(),Ja("div",{key:0,class:"vac-room-files-container",style:ze({bottom:`${l.footerHeight}px`})},[ro("div",wm,[(Ga(!0),Ja(qa,null,oa(o.files,((o,i)=>(Ga(),Ja("div",{key:i},[io(c,{file:o,index:i,onRemoveFile:t[0]||(t[0]=t=>e.$emit("remove-file",t))},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["file","index"])])))),128))]),ro("div",km,[ro("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=t=>e.$emit("reset-message"))},[ra(e.$slots,"files-close-icon",{},(()=>[io(d,{name:"close-outline"})]))])])],4)):mo("",!0)])),_:3})}]]);const Mm={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data:()=>({isMouseDown:!1}),methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const o=t.getBoundingClientRect().width,n=t.getBoundingClientRect().left;let r=(e.clientX-n)/o;return r=r<0?0:r,r=r>1?1:r,r}}},Rm={class:"vac-player-progress"},Am={class:"vac-line-container"};const Em={name:"AudioPlayer",components:{SvgIcon:ar,AudioControl:Vn(Mm,[["render",function(e,t,o,n,r,l){return Ga(),Ja("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...e)=>l.onMouseDown&&l.onMouseDown(...e)),onMouseover:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=t=>e.$emit("hover-audio-progress",!1))},[ro("div",Rm,[ro("div",Am,[ro("div",{class:"vac-line-progress",style:ze({width:`${o.percentage}%`})},null,4),ro("div",{class:Ge(["vac-line-dot",{"vac-line-dot__active":r.isMouseDown}]),style:ze({left:`${o.percentage}%`})},null,6)])])],544)}]])},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return`audio-player${this.messageId}`},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=document.querySelector("vue-advanced-chat").shadowRoot.getElementById(this.playerUniqId),this.player.addEventListener("ended",(()=>{this.isPlaying=!1})),this.player.addEventListener("loadeddata",(()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()})),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS:e=>new Date(1e3*e).toISOString().substr(14,5),playback(){!this.messageSelectionEnabled&&this.audioSource&&(this.isPlaying?this.player.pause():setTimeout((()=>this.player.play())),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},Tm={class:"vac-audio-player"},Bm=["id","src"];var Om=Vn(Em,[["render",function(e,t,o,n,r,l){const c=Js("svg-icon"),d=Js("audio-control");return Ga(),Ja("div",null,[ro("div",Tm,[ro("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...e)=>l.playback&&l.playback(...e))},[r.isPlaying?ra(e.$slots,"audio-pause-icon_"+o.messageId,{key:0},(()=>[io(c,{name:"audio-pause"})])):ra(e.$slots,"audio-play-icon_"+o.messageId,{key:1},(()=>[io(c,{name:"audio-play"})]))]),io(d,{percentage:r.progress,"message-selection-enabled":o.messageSelectionEnabled,onChangeLinehead:l.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",t))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),ro("audio",{id:l.playerUniqId,src:l.audioSource},null,8,Bm)])])}]]);const Cm={class:"vac-reply-box"},Im={class:"vac-reply-info"},jm={class:"vac-reply-username"},Lm={class:"vac-reply-content"},Pm=["src"],Nm={key:1,controls:"",class:"vac-image-reply"},Hm=["src"],$m={key:3,class:"vac-image-reply vac-file-container"},Fm={class:"vac-text-ellipsis"},Dm={key:0,class:"vac-text-ellipsis vac-text-extension"},Um={class:"vac-icon-reply"};var qm=Vn({name:"RoomMessageReply",components:{SvgIcon:ar,FormatMessage:tc,AudioPlayer:Om},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{footerHeight:()=>document.querySelector("vue-advanced-chat").shadowRoot.getElementById("room-footer").clientHeight,firstFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)?this.messageReply.files[0]:{}},isImage(){return mc(this.firstFile)},isVideo(){return pc(this.firstFile)},isAudio(){return fc(this.firstFile)},isOtherFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},[["render",function(e,t,o,n,r,l){const c=Js("format-message"),d=Js("audio-player"),m=Js("svg-icon");return Ga(),eo(un,{name:"vac-slide-up"},{default:us((()=>[o.messageReply?(Ga(),Ja("div",{key:0,class:"vac-reply-container",style:ze({bottom:`${l.footerHeight}px`})},[ro("div",Cm,[ro("div",Im,[ro("div",jm,We(o.messageReply.username),1),ro("div",Lm,[io(c,{"message-id":o.messageReply._id,content:o.messageReply.content,users:o.room.users,"text-formatting":o.textFormatting,"link-options":o.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),l.isImage?(Ga(),Ja("img",{key:0,src:l.firstFile.url,class:"vac-image-reply"},null,8,Pm)):l.isVideo?(Ga(),Ja("video",Nm,[ro("source",{src:l.firstFile.url},null,8,Hm)])):l.isAudio?(Ga(),eo(d,{key:2,src:l.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["src"])):l.isOtherFile?(Ga(),Ja("div",$m,[ro("div",null,[ra(e.$slots,"file-icon",{},(()=>[io(m,{name:"file"})]))]),ro("div",Fm,We(l.firstFile.name),1),l.firstFile.extension?(Ga(),Ja("div",Dm,We(l.firstFile.extension),1)):mo("",!0)])):mo("",!0)]),ro("div",Um,[ro("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=t=>e.$emit("reset-message"))},[ra(e.$slots,"reply-close-icon",{},(()=>[io(m,{name:"close-outline"})]))])])],4)):mo("",!0)])),_:3})}]]);const Vm={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data:()=>({activeItem:null}),computed:{footerHeight:()=>document.querySelector("vue-advanced-chat").shadowRoot.getElementById("room-footer").clientHeight},watch:{filteredUsersTag(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},zm=["onMouseover","onClick"],Xm={class:"vac-tags-info"},Ym={class:"vac-tags-username"};var Km=Vn(Vm,[["render",function(e,t,o,n,r,l){return Ga(),eo(un,{name:"vac-slide-up"},{default:us((()=>[o.filteredUsersTag.length?(Ga(),Ja("div",{key:0,class:"vac-tags-container",style:ze({bottom:`${l.footerHeight}px`})},[(Ga(!0),Ja(qa,null,oa(o.filteredUsersTag,((t,o)=>(Ga(),Ja("div",{key:t._id,class:Ge(["vac-tags-box",{"vac-tags-box-active":o===r.activeItem}]),onMouseover:e=>r.activeItem=o,onClick:o=>e.$emit("select-user-tag",t)},[ro("div",Xm,[t.avatar?(Ga(),Ja("div",{key:0,class:"vac-avatar vac-tags-avatar",style:ze({"background-image":`url('${t.avatar}')`})},null,4)):mo("",!0),ro("div",Ym,We(t.username),1)])],42,zm)))),128))],4)):mo("",!0)])),_:1})}]]);const Gm={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data:()=>({activeItem:null}),computed:{footerHeight:()=>document.querySelector("vue-advanced-chat").shadowRoot.getElementById("room-footer").clientHeight},watch:{filteredEmojis(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},Zm=["onMouseover","onClick"];var Wm=Vn(Gm,[["render",function(e,t,o,n,r,l){return Ga(),eo(un,{name:"vac-slide-up"},{default:us((()=>[o.filteredEmojis.length?(Ga(),Ja("div",{key:0,class:"vac-emojis-container",style:ze({bottom:`${l.footerHeight}px`})},[(Ga(!0),Ja(qa,null,oa(o.filteredEmojis,((t,o)=>(Ga(),Ja("div",{key:t,class:Ge(["vac-emoji-element",{"vac-emoji-element-active":o===r.activeItem}]),onMouseover:e=>r.activeItem=o,onClick:o=>e.$emit("select-emoji",t)},We(t),43,Zm)))),128))],4)):mo("",!0)])),_:1})}]]);const Qm={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data:()=>({activeItem:null}),computed:{footerHeight:()=>document.querySelector("vue-advanced-chat").shadowRoot.getElementById("room-footer").clientHeight},watch:{filteredTemplatesText(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},Jm=["onMouseover","onClick"],ep={class:"vac-template-info"},tp={class:"vac-template-tag"},sp={class:"vac-template-text"};var ap=Vn(Qm,[["render",function(e,t,o,n,r,l){return Ga(),eo(un,{name:"vac-slide-up"},{default:us((()=>[o.filteredTemplatesText.length?(Ga(),Ja("div",{key:0,class:"vac-template-container vac-app-box-shadow",style:ze({bottom:`${l.footerHeight}px`})},[(Ga(!0),Ja(qa,null,oa(o.filteredTemplatesText,((template,t)=>(Ga(),Ja("div",{key:t,class:Ge(["vac-template-box",{"vac-template-active":t===r.activeItem}]),onMouseover:e=>r.activeItem=t,onClick:t=>e.$emit("select-template-text",template)},[ro("div",ep,[ro("div",tp," /"+We(template.tag),1),ro("div",sp,We(template.text),1)])],42,Jm)))),128))],4)):mo("",!0)])),_:1})}]]);function op(e){return new Int16Array(e)}function np(e){return new Int32Array(e)}function ip(e){return new Float32Array(e)}var lp={fill:function(a,e,t,o){if(2==arguments.length)for(var i=0;i<a.length;i++)a[i]=arguments[1];else for(i=e;i<t;i++)a[i]=o}},cp={arraycopy:function(e,t,o,n,r){for(var l=t+r;t<l;)o[n++]=e[t++]},out:{}};cp.out.println=function(e){console.log(e)},cp.out.printf=function(){console.log.apply(console,arguments)};var dp={};function up(e){this.ordinal=e}dp.SQRT2=1.4142135623730951,dp.FAST_LOG10=function(e){return Math.log10(e)},dp.FAST_LOG10_X=function(e,t){return Math.log10(e)*t},up.short_block_allowed=new up(0),up.short_block_coupled=new up(1),up.short_block_dispensed=new up(2),up.short_block_forced=new up(3);var mp={};function pp(e){this.ordinal=e}mp.MAX_VALUE=34028235e31,pp.vbr_off=new pp(0),pp.vbr_mt=new pp(1),pp.vbr_rh=new pp(2),pp.vbr_abr=new pp(3),pp.vbr_mtrh=new pp(4),pp.vbr_default=pp.vbr_mtrh;var hp={System:cp,VbrMode:pp,Float:mp,ShortBlock:up,Util:dp,Arrays:lp,new_array_n:function e(t){if(1==t.length)return new Array(t[0]);var o=t[0];t=t.slice(1);for(var n=[],i=0;i<o;i++)n.push(e(t));return n},new_byte:function(e){return new Int8Array(e)},new_double:function(e){return new Float64Array(e)},new_float:ip,new_float_n:function e(t){if(1==t.length)return ip(t[0]);var o=t[0];t=t.slice(1);for(var n=[],i=0;i<o;i++)n.push(e(t));return n},new_int:np,new_int_n:function e(t){if(1==t.length)return np(t[0]);var o=t[0];t=t.slice(1);for(var n=[],i=0;i<o;i++)n.push(e(t));return n},new_short:op,new_short_n:function e(t){if(1==t.length)return op(t[0]);var o=t[0];t=t.slice(1);for(var n=[],i=0;i<o;i++)n.push(e(t));return n},assert:function(e){}},fp=hp.System,gp=hp.Util,_p=hp.Arrays,vp=hp.new_float;function bp(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*gp.SQRT2*.5/2384e-9,.017876148*gp.SQRT2*.5/2384e-9,.003134727*gp.SQRT2*.5/2384e-9,.002457142*gp.SQRT2*.5/2384e-9,971317e-9*gp.SQRT2*.5/2384e-9,218868e-9*gp.SQRT2*.5/2384e-9,101566e-9*gp.SQRT2*.5/2384e-9,13828e-9*gp.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],o=t[Ip.SHORT_TYPE],n=t[Ip.SHORT_TYPE],r=t[Ip.SHORT_TYPE],l=t[Ip.SHORT_TYPE],c=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function d(t,o,a){for(var u,n,r,l=10,c=o+238-14-286,i=-15;i<0;i++){var d,s,m;d=e[l+-10],s=t[c+-224]*d,m=t[o+224]*d,d=e[l+-9],s+=t[c+-160]*d,m+=t[o+160]*d,d=e[l+-8],s+=t[c+-96]*d,m+=t[o+96]*d,d=e[l+-7],s+=t[c+-32]*d,m+=t[o+32]*d,d=e[l+-6],s+=t[c+32]*d,m+=t[o+-32]*d,d=e[l+-5],s+=t[c+96]*d,m+=t[o+-96]*d,d=e[l+-4],s+=t[c+160]*d,m+=t[o+-160]*d,d=e[l+-3],s+=t[c+224]*d,m+=t[o+-224]*d,d=e[l+-2],s+=t[o+-256]*d,m-=t[c+256]*d,d=e[l+-1],s+=t[o+-192]*d,m-=t[c+192]*d,d=e[l+0],s+=t[o+-128]*d,m-=t[c+128]*d,d=e[l+1],s+=t[o+-64]*d,m-=t[c+64]*d,d=e[l+2],s+=t[o+0]*d,m-=t[c+0]*d,d=e[l+3],s+=t[o+64]*d,m-=t[c+-64]*d,d=e[l+4],s+=t[o+128]*d,m-=t[c+-128]*d,d=e[l+5],s+=t[o+192]*d,d=(m-=t[c+-192]*d)-(s*=e[l+6]),a[30+2*i]=m+s,a[31+2*i]=e[l+7]*d,l+=18,o--,c++}m=t[o+-16]*e[l+-10],s=t[o+-32]*e[l+-2],m+=(t[o+-48]-t[o+16])*e[l+-9],s+=t[o+-96]*e[l+-1],m+=(t[o+-80]+t[o+48])*e[l+-8],s+=t[o+-160]*e[l+0],m+=(t[o+-112]-t[o+80])*e[l+-7],s+=t[o+-224]*e[l+1],m+=(t[o+-144]+t[o+112])*e[l+-6],s-=t[o+32]*e[l+2],m+=(t[o+-176]-t[o+144])*e[l+-5],s-=t[o+96]*e[l+3],m+=(t[o+-208]+t[o+176])*e[l+-4],s-=t[o+160]*e[l+4],m+=(t[o+-240]-t[o+208])*e[l+-3],u=(s-=t[o+224])-m,n=s+m,m=a[14],s=a[15]-m,a[31]=n+m,a[30]=u+s,a[15]=u-s,a[14]=n-m,r=a[28]-a[0],a[0]+=a[28],a[28]=r*e[l+-36+7],r=a[29]-a[1],a[1]+=a[29],a[29]=r*e[l+-36+7],r=a[26]-a[2],a[2]+=a[26],a[26]=r*e[l+-72+7],r=a[27]-a[3],a[3]+=a[27],a[27]=r*e[l+-72+7],r=a[24]-a[4],a[4]+=a[24],a[24]=r*e[l+-108+7],r=a[25]-a[5],a[5]+=a[25],a[25]=r*e[l+-108+7],r=a[22]-a[6],a[6]+=a[22],a[22]=r*gp.SQRT2,r=a[23]-a[7],a[7]+=a[23],a[23]=r*gp.SQRT2-a[7],a[7]-=a[6],a[22]-=a[7],a[23]-=a[22],r=a[6],a[6]=a[31]-r,a[31]=a[31]+r,r=a[7],a[7]=a[30]-r,a[30]=a[30]+r,r=a[22],a[22]=a[15]-r,a[15]=a[15]+r,r=a[23],a[23]=a[14]-r,a[14]=a[14]+r,r=a[20]-a[8],a[8]+=a[20],a[20]=r*e[l+-180+7],r=a[21]-a[9],a[9]+=a[21],a[21]=r*e[l+-180+7],r=a[18]-a[10],a[10]+=a[18],a[18]=r*e[l+-216+7],r=a[19]-a[11],a[11]+=a[19],a[19]=r*e[l+-216+7],r=a[16]-a[12],a[12]+=a[16],a[16]=r*e[l+-252+7],r=a[17]-a[13],a[13]+=a[17],a[17]=r*e[l+-252+7],r=-a[20]+a[24],a[20]+=a[24],a[24]=r*e[l+-216+7],r=-a[21]+a[25],a[21]+=a[25],a[25]=r*e[l+-216+7],r=a[4]-a[8],a[4]+=a[8],a[8]=r*e[l+-216+7],r=a[5]-a[9],a[5]+=a[9],a[9]=r*e[l+-216+7],r=a[0]-a[12],a[0]+=a[12],a[12]=r*e[l+-72+7],r=a[1]-a[13],a[1]+=a[13],a[13]=r*e[l+-72+7],r=a[16]-a[28],a[16]+=a[28],a[28]=r*e[l+-72+7],r=-a[17]+a[29],a[17]+=a[29],a[29]=r*e[l+-72+7],r=gp.SQRT2*(a[2]-a[10]),a[2]+=a[10],a[10]=r,r=gp.SQRT2*(a[3]-a[11]),a[3]+=a[11],a[11]=r,r=gp.SQRT2*(-a[18]+a[26]),a[18]+=a[26],a[26]=r-a[18],r=gp.SQRT2*(-a[19]+a[27]),a[19]+=a[27],a[27]=r-a[19],r=a[2],a[19]-=a[3],a[3]-=r,a[2]=a[31]-r,a[31]+=r,r=a[3],a[11]-=a[19],a[18]-=r,a[3]=a[30]-r,a[30]+=r,r=a[18],a[27]-=a[11],a[19]-=r,a[18]=a[15]-r,a[15]+=r,r=a[19],a[10]-=r,a[19]=a[14]-r,a[14]+=r,r=a[10],a[11]-=r,a[10]=a[23]-r,a[23]+=r,r=a[11],a[26]-=r,a[11]=a[22]-r,a[22]+=r,r=a[26],a[27]-=r,a[26]=a[7]-r,a[7]+=r,r=a[27],a[27]=a[6]-r,a[6]+=r,r=gp.SQRT2*(a[0]-a[4]),a[0]+=a[4],a[4]=r,r=gp.SQRT2*(a[1]-a[5]),a[1]+=a[5],a[5]=r,r=gp.SQRT2*(a[16]-a[20]),a[16]+=a[20],a[20]=r,r=gp.SQRT2*(a[17]-a[21]),a[17]+=a[21],a[21]=r,r=-gp.SQRT2*(a[8]-a[12]),a[8]+=a[12],a[12]=r-a[8],r=-gp.SQRT2*(a[9]-a[13]),a[9]+=a[13],a[13]=r-a[9],r=-gp.SQRT2*(a[25]-a[29]),a[25]+=a[29],a[29]=r-a[25],r=-gp.SQRT2*(a[24]+a[28]),a[24]-=a[28],a[28]=r-a[24],r=a[24]-a[16],a[24]=r,r=a[20]-r,a[20]=r,r=a[28]-r,a[28]=r,r=a[25]-a[17],a[25]=r,r=a[21]-r,a[21]=r,r=a[29]-r,a[29]=r,r=a[17]-a[1],a[17]=r,r=a[9]-r,a[9]=r,r=a[25]-r,a[25]=r,r=a[5]-r,a[5]=r,r=a[21]-r,a[21]=r,r=a[13]-r,a[13]=r,r=a[29]-r,a[29]=r,r=a[1]-a[0],a[1]=r,r=a[16]-r,a[16]=r,r=a[17]-r,a[17]=r,r=a[8]-r,a[8]=r,r=a[9]-r,a[9]=r,r=a[24]-r,a[24]=r,r=a[25]-r,a[25]=r,r=a[4]-r,a[4]=r,r=a[5]-r,a[5]=r,r=a[20]-r,a[20]=r,r=a[21]-r,a[21]=r,r=a[12]-r,a[12]=r,r=a[13]-r,a[13]=r,r=a[28]-r,a[28]=r,r=a[29]-r,a[29]=r,r=a[0],a[0]+=a[31],a[31]-=r,r=a[1],a[1]+=a[30],a[30]-=r,r=a[16],a[16]+=a[15],a[15]-=r,r=a[17],a[17]+=a[14],a[14]-=r,r=a[8],a[8]+=a[23],a[23]-=r,r=a[9],a[9]+=a[22],a[22]-=r,r=a[24],a[24]+=a[7],a[7]-=r,r=a[25],a[25]+=a[6],a[6]-=r,r=a[4],a[4]+=a[27],a[27]-=r,r=a[5],a[5]+=a[26],a[26]-=r,r=a[20],a[20]+=a[11],a[11]-=r,r=a[21],a[21]+=a[10],a[10]-=r,r=a[12],a[12]+=a[19],a[19]-=r,r=a[13],a[13]+=a[18],a[18]-=r,r=a[28],a[28]+=a[3],a[3]-=r,r=a[29],a[29]+=a[2],a[2]-=r}function m(e,o){for(var n=0;n<3;n++){var r,l,c,d,m,h;l=(d=e[o+6]*t[Ip.SHORT_TYPE][0]-e[o+15])+(r=e[o+0]*t[Ip.SHORT_TYPE][2]-e[o+9]),c=d-r,m=(d=e[o+15]*t[Ip.SHORT_TYPE][0]+e[o+6])+(r=e[o+9]*t[Ip.SHORT_TYPE][2]+e[o+0]),h=-d+r,r=2069978111953089e-26*(e[o+3]*t[Ip.SHORT_TYPE][1]-e[o+12]),d=2069978111953089e-26*(e[o+12]*t[Ip.SHORT_TYPE][1]+e[o+3]),e[o+0]=190752519173728e-25*l+r,e[o+15]=190752519173728e-25*-m+d,c=.8660254037844387*c*1907525191737281e-26,m=.5*m*1907525191737281e-26+d,e[o+3]=c-m,e[o+6]=c+m,l=.5*l*1907525191737281e-26-r,h=.8660254037844387*h*1907525191737281e-26,e[o+9]=l+h,e[o+12]=l-h,o++}}this.mdct_sub48=function(e,h,f){for(var _,v,y,x,w,k,S,M,R,A,E,T,B,O,C,I,j,L,P,N,H,$=h,F=286,D=0;D<e.channels_out;D++){for(var U=0;U<e.mode_gr;U++){for(var V,z=e.l3_side.tt[U][D],X=z.xr,Y=0,samp=e.sb_sample[D][1-U],K=0,G=0;G<9;G++)for(d($,F,samp[K]),d($,F+32,samp[K+1]),K+=2,F+=64,V=1;V<32;V+=2)samp[K-1][V]*=-1;for(V=0;V<32;V++,Y+=18){var Z=z.block_type,W=e.sb_sample[D][U],Q=e.sb_sample[D][1-U];if(0!=z.mixed_block_flag&&V<2&&(Z=0),e.amp_filter[V]<1e-12)_p.fill(X,Y+0,Y+18,0);else{if(e.amp_filter[V]<1)for(G=0;G<18;G++)Q[G][c[V]]*=e.amp_filter[V];if(Z==Ip.SHORT_TYPE){for(G=-3;G<0;G++){var J=t[Ip.SHORT_TYPE][G+3];X[Y+3*G+9]=W[9+G][c[V]]*J-W[8-G][c[V]],X[Y+3*G+18]=W[14-G][c[V]]*J+W[15+G][c[V]],X[Y+3*G+10]=W[15+G][c[V]]*J-W[14-G][c[V]],X[Y+3*G+19]=Q[2-G][c[V]]*J+Q[3+G][c[V]],X[Y+3*G+11]=Q[3+G][c[V]]*J-Q[2-G][c[V]],X[Y+3*G+20]=Q[8-G][c[V]]*J+Q[9+G][c[V]]}m(X,Y)}else{var ee=vp(18);for(G=-9;G<0;G++){var a,b;a=t[Z][G+27]*Q[G+9][c[V]]+t[Z][G+36]*Q[8-G][c[V]],b=t[Z][G+9]*W[G+9][c[V]]-t[Z][G+18]*W[8-G][c[V]],ee[G+9]=a-b*o[3+G+9],ee[G+18]=a*o[3+G+9]+b}_=X,v=Y,x=void 0,w=void 0,k=void 0,S=void 0,M=void 0,R=void 0,A=void 0,E=void 0,T=void 0,B=void 0,O=void 0,C=void 0,I=void 0,j=void 0,L=void 0,P=void 0,N=void 0,H=void 0,k=(y=ee)[17]-y[9],M=y[15]-y[11],R=y[14]-y[12],A=y[0]+y[8],E=y[1]+y[7],T=y[2]+y[6],B=y[3]+y[5],_[v+17]=A+T-B-(E-y[4]),w=(A+T-B)*n[19]+(E-y[4]),x=(k-M-R)*n[18],_[v+5]=x+w,_[v+6]=x-w,S=(y[16]-y[10])*n[18],E=E*n[19]+y[4],x=k*n[12]+S+M*n[13]+R*n[14],w=-A*n[16]+E-T*n[17]+B*n[15],_[v+1]=x+w,_[v+2]=x-w,x=k*n[13]-S-M*n[14]+R*n[12],w=-A*n[17]+E-T*n[15]+B*n[16],_[v+9]=x+w,_[v+10]=x-w,x=k*n[14]-S+M*n[12]-R*n[13],w=A*n[15]-E+T*n[16]-B*n[17],_[v+13]=x+w,_[v+14]=x-w,O=y[8]-y[0],I=y[6]-y[2],j=y[5]-y[3],L=y[17]+y[9],P=y[16]+y[10],N=y[15]+y[11],H=y[14]+y[12],_[v+0]=L+N+H+(P+y[13]),x=(L+N+H)*n[19]-(P+y[13]),w=(O-I+j)*n[18],_[v+11]=x+w,_[v+12]=x-w,C=(y[7]-y[1])*n[18],P=y[13]-P*n[19],x=L*n[15]-P+N*n[16]+H*n[17],w=O*n[14]+C+I*n[12]+j*n[13],_[v+3]=x+w,_[v+4]=x-w,x=-L*n[17]+P-N*n[15]-H*n[16],w=O*n[13]+C-I*n[14]-j*n[12],_[v+7]=x+w,_[v+8]=x-w,x=-L*n[16]+P-N*n[17]-H*n[15],w=O*n[12]-C+I*n[13]-j*n[14],_[v+15]=x+w,_[v+16]=x-w}}if(Z!=Ip.SHORT_TYPE&&0!=V)for(G=7;G>=0;--G){var te,se;te=X[Y+G]*r[20+G]+X[Y+-1-G]*l[28+G],se=X[Y+G]*l[28+G]-X[Y+-1-G]*r[20+G],X[Y+-1-G]=te,X[Y+G]=se}}}if($=f,F=286,1==e.mode_gr)for(var i=0;i<18;i++)fp.arraycopy(e.sb_sample[D][1][i],0,e.sb_sample[D][0][i],0,32)}}}var yp=hp.System,xp=hp.new_float,wp=hp.new_float_n;function kp(){this.l=xp(Ip.SBMAX_l),this.s=wp([Ip.SBMAX_s,3]);var e=this;this.assign=function(t){yp.arraycopy(t.l,0,e.l,0,Ip.SBMAX_l);for(var i=0;i<Ip.SBMAX_s;i++)for(var o=0;o<3;o++)e.s[i][o]=t.s[i][o]}}function Sp(){this.thm=new kp,this.en=new kp}function Mp(e){var t=e;this.ordinal=function(){return t}}Mp.STEREO=new Mp(0),Mp.JOINT_STEREO=new Mp(1),Mp.DUAL_CHANNEL=new Mp(2),Mp.MONO=new Mp(3),Mp.NOT_SET=new Mp(4);var Rp=hp.System,Ap=hp.VbrMode,Ep=hp.new_array_n,Tp=hp.new_float,Bp=hp.new_float_n,Op=hp.new_int,Cp=hp.assert;function Ip(){var e=Ip.FFTOFFSET,t=Ip.MPG_MD_MS_LR,o=null;this.psy=null;var n=null,r=null,l=null;this.setModules=function(e,t,c,d){o=e,this.psy=t,n=t,r=d,l=c};var c=new bp;this.lame_encode_mp3_frame=function(d,m,h,f,_,v){var y,x=Ep([2,2]);x[0][0]=new Sp,x[0][1]=new Sp,x[1][0]=new Sp,x[1][1]=new Sp;var w,k=Ep([2,2]);k[0][0]=new Sp,k[0][1]=new Sp,k[1][0]=new Sp,k[1][1]=new Sp;var S,M,R,A=[null,null],E=d.internal_flags,T=Bp([2,4]),B=[.5,.5],O=[[0,0],[0,0]],C=[[0,0],[0,0]];if(A[0]=m,A[1]=h,0==E.lame_encode_frame_init&&function(e,t){var o,n,r=e.internal_flags;if(0==r.lame_encode_frame_init){var i,l,d=Tp(2014),m=Tp(2014);for(r.lame_encode_frame_init=1,i=0,l=0;i<286+576*(1+r.mode_gr);++i)i<576*r.mode_gr?(d[i]=0,2==r.channels_out&&(m[i]=0)):(d[i]=t[0][l],2==r.channels_out&&(m[i]=t[1][l]),++l);for(n=0;n<r.mode_gr;n++)for(o=0;o<r.channels_out;o++)r.l3_side.tt[n][o].block_type=Ip.SHORT_TYPE;c.mdct_sub48(r,d,m),Cp(r.mf_size>=Ip.BLKSIZE+e.framesize-Ip.FFTOFFSET),Cp(r.mf_size>=512+e.framesize-32)}}(d,A),E.padding=0,(E.slot_lag-=E.frac_SpF)<0&&(E.slot_lag+=d.out_samplerate,E.padding=1),0!=E.psymodel){var I=[null,null],j=0,L=Op(2);for(R=0;R<E.mode_gr;R++){for(M=0;M<E.channels_out;M++)I[M]=A[M],j=576+576*R-Ip.FFTOFFSET;if(0!=(d.VBR==Ap.vbr_mtrh||d.VBR==Ap.vbr_mt?n.L3psycho_anal_vbr(d,I,j,R,x,k,O[R],C[R],T[R],L):n.L3psycho_anal_ns(d,I,j,R,x,k,O[R],C[R],T[R],L)))return-4;for(d.mode==Mp.JOINT_STEREO&&(B[R]=T[R][2]+T[R][3],B[R]>0&&(B[R]=T[R][3]/B[R])),M=0;M<E.channels_out;M++){var P=E.l3_side.tt[R][M];P.block_type=L[M],P.mixed_block_flag=0}}}else for(R=0;R<E.mode_gr;R++)for(M=0;M<E.channels_out;M++)E.l3_side.tt[R][M].block_type=Ip.NORM_TYPE,E.l3_side.tt[R][M].mixed_block_flag=0,C[R][M]=O[R][M]=700;if(function(e){var t,o;if(0!=e.ATH.useAdjust)if(o=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(o+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(o+=o,t+=t),2==e.mode_gr&&(o=Math.max(o,t)),o*=.5,(o*=e.ATH.aaSensitivityP)>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var n=31.98*o+625e-6;e.ATH.adjust>=n?(e.ATH.adjust*=.075*n+.925,e.ATH.adjust<n&&(e.ATH.adjust=n)):e.ATH.adjustLimit>=n?e.ATH.adjust=n:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=n}else e.ATH.adjust=1}(E),c.mdct_sub48(E,A[0],A[1]),E.mode_ext=Ip.MPG_MD_LR_LR,d.force_ms)E.mode_ext=Ip.MPG_MD_MS_LR;else if(d.mode==Mp.JOINT_STEREO){var N=0,H=0;for(R=0;R<E.mode_gr;R++)for(M=0;M<E.channels_out;M++)N+=C[R][M],H+=O[R][M];if(N<=1*H){var $=E.l3_side.tt[0],F=E.l3_side.tt[E.mode_gr-1];$[0].block_type==$[1].block_type&&F[0].block_type==F[1].block_type&&(E.mode_ext=Ip.MPG_MD_MS_LR)}}if(E.mode_ext==t?(w=k,S=C):(w=x,S=O),d.analysis&&null!=E.pinfo)for(R=0;R<E.mode_gr;R++)for(M=0;M<E.channels_out;M++)E.pinfo.ms_ratio[R]=E.ms_ratio[R],E.pinfo.ms_ener_ratio[R]=B[R],E.pinfo.blocktype[R][M]=E.l3_side.tt[R][M].block_type,E.pinfo.pe[R][M]=S[R][M],Rp.arraycopy(E.l3_side.tt[R][M].xr,0,E.pinfo.xr[R][M],0,576),E.mode_ext==t&&(E.pinfo.ers[R][M]=E.pinfo.ers[R][M+2],Rp.arraycopy(E.pinfo.energy[R][M+2],0,E.pinfo.energy[R][M],0,E.pinfo.energy[R][M].length));if(d.VBR==Ap.vbr_off||d.VBR==Ap.vbr_abr){var i,D;for(i=0;i<18;i++)E.nsPsy.pefirbuf[i]=E.nsPsy.pefirbuf[i+1];for(D=0,R=0;R<E.mode_gr;R++)for(M=0;M<E.channels_out;M++)D+=S[R][M];for(E.nsPsy.pefirbuf[18]=D,D=E.nsPsy.pefirbuf[9],i=0;i<9;i++)D+=(E.nsPsy.pefirbuf[i]+E.nsPsy.pefirbuf[18-i])*Ip.fircoef[i];for(D=3350*E.mode_gr*E.channels_out/D,R=0;R<E.mode_gr;R++)for(M=0;M<E.channels_out;M++)S[R][M]*=D}if(E.iteration_loop.iteration_loop(d,S,B,w),o.format_bitstream(d),y=o.copy_buffer(E,f,_,v,1),d.bWriteVbrTag&&r.addVbrFrame(d),d.analysis&&null!=E.pinfo){for(M=0;M<E.channels_out;M++){var U;for(U=0;U<e;U++)E.pinfo.pcmdata[M][U]=E.pinfo.pcmdata[M][U+d.framesize];for(U=e;U<1600;U++)E.pinfo.pcmdata[M][U]=A[M][U-e]}l.set_frame_pinfo(d,w)}return function(e){var t,o;for(Cp(e.bitrate_index>=0&&e.bitrate_index<16),Cp(e.mode_ext>=0&&e.mode_ext<4),e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(o=0;o<e.channels_out;++o){var n=0|e.l3_side.tt[t][o].block_type;0!=e.l3_side.tt[t][o].mixed_block_flag&&(n=4),e.bitrate_blockType_Hist[e.bitrate_index][n]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][n]++,e.bitrate_blockType_Hist[15][5]++}}(E),y}}Ip.ENCDELAY=576,Ip.POSTDELAY=1152,Ip.MDCTDELAY=48,Ip.FFTOFFSET=224+Ip.MDCTDELAY,Ip.DECDELAY=528,Ip.SBLIMIT=32,Ip.CBANDS=64,Ip.SBPSY_l=21,Ip.SBPSY_s=12,Ip.SBMAX_l=22,Ip.SBMAX_s=13,Ip.PSFB21=6,Ip.PSFB12=6,Ip.BLKSIZE=1024,Ip.HBLKSIZE=Ip.BLKSIZE/2+1,Ip.BLKSIZE_s=256,Ip.HBLKSIZE_s=Ip.BLKSIZE_s/2+1,Ip.NORM_TYPE=0,Ip.START_TYPE=1,Ip.SHORT_TYPE=2,Ip.STOP_TYPE=3,Ip.MPG_MD_LR_LR=0,Ip.MPG_MD_LR_I=1,Ip.MPG_MD_MS_LR=2,Ip.MPG_MD_MS_I=3,Ip.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5];var jp=hp.Util,Lp=hp.new_float;function Pp(){var e=Lp(Ip.BLKSIZE),t=Lp(Ip.BLKSIZE_s/2),o=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function n(e,t,n){var r,l,c,d=0,m=t+(n<<=1);r=4;do{var h,f,i,_,v,y,x;x=r>>1,y=(v=r<<1)+(_=r),r=v<<1,c=(l=t)+x;do{R=e[l+0]-e[l+_],M=e[l+0]+e[l+_],B=e[l+v]-e[l+y],E=e[l+v]+e[l+y],e[l+v]=M-E,e[l+0]=M+E,e[l+y]=R-B,e[l+_]=R+B,R=e[c+0]-e[c+_],M=e[c+0]+e[c+_],B=jp.SQRT2*e[c+y],E=jp.SQRT2*e[c+v],e[c+v]=M-E,e[c+0]=M+E,e[c+y]=R-B,e[c+_]=R+B,c+=r,l+=r}while(l<m);for(f=o[d+0],h=o[d+1],i=1;i<x;i++){var w,k;w=1-2*h*h,k=2*h*f,l=t+i,c=t+_-i;do{var a,b,S,M,R,A,E,T,B,O;b=k*e[l+_]-w*e[c+_],a=w*e[l+_]+k*e[c+_],R=e[l+0]-a,M=e[l+0]+a,A=e[c+0]-b,S=e[c+0]+b,b=k*e[l+y]-w*e[c+y],a=w*e[l+y]+k*e[c+y],B=e[l+v]-a,E=e[l+v]+a,O=e[c+v]-b,T=e[c+v]+b,b=h*E-f*O,a=f*E+h*O,e[l+v]=M-a,e[l+0]=M+a,e[c+y]=A-b,e[c+_]=A+b,b=f*T-h*B,a=h*T+f*B,e[c+v]=S-a,e[c+0]=S+a,e[l+y]=R-b,e[l+_]=R+b,c+=r,l+=r}while(l<m);f=(w=f)*o[d+0]-h*o[d+1],h=w*o[d+1]+h*o[d+0]}d+=2}while(r<n)}var r=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,o,l,c,d){for(var b=0;b<3;b++){var m=Ip.BLKSIZE_s/2,h=65535&192*(b+1),f=Ip.BLKSIZE_s/8-1;do{var _,v,y,x,w,i=255&r[f<<2];v=(_=t[i]*c[l][d+i+h])-(w=t[127-i]*c[l][d+i+h+128]),_+=w,x=(y=t[i+64]*c[l][d+i+h+64])-(w=t[63-i]*c[l][d+i+h+192]),y+=w,m-=4,o[b][m+0]=_+y,o[b][m+2]=_-y,o[b][m+1]=v+x,o[b][m+3]=v-x,v=(_=t[i+1]*c[l][d+i+h+1])-(w=t[126-i]*c[l][d+i+h+129]),_+=w,x=(y=t[i+65]*c[l][d+i+h+65])-(w=t[62-i]*c[l][d+i+h+193]),y+=w,o[b][m+Ip.BLKSIZE_s/2+0]=_+y,o[b][m+Ip.BLKSIZE_s/2+2]=_-y,o[b][m+Ip.BLKSIZE_s/2+1]=v+x,o[b][m+Ip.BLKSIZE_s/2+3]=v-x}while(--f>=0);n(o[b],m,Ip.BLKSIZE_s/2)}},this.fft_long=function(t,o,l,c,d){var m=Ip.BLKSIZE/8-1,h=Ip.BLKSIZE/2;do{var f,_,v,y,x,i=255&r[m];_=(f=e[i]*c[l][d+i])-(x=e[i+512]*c[l][d+i+512]),f+=x,y=(v=e[i+256]*c[l][d+i+256])-(x=e[i+768]*c[l][d+i+768]),v+=x,o[(h-=4)+0]=f+v,o[h+2]=f-v,o[h+1]=_+y,o[h+3]=_-y,_=(f=e[i+1]*c[l][d+i+1])-(x=e[i+513]*c[l][d+i+513]),f+=x,y=(v=e[i+257]*c[l][d+i+257])-(x=e[i+769]*c[l][d+i+769]),v+=x,o[h+Ip.BLKSIZE/2+0]=f+v,o[h+Ip.BLKSIZE/2+2]=f-v,o[h+Ip.BLKSIZE/2+1]=_+y,o[h+Ip.BLKSIZE/2+3]=_-y}while(--m>=0);n(o,h,Ip.BLKSIZE/2)},this.init_fft=function(o){for(var i=0;i<Ip.BLKSIZE;i++)e[i]=.42-.5*Math.cos(2*Math.PI*(i+.5)/Ip.BLKSIZE)+.08*Math.cos(4*Math.PI*(i+.5)/Ip.BLKSIZE);for(i=0;i<Ip.BLKSIZE_s/2;i++)t[i]=.5*(1-Math.cos(2*Math.PI*(i+.5)/Ip.BLKSIZE_s))}}var Np=hp.VbrMode,Hp=hp.Float,$p=hp.ShortBlock,Fp=hp.Util,Dp=hp.Arrays,Up=hp.new_float,qp=hp.new_float_n,Vp=hp.new_int,zp=hp.assert;function Xp(){var e=new Pp,t=2.302585092994046,o=1/217621504/(Ip.BLKSIZE/2),n=.3,r=21,l=.2302585093;function c(e,t){for(var n=0,i=0;i<Ip.BLKSIZE/2;++i)n+=e[i]*t.ATH.eql_w[i];return n*=o}function d(t,o,n,r,l,d,m,h,f,_,v){var y=t.internal_flags;if(f<2)e.fft_long(y,r[l],f,_,v),e.fft_short(y,d[m],f,_,v);else if(2==f){for(var x=Ip.BLKSIZE-1;x>=0;--x){var w=r[l+0][x],k=r[l+1][x];r[l+0][x]=(w+k)*Fp.SQRT2*.5,r[l+1][x]=(w-k)*Fp.SQRT2*.5}for(var b=2;b>=0;--b)for(x=Ip.BLKSIZE_s-1;x>=0;--x){w=d[m+0][b][x],k=d[m+1][b][x];d[m+0][b][x]=(w+k)*Fp.SQRT2*.5,d[m+1][b][x]=(w-k)*Fp.SQRT2*.5}}o[0]=r[l+0][0],o[0]*=o[0];for(x=Ip.BLKSIZE/2-1;x>=0;--x){var S=r[l+0][Ip.BLKSIZE/2-x],M=r[l+0][Ip.BLKSIZE/2+x];o[Ip.BLKSIZE/2-x]=.5*(S*S+M*M)}for(b=2;b>=0;--b){n[b][0]=d[m+0][b][0],n[b][0]*=n[b][0];for(x=Ip.BLKSIZE_s/2-1;x>=0;--x){S=d[m+0][b][Ip.BLKSIZE_s/2-x],M=d[m+0][b][Ip.BLKSIZE_s/2+x];n[b][Ip.BLKSIZE_s/2-x]=.5*(S*S+M*M)}}var R=0;for(x=11;x<Ip.HBLKSIZE;x++)R+=o[x];if(y.tot_ener[f]=R,t.analysis){for(x=0;x<Ip.HBLKSIZE;x++)y.pinfo.energy[h][f][x]=y.pinfo.energy_save[f][x],y.pinfo.energy_save[f][x]=o[x];y.pinfo.pe[h][f]=y.pe[f]}2==t.athaa_loudapprox&&f<2&&(y.loudness_sq[h][f]=y.loudness_sq_save[f],y.loudness_sq_save[f]=c(o,y))}var m,h,f,_=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];var v=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],y=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],x=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function w(e,t,o,b,n,r){var l;if(t>e){if(!(t<e*h))return e+t;l=t/e}else{if(e>=t*h)return e+t;l=e/t}if(e+=t,b+3<=6){if(l>=m)return e;var i=0|Fp.FAST_LOG10_X(l,16);return e*y[i]}var c,d;i=0|Fp.FAST_LOG10_X(l,16);return t=0!=r?n.ATH.cb_s[o]*n.ATH.adjust:n.ATH.cb_l[o]*n.ATH.adjust,e<f*t?e>t?(c=1,i<=13&&(c=x[i]),d=Fp.FAST_LOG10_X(e/t,10/15),e*((v[i]-c)*d+c)):i>13?e:e*x[i]:e*v[i]}var k=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function S(e,t,b){var o;if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;if(o=t>e?t/e:e/t,b>=-2&&b<=2){if(o>=m)return e+t;var i=0|Fp.FAST_LOG10_X(o,16);return(e+t)*k[i]}return o<h?e+t:(e<t&&(e=t),e)}function M(e,t,o,n,r){var l,b,c=0,d=0;for(l=b=0;l<Ip.SBMAX_s;++b,++l){for(var m=e.bo_s[l],h=e.npart_s,f=m<h?m:h;b<f;)zp(t[b]>=0),zp(o[b]>=0),c+=t[b],d+=o[b],b++;if(e.en[n].s[l][r]=c,e.thm[n].s[l][r]=d,b>=h){++l;break}zp(t[b]>=0),zp(o[b]>=0);var _=e.PSY.bo_s_weight[l],v=1-_;c=_*t[b],d=_*o[b],e.en[n].s[l][r]+=c,e.thm[n].s[l][r]+=d,c=v*t[b],d=v*o[b]}for(;l<Ip.SBMAX_s;++l)e.en[n].s[l][r]=0,e.thm[n].s[l][r]=0}function R(e,t,o,n){var r,b,l=0,c=0;for(r=b=0;r<Ip.SBMAX_l;++b,++r){for(var d=e.bo_l[r],m=e.npart_l,h=d<m?d:m;b<h;)zp(t[b]>=0),zp(o[b]>=0),l+=t[b],c+=o[b],b++;if(e.en[n].l[r]=l,e.thm[n].l[r]=c,b>=m){++r;break}zp(t[b]>=0),zp(o[b]>=0);var f=e.PSY.bo_l_weight[r],_=1-f;l=f*t[b],c=f*o[b],e.en[n].l[r]+=l,e.thm[n].l[r]+=c,l=_*t[b],c=_*o[b]}for(;r<Ip.SBMAX_l;++r)e.en[n].l[r]=0,e.thm[n].l[r]=0}function A(e,t,o,n,r,l){var c,b,d=e.internal_flags;for(b=c=0;b<d.npart_s;++b){for(var m=0,h=d.numlines_s[b],i=0;i<h;++i,++c){m+=t[l][c]}o[b]=m}for(zp(b==d.npart_s),c=b=0;b<d.npart_s;b++){var f=d.s3ind_s[b][0],_=d.s3_ss[c++]*o[f];for(++f;f<=d.s3ind_s[b][1];)_+=d.s3_ss[c]*o[f],++c,++f;var v=2*d.nb_s1[r][b];if(n[b]=Math.min(_,v),d.blocktype_old[1&r]==Ip.SHORT_TYPE){v=16*d.nb_s2[r][b];var y=n[b];n[b]=Math.min(v,y)}d.nb_s2[r][b]=d.nb_s1[r][b],d.nb_s1[r][b]=_,zp(n[b]>=0)}for(;b<=Ip.CBANDS;++b)o[b]=0,n[b]=0}function E(e,t,o){return o>=1?e:o<=0?t:t>0?Math.pow(e/t,o)*t:0}var T=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function B(e,o){for(var n=309.07,r=0;r<Ip.SBMAX_s-1;r++)for(var l=0;l<3;l++){var c=e.thm.s[r][l];if(c>0){var d=c*o,m=e.en.s[r][l];m>d&&(n+=m>1e10*d?T[r]*(10*t):T[r]*Fp.FAST_LOG10(m/d))}}return n}var O=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function C(e,o){for(var n=281.0575,r=0;r<Ip.SBMAX_l-1;r++){var l=e.thm.l[r];if(l>0){var c=l*o,d=e.en.l[r];d>c&&(n+=d>1e10*c?O[r]*(10*t):O[r]*Fp.FAST_LOG10(d/c))}}return n}function I(e,t,o,n,r){var b,l;for(b=l=0;b<e.npart_l;++b){var i,c=0,d=0;for(i=0;i<e.numlines_l[b];++i,++l){var m=t[l];c+=m,d<m&&(d=m)}o[b]=c,n[b]=d,r[b]=c*e.rnumlines_l[b],zp(e.rnumlines_l[b]>=0),zp(o[b]>=0),zp(n[b]>=0),zp(r[b]>=0)}}function j(e,t,o,n){var r=_.length-1,b=0,a=o[b]+o[b+1];a>0?((l=t[b])<t[b+1]&&(l=t[b+1]),zp(e.numlines_l[b]+e.numlines_l[b+1]-1>0),(c=0|(a=20*(2*l-a)/(a*(e.numlines_l[b]+e.numlines_l[b+1]-1))))>r&&(c=r),n[b]=c):n[b]=0;for(b=1;b<e.npart_l-1;b++){var l,c;if((a=o[b-1]+o[b]+o[b+1])>0)(l=t[b-1])<t[b]&&(l=t[b]),l<t[b+1]&&(l=t[b+1]),zp(e.numlines_l[b-1]+e.numlines_l[b]+e.numlines_l[b+1]-1>0),(c=0|(a=20*(3*l-a)/(a*(e.numlines_l[b-1]+e.numlines_l[b]+e.numlines_l[b+1]-1))))>r&&(c=r),n[b]=c;else n[b]=0}(zp(b==e.npart_l-1),(a=o[b-1]+o[b])>0)?((l=t[b-1])<t[b]&&(l=t[b]),zp(e.numlines_l[b-1]+e.numlines_l[b]-1>0),(c=0|(a=20*(2*l-a)/(a*(e.numlines_l[b-1]+e.numlines_l[b]-1))))>r&&(c=r),n[b]=c):n[b]=0;zp(b==e.npart_l-1)}var L=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function P(t,o,n,r,l,c,d,m){var h=t.internal_flags;if(r<2)e.fft_long(h,d[m],r,o,n);else if(2==r)for(var f=Ip.BLKSIZE-1;f>=0;--f){var _=d[m+0][f],v=d[m+1][f];d[m+0][f]=(_+v)*Fp.SQRT2*.5,d[m+1][f]=(_-v)*Fp.SQRT2*.5}c[0]=d[m+0][0],c[0]*=c[0];for(f=Ip.BLKSIZE/2-1;f>=0;--f){var y=d[m+0][Ip.BLKSIZE/2-f],x=d[m+0][Ip.BLKSIZE/2+f];c[Ip.BLKSIZE/2-f]=.5*(y*y+x*x)}var w=0;for(f=11;f<Ip.HBLKSIZE;f++)w+=c[f];if(h.tot_ener[r]=w,t.analysis){for(f=0;f<Ip.HBLKSIZE;f++)h.pinfo.energy[l][r][f]=h.pinfo.energy_save[r][f],h.pinfo.energy_save[r][f]=c[f];h.pinfo.pe[l][r]=h.pe[r]}}function N(t,o,n,r,l,c,d,m){var h=t.internal_flags;if(0==l&&r<2&&e.fft_short(h,d[m],r,o,n),2==r)for(var f=Ip.BLKSIZE_s-1;f>=0;--f){var _=d[m+0][l][f],v=d[m+1][l][f];d[m+0][l][f]=(_+v)*Fp.SQRT2*.5,d[m+1][l][f]=(_-v)*Fp.SQRT2*.5}c[l][0]=d[m+0][l][0],c[l][0]*=c[l][0];for(f=Ip.BLKSIZE_s/2-1;f>=0;--f){var y=d[m+0][l][Ip.BLKSIZE_s/2-f],x=d[m+0][l][Ip.BLKSIZE_s/2+f];c[l][Ip.BLKSIZE_s/2-f]=.5*(y*y+x*x)}}function H(e,t,o,n){var r=e.internal_flags;2==e.athaa_loudapprox&&o<2&&(r.loudness_sq[t][o]=r.loudness_sq_save[o],r.loudness_sq_save[o]=c(n,r))}this.L3psycho_anal_ns=function(e,t,o,l,c,m,h,f,v,y){var x,k,b,i,S,T,O,P,N,H,$=e.internal_flags,F=qp([2,Ip.BLKSIZE]),D=qp([2,3,Ip.BLKSIZE_s]),U=Up(Ip.CBANDS+1),V=Up(Ip.CBANDS+1),z=Up(Ip.CBANDS+2),X=Vp(2),Y=Vp(2),K=qp([2,576]),G=Vp(Ip.CBANDS+2),Z=Vp(Ip.CBANDS+2);for(Dp.fill(Z,0),x=$.channels_out,e.mode==Mp.JOINT_STEREO&&(x=4),N=e.VBR==Np.vbr_off?0==$.ResvMax?0:$.ResvSize/$.ResvMax*.5:e.VBR==Np.vbr_rh||e.VBR==Np.vbr_mtrh||e.VBR==Np.vbr_mt?.6:1,k=0;k<$.channels_out;k++){var W=t[k],Q=o+576-350-r+192;for(i=0;i<576;i++){var J,ee;for(J=W[Q+i+10],ee=0,S=0;S<9;S+=2)J+=L[S]*(W[Q+i+S]+W[Q+i+r-S]),ee+=L[S+1]*(W[Q+i+S+1]+W[Q+i+r-S-1]);K[k][i]=J+ee}c[l][k].en.assign($.en[k]),c[l][k].thm.assign($.thm[k]),x>2&&(m[l][k].en.assign($.en[k+2]),m[l][k].thm.assign($.thm[k+2]))}for(k=0;k<x;k++){var te,se=Up(12),ae=[0,0,0,0],oe=Up(12),ne=1,re=Up(Ip.CBANDS),ie=Up(Ip.CBANDS),le=[0,0,0,0],ce=Up(Ip.HBLKSIZE),de=qp([3,Ip.HBLKSIZE_s]);for(zp($.npart_s<=Ip.CBANDS),zp($.npart_l<=Ip.CBANDS),i=0;i<3;i++)se[i]=$.nsPsy.last_en_subshort[k][i+6],zp($.nsPsy.last_en_subshort[k][i+4]>0),oe[i]=se[i]/$.nsPsy.last_en_subshort[k][i+4],ae[0]+=se[i];if(2==k)for(i=0;i<576;i++){var ue,me;ue=K[0][i],me=K[1][i],K[0][i]=ue+me,K[1][i]=ue-me}var pe=K[1&k],he=0;for(i=0;i<9;i++){for(var fe=he+64,ge=1;he<fe;he++)ge<Math.abs(pe[he])&&(ge=Math.abs(pe[he]));$.nsPsy.last_en_subshort[k][i]=se[i+3]=ge,ae[1+i/3]+=ge,ge>se[i+3-2]?(zp(se[i+3-2]>0),ge/=se[i+3-2]):ge=se[i+3-2]>10*ge?se[i+3-2]/(10*ge):0,oe[i+3]=ge}if(e.analysis){var _e=oe[0];for(i=1;i<12;i++)_e<oe[i]&&(_e=oe[i]);$.pinfo.ers[l][k]=$.pinfo.ers_save[k],$.pinfo.ers_save[k]=_e}for(te=3==k?$.nsPsy.attackthre_s:$.nsPsy.attackthre,i=0;i<12;i++)0==le[i/3]&&oe[i]>te&&(le[i/3]=i%3+1);for(i=1;i<4;i++){var ve;ae[i-1]>ae[i]?(zp(ae[i]>0),ve=ae[i-1]/ae[i]):(zp(ae[i-1]>0),ve=ae[i]/ae[i-1]),ve<1.7&&(le[i]=0,1==i&&(le[0]=0))}for(0!=le[0]&&0!=$.nsPsy.lastAttacks[k]&&(le[0]=0),3!=$.nsPsy.lastAttacks[k]&&le[0]+le[1]+le[2]+le[3]==0||(ne=0,0!=le[1]&&0!=le[0]&&(le[1]=0),0!=le[2]&&0!=le[1]&&(le[2]=0),0!=le[3]&&0!=le[2]&&(le[3]=0)),k<2?Y[k]=ne:0==ne&&(Y[0]=Y[1]=0),v[k]=$.tot_ener[k],d(e,ce,de,F,1&k,D,1&k,l,k,t,o),I($,ce,U,re,ie),j($,re,ie,G),P=0;P<3;P++){var be,ye;for(A(e,de,V,z,k,P),M($,V,z,k,P),O=0;O<Ip.SBMAX_s;O++){if(ye=$.thm[k].s[O][P],ye*=.8,le[P]>=2||1==le[P+1]){var xe=0!=P?P-1:2;ge=E($.thm[k].s[O][xe],ye,.6*N);ye=Math.min(ye,ge)}if(1==le[P]){xe=0!=P?P-1:2,ge=E($.thm[k].s[O][xe],ye,n*N);ye=Math.min(ye,ge)}else if(0!=P&&3==le[P-1]||0==P&&3==$.nsPsy.lastAttacks[k]){xe=2!=P?P+1:0,ge=E($.thm[k].s[O][xe],ye,n*N);ye=Math.min(ye,ge)}be=se[3*P+3]+se[3*P+4]+se[3*P+5],6*se[3*P+5]<be&&(ye*=.5,6*se[3*P+4]<be&&(ye*=.5)),$.thm[k].s[O][P]=ye}}for($.nsPsy.lastAttacks[k]=le[2],T=0,b=0;b<$.npart_l;b++){for(var we=$.s3ind[b][0],ke=U[we]*_[G[we]],Se=$.s3_ll[T++]*ke;++we<=$.s3ind[b][1];)ke=U[we]*_[G[we]],Se=w(Se,$.s3_ll[T++]*ke,we,we-b,$,0);Se*=.158489319246111,$.blocktype_old[1&k]==Ip.SHORT_TYPE?z[b]=Se:z[b]=E(Math.min(Se,Math.min(2*$.nb_1[k][b],16*$.nb_2[k][b])),Se,N),$.nb_2[k][b]=$.nb_1[k][b],$.nb_1[k][b]=Se}for(;b<=Ip.CBANDS;++b)U[b]=0,z[b]=0;R($,U,z,k)}(e.mode!=Mp.STEREO&&e.mode!=Mp.JOINT_STEREO||e.interChRatio>0&&function(e,t){var o=e.internal_flags;if(o.channels_out>1){for(var n=0;n<Ip.SBMAX_l;n++){var r=o.thm[0].l[n],l=o.thm[1].l[n];o.thm[0].l[n]+=l*t,o.thm[1].l[n]+=r*t}for(n=0;n<Ip.SBMAX_s;n++)for(var c=0;c<3;c++)r=o.thm[0].s[n][c],l=o.thm[1].s[n][c],o.thm[0].s[n][c]+=l*t,o.thm[1].s[n][c]+=r*t}}(e,e.interChRatio),e.mode==Mp.JOINT_STEREO)&&(!function(e){for(var t=0;t<Ip.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var o=e.mld_l[t]*e.en[3].l[t],n=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],o));o=e.mld_l[t]*e.en[2].l[t];var r=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],o));e.thm[2].l[t]=n,e.thm[3].l[t]=r}for(t=0;t<Ip.SBMAX_s;t++)for(var l=0;l<3;l++)e.thm[0].s[t][l]>1.58*e.thm[1].s[t][l]||e.thm[1].s[t][l]>1.58*e.thm[0].s[t][l]||(o=e.mld_s[t]*e.en[3].s[t][l],n=Math.max(e.thm[2].s[t][l],Math.min(e.thm[3].s[t][l],o)),o=e.mld_s[t]*e.en[2].s[t][l],r=Math.max(e.thm[3].s[t][l],Math.min(e.thm[2].s[t][l],o)),e.thm[2].s[t][l]=n,e.thm[3].s[t][l]=r)}($),H=e.msfix,Math.abs(H)>0&&function(e,t,o){var n=t,r=Math.pow(10,o);t*=2,n*=2;for(var l=0;l<Ip.SBMAX_l;l++)f=e.ATH.cb_l[e.bm_l[l]]*r,(d=Math.min(Math.max(e.thm[0].l[l],f),Math.max(e.thm[1].l[l],f)))*t<(m=Math.max(e.thm[2].l[l],f))+(h=Math.max(e.thm[3].l[l],f))&&(m*=_=d*n/(m+h),h*=_),e.thm[2].l[l]=Math.min(m,e.thm[2].l[l]),e.thm[3].l[l]=Math.min(h,e.thm[3].l[l]);for(r*=Ip.BLKSIZE_s/Ip.BLKSIZE,l=0;l<Ip.SBMAX_s;l++)for(var c=0;c<3;c++){var d,m,h,f,_;f=e.ATH.cb_s[e.bm_s[l]]*r,(d=Math.min(Math.max(e.thm[0].s[l][c],f),Math.max(e.thm[1].s[l][c],f)))*t<(m=Math.max(e.thm[2].s[l][c],f))+(h=Math.max(e.thm[3].s[l][c],f))&&(m*=_=d*t/(m+h),h*=_),e.thm[2].s[l][c]=Math.min(e.thm[2].s[l][c],m),e.thm[3].s[l][c]=Math.min(e.thm[3].s[l][c],h)}}($,H,e.ATHlower*$.ATH.adjust));for(function(e,t,o,n){var r=e.internal_flags;e.short_blocks!=$p.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var l=0;l<r.channels_out;l++)n[l]=Ip.NORM_TYPE,e.short_blocks==$p.short_block_dispensed&&(t[l]=1),e.short_blocks==$p.short_block_forced&&(t[l]=0),0!=t[l]?(zp(r.blocktype_old[l]!=Ip.START_TYPE),r.blocktype_old[l]==Ip.SHORT_TYPE&&(n[l]=Ip.STOP_TYPE)):(n[l]=Ip.SHORT_TYPE,r.blocktype_old[l]==Ip.NORM_TYPE&&(r.blocktype_old[l]=Ip.START_TYPE),r.blocktype_old[l]==Ip.STOP_TYPE&&(r.blocktype_old[l]=Ip.SHORT_TYPE)),o[l]=r.blocktype_old[l],r.blocktype_old[l]=n[l]}(e,Y,y,X),k=0;k<x;k++){var Me,Re,Ae,Ee=0;k>1?(Me=f,Ee=-2,Re=Ip.NORM_TYPE,y[0]!=Ip.SHORT_TYPE&&y[1]!=Ip.SHORT_TYPE||(Re=Ip.SHORT_TYPE),Ae=m[l][k-2]):(Me=h,Ee=0,Re=y[k],Ae=c[l][k]),Re==Ip.SHORT_TYPE?Me[Ee+k]=B(Ae,$.masking_lower):Me[Ee+k]=C(Ae,$.masking_lower),e.analysis&&($.pinfo.pe[l][k]=Me[Ee+k])}return 0};var $=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function F(e,t,o){if(0==o)for(var b=0;b<e.npart_s;b++)e.nb_s2[t][b]=e.nb_s1[t][b],e.nb_s1[t][b]=0}function D(e,t){for(var b=0;b<e.npart_l;b++)e.nb_2[t][b]=e.nb_1[t][b],e.nb_1[t][b]=0}function U(e,t,o,n,r,l){var i,c,b,d=e.internal_flags,m=new float[Ip.CBANDS],h=Up(Ip.CBANDS),f=new int[Ip.CBANDS];for(b=c=0;b<d.npart_s;++b){var v=0,y=0,x=d.numlines_s[b];for(i=0;i<x;++i,++c){var w=t[l][c];v+=w,y<w&&(y=w)}o[b]=v,m[b]=y,h[b]=v/x,zp(h[b]>=0)}for(zp(b==d.npart_s);b<Ip.CBANDS;++b)m[b]=0,h[b]=0;for(function(e,t,o,n){var r=_.length-1,b=0,a=o[b]+o[b+1];for(a>0?((l=t[b])<t[b+1]&&(l=t[b+1]),zp(e.numlines_s[b]+e.numlines_s[b+1]-1>0),(c=0|(a=20*(2*l-a)/(a*(e.numlines_s[b]+e.numlines_s[b+1]-1))))>r&&(c=r),n[b]=c):n[b]=0,b=1;b<e.npart_s-1;b++){var l,c;a=o[b-1]+o[b]+o[b+1],zp(b+1<e.npart_s),a>0?((l=t[b-1])<t[b]&&(l=t[b]),l<t[b+1]&&(l=t[b+1]),zp(e.numlines_s[b-1]+e.numlines_s[b]+e.numlines_s[b+1]-1>0),(c=0|(a=20*(3*l-a)/(a*(e.numlines_s[b-1]+e.numlines_s[b]+e.numlines_s[b+1]-1))))>r&&(c=r),n[b]=c):n[b]=0}zp(b==e.npart_s-1),(a=o[b-1]+o[b])>0?((l=t[b-1])<t[b]&&(l=t[b]),zp(e.numlines_s[b-1]+e.numlines_s[b]-1>0),(c=0|(a=20*(2*l-a)/(a*(e.numlines_s[b-1]+e.numlines_s[b]-1))))>r&&(c=r),n[b]=c):n[b]=0,zp(b==e.npart_s-1)}(d,m,h,f),c=b=0;b<d.npart_s;b++){var dd,k,M,R,A,E=d.s3ind_s[b][0],T=d.s3ind_s[b][1];for(dd=f[E],k=1,R=d.s3_ss[c]*o[E]*_[f[E]],++c,++E;E<=T;)dd+=f[E],k+=1,R=S(R,M=d.s3_ss[c]*o[E]*_[f[E]],E-b),++c,++E;R*=A=.5*_[dd=(1+2*dd)/(2*k)],n[b]=R,d.nb_s2[r][b]=d.nb_s1[r][b],d.nb_s1[r][b]=R,M=m[b],M*=d.minval_s[b],M*=A,n[b]>M&&(n[b]=M),d.masking_lower>1&&(n[b]*=d.masking_lower),n[b]>o[b]&&(n[b]=o[b]),d.masking_lower<1&&(n[b]*=d.masking_lower),zp(n[b]>=0)}for(;b<Ip.CBANDS;++b)o[b]=0,n[b]=0}function V(e,t,o,r,l){var b,c=Up(Ip.CBANDS),d=Up(Ip.CBANDS),m=Vp(Ip.CBANDS+2);I(e,t,o,c,d),j(e,c,d,m);var h=0;for(b=0;b<e.npart_l;b++){var f,v,y,x=e.s3ind[b][0],w=e.s3ind[b][1],dd=0,k=0;for(dd=m[x],k+=1,v=e.s3_ll[h]*o[x]*_[m[x]],++h,++x;x<=w;)dd+=m[x],k+=1,v=S(v,f=e.s3_ll[h]*o[x]*_[m[x]],x-b),++h,++x;if(v*=y=.5*_[dd=(1+2*dd)/(2*k)],e.blocktype_old[1&l]==Ip.SHORT_TYPE){var M=2*e.nb_1[l][b];r[b]=M>0?Math.min(v,M):Math.min(v,o[b]*n)}else{var R=16*e.nb_2[l][b],A=2*e.nb_1[l][b];R<=0&&(R=v),A<=0&&(A=v),M=e.blocktype_old[1&l]==Ip.NORM_TYPE?Math.min(A,R):A,r[b]=Math.min(v,M)}e.nb_2[l][b]=e.nb_1[l][b],e.nb_1[l][b]=v,f=c[b],f*=e.minval_l[b],f*=y,r[b]>f&&(r[b]=f),e.masking_lower>1&&(r[b]*=e.masking_lower),r[b]>o[b]&&(r[b]=o[b]),e.masking_lower<1&&(r[b]*=e.masking_lower),zp(r[b]>=0)}for(;b<Ip.CBANDS;++b)o[b]=0,r[b]=0}function z(e,t,o,n,r,l,c){for(var d,m,h=2*l,f=l>0?Math.pow(10,r):1,b=0;b<c;++b){var _=e[2][b],v=e[3][b],y=t[0][b],x=t[1][b],w=t[2][b],k=t[3][b];if(y<=1.58*x&&x<=1.58*y){var S=o[b]*v,M=o[b]*_;m=Math.max(w,Math.min(k,S)),d=Math.max(k,Math.min(w,M))}else m=w,d=k;if(l>0){var R,A,E=n[b]*f;if(R=Math.min(Math.max(y,E),Math.max(x,E)),(A=(w=Math.max(m,E))+(k=Math.max(d,E)))>0&&R*h<A){var T=R*h/A;w*=T,k*=T}m=Math.min(w,m),d=Math.min(k,d)}m>_&&(m=_),d>v&&(d=v),t[2][b]=m,t[3][b]=d}}function X(e,t){var o;return(o=e>=0?27*-e:e*t)<=-72?0:Math.exp(o*l)}function Y(e){var t,o,n=0;for(n=0;X(n,e)>1e-20;n-=1);for(r=n,h2=0;Math.abs(h2-r)>1e-12;)X(n=(h2+r)/2,e)>0?h2=n:r=n;t=r;var r,h2;n=0;for(n=0;X(n,e)>1e-20;n+=1);for(r=0,h2=n;Math.abs(h2-r)>1e-12;)X(n=(h2+r)/2,e)>0?r=n:h2=n;o=h2;var i,l=0,c=1e3;for(i=0;i<=c;++i){l+=X(n=t+i*(o-t)/c,e)}return(c+1)/(l*(o-t))}function K(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function G(e,t,o,n,r,l,c,d,m,h,f,_){var i,v=Up(Ip.CBANDS+1),y=d/(_>15?1152:384),x=Vp(Ip.HBLKSIZE);d/=m;var w=0,k=0;for(i=0;i<Ip.CBANDS;i++){var S;for(I=K(d*w),v[i]=d*w,S=w;K(d*S)-I<.34&&S<=m/2;S++);for(e[i]=S-w,k=i+1;w<S;)x[w++]=i;if(w>m/2){w=m/2,++i;break}}v[i]=d*w;for(var M=0;M<_;M++){var R,A,E,T,B;E=h[M],T=h[M+1],(R=0|Math.floor(.5+f*(E-.5)))<0&&(R=0),(A=0|Math.floor(.5+f*(T-.5)))>m/2&&(A=m/2),o[M]=(x[R]+x[A])/2,t[M]=x[A];var O=y*T;c[M]=(O-v[t[M]])/(v[t[M]+1]-v[t[M]]),c[M]<0?c[M]=0:c[M]>1&&(c[M]=1),B=K(d*h[M]*f),B=Math.min(B,15.5)/15.5,l[M]=Math.pow(10,1.25*(1-Math.cos(Math.PI*B))-2.5)}w=0;for(var C=0;C<k;C++){var I,j,L=e[C];I=K(d*w),j=K(d*(w+L-1)),n[C]=.5*(I+j),I=K(d*(w-.5)),j=K(d*(w+L-.5)),r[C]=j-I,w+=L}return k}function Z(e,t,o,n,r,c){var d,m,h,f,_,v,y=qp([Ip.CBANDS,Ip.CBANDS]),x=0;if(c)for(var i=0;i<t;i++)for(d=0;d<t;d++){var w=(m=o[i]-o[d],h=void 0,f=void 0,_=void 0,v=void 0,h=m,f=(h*=h>=0?3:1.5)>=.5&&h<=2.5?8*((v=h-.5)*v-2*v):0,((_=15.811389+7.5*(h+=.474)-17.5*Math.sqrt(1+h*h))<=-60?0:(h=Math.exp((f+_)*l),h/=.6609193))*n[d]);y[i][d]=w*r[i]}else for(d=0;d<t;d++){var k=15+Math.min(21/o[d],12),S=Y(k);for(i=0;i<t;i++){w=S*X(o[i]-o[d],k)*n[d];y[i][d]=w*r[i]}}for(i=0;i<t;i++){for(d=0;d<t&&!(y[i][d]>0);d++);for(e[i][0]=d,d=t-1;d>0&&!(y[i][d]>0);d--);e[i][1]=d,x+=e[i][1]-e[i][0]+1}var M=Up(x),R=0;for(i=0;i<t;i++)for(d=e[i][0];d<=e[i][1];d++)M[R++]=y[i][d];return M}function W(e){var t=K(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function Q(e,t){return e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e),3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4)}this.L3psycho_anal_vbr=function(e,t,o,n,l,c,d,m,h,f){var _=e.internal_flags,v=Up(Ip.HBLKSIZE),y=qp([3,Ip.HBLKSIZE_s]),x=qp([2,Ip.BLKSIZE]),w=qp([2,3,Ip.BLKSIZE_s]),k=qp([4,Ip.CBANDS]),S=qp([4,Ip.CBANDS]),A=qp([4,3]),T=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],O=Vp(2),I=e.mode==Mp.JOINT_STEREO?4:_.channels_out;!function(e,t,o,n,l,c,d,m,h,f){for(var _=qp([2,576]),v=e.internal_flags,y=v.channels_out,x=e.mode==Mp.JOINT_STEREO?4:y,w=0;w<y;w++){firbuf=t[w];for(var k=o+576-350-r+192,i=0;i<576;i++){var S,M;S=firbuf[k+i+10],M=0;for(var R=0;R<9;R+=2)S+=$[R]*(firbuf[k+i+R]+firbuf[k+i+r-R]),M+=$[R+1]*(firbuf[k+i+R+1]+firbuf[k+i+r-R-1]);_[w][i]=S+M}l[n][w].en.assign(v.en[w]),l[n][w].thm.assign(v.thm[w]),x>2&&(c[n][w].en.assign(v.en[w+2]),c[n][w].thm.assign(v.thm[w+2]))}for(w=0;w<x;w++){var A=Up(12),E=Up(12),T=[0,0,0,0],B=_[1&w],O=0,C=3==w?v.nsPsy.attackthre_s:v.nsPsy.attackthre,I=1;if(2==w)for(i=0,R=576;R>0;++i,--R){var j=_[0][i],L=_[1][i];_[0][i]=j+L,_[1][i]=j-L}for(i=0;i<3;i++)E[i]=v.nsPsy.last_en_subshort[w][i+6],zp(v.nsPsy.last_en_subshort[w][i+4]>0),A[i]=E[i]/v.nsPsy.last_en_subshort[w][i+4],T[0]+=E[i];for(i=0;i<9;i++){for(var P=O+64,N=1;O<P;O++)N<Math.abs(B[O])&&(N=Math.abs(B[O]));v.nsPsy.last_en_subshort[w][i]=E[i+3]=N,T[1+i/3]+=N,N>E[i+3-2]?(zp(E[i+3-2]>0),N/=E[i+3-2]):N=E[i+3-2]>10*N?E[i+3-2]/(10*N):0,A[i+3]=N}for(i=0;i<3;++i){var H=E[3*i+3]+E[3*i+4]+E[3*i+5],F=1;6*E[3*i+5]<H&&(F*=.5,6*E[3*i+4]<H&&(F*=.5)),m[w][i]=F}if(e.analysis){var D=A[0];for(i=1;i<12;i++)D<A[i]&&(D=A[i]);v.pinfo.ers[n][w]=v.pinfo.ers_save[w],v.pinfo.ers_save[w]=D}for(i=0;i<12;i++)0==h[w][i/3]&&A[i]>C&&(h[w][i/3]=i%3+1);for(i=1;i<4;i++){var u=T[i-1],U=T[i];Math.max(u,U)<4e4&&u<1.7*U&&U<1.7*u&&(1==i&&h[w][0]<=h[w][i]&&(h[w][0]=0),h[w][i]=0)}h[w][0]<=v.nsPsy.lastAttacks[w]&&(h[w][0]=0),3!=v.nsPsy.lastAttacks[w]&&h[w][0]+h[w][1]+h[w][2]+h[w][3]==0||(I=0,0!=h[w][1]&&0!=h[w][0]&&(h[w][1]=0),0!=h[w][2]&&0!=h[w][1]&&(h[w][2]=0),0!=h[w][3]&&0!=h[w][2]&&(h[w][3]=0)),w<2?f[w]=I:0==I&&(f[0]=f[1]=0),d[w]=v.tot_ener[w]}}(e,t,o,n,l,c,h,A,T,O),function(e,t){var o=e.internal_flags;e.short_blocks!=$p.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var n=0;n<o.channels_out;n++)e.short_blocks==$p.short_block_dispensed&&(t[n]=1),e.short_blocks==$p.short_block_forced&&(t[n]=0)}(e,O);for(var j=0;j<I;j++){P(e,t,o,j,n,v,x,X=1&j),H(e,n,j,v),0!=O[X]?V(_,v,k[j],S[j],j):D(_,j)}O[0]+O[1]==2&&e.mode==Mp.JOINT_STEREO&&z(k,S,_.mld_cb_l,_.ATH.cb_l,e.ATHlower*_.ATH.adjust,e.msfix,_.npart_l);for(j=0;j<I;j++){0!=O[X=1&j]&&R(_,k[j],S[j],j)}for(var L=0;L<3;L++){for(j=0;j<I;++j){0!=O[X=1&j]?F(_,j,L):(N(e,t,o,j,L,y,w,X),U(e,y,k[j],S[j],j,L))}O[0]+O[1]==0&&e.mode==Mp.JOINT_STEREO&&z(k,S,_.mld_cb_s,_.ATH.cb_s,e.ATHlower*_.ATH.adjust,e.msfix,_.npart_s);for(j=0;j<I;++j){0==O[X=1&j]&&M(_,k[j],S[j],j,L)}}for(j=0;j<I;j++){var X;if(0==O[X=1&j])for(var Y=0;Y<Ip.SBMAX_s;Y++){var K=Up(3);for(L=0;L<3;L++){var G=_.thm[j].s[Y][L];if(G*=.8,T[j][L]>=2||1==T[j][L+1]){var Z=0!=L?L-1:2,W=E(_.thm[j].s[Y][Z],G,.36);G=Math.min(G,W)}else if(1==T[j][L]){Z=0!=L?L-1:2,W=E(_.thm[j].s[Y][Z],G,.18);G=Math.min(G,W)}else if(0!=L&&3==T[j][L-1]||0==L&&3==_.nsPsy.lastAttacks[j]){Z=2!=L?L+1:0,W=E(_.thm[j].s[Y][Z],G,.18);G=Math.min(G,W)}G*=A[j][L],K[L]=G}for(L=0;L<3;L++)_.thm[j].s[Y][L]=K[L]}}for(j=0;j<I;j++)_.nsPsy.lastAttacks[j]=T[j][2];!function(e,t,o){for(var n=e.internal_flags,r=0;r<n.channels_out;r++){var l=Ip.NORM_TYPE;0!=t[r]?(zp(n.blocktype_old[r]!=Ip.START_TYPE),n.blocktype_old[r]==Ip.SHORT_TYPE&&(l=Ip.STOP_TYPE)):(l=Ip.SHORT_TYPE,n.blocktype_old[r]==Ip.NORM_TYPE&&(n.blocktype_old[r]=Ip.START_TYPE),n.blocktype_old[r]==Ip.STOP_TYPE&&(n.blocktype_old[r]=Ip.SHORT_TYPE)),o[r]=n.blocktype_old[r],n.blocktype_old[r]=l}}(e,O,f);for(j=0;j<I;j++){var Q,J,ee,te;j>1?(Q=m,J=-2,ee=Ip.NORM_TYPE,f[0]!=Ip.SHORT_TYPE&&f[1]!=Ip.SHORT_TYPE||(ee=Ip.SHORT_TYPE),te=c[n][j-2]):(Q=d,J=0,ee=f[j],te=l[n][j]),ee==Ip.SHORT_TYPE?Q[J+j]=B(te,_.masking_lower):Q[J+j]=C(te,_.masking_lower),e.analysis&&(_.pinfo.pe[n][j]=Q[J+j])}return 0},this.psymodel_init=function(o){var i,n=o.internal_flags,r=!0,l=13,c=24,d=0,_=0,v=-8.25,y=-4.5,x=Up(Ip.CBANDS),w=Up(Ip.CBANDS),k=Up(Ip.CBANDS),S=o.out_samplerate;switch(o.experimentalZ){default:case 0:r=!0;break;case 1:r=!(o.VBR==Np.vbr_mtrh||o.VBR==Np.vbr_mt);break;case 2:r=!1;break;case 3:l=8,d=-1.75,_=-.0125,v=-8.25,y=-2.25}for(n.ms_ener_ratio_old=.25,n.blocktype_old[0]=n.blocktype_old[1]=Ip.NORM_TYPE,i=0;i<4;++i){for(var M=0;M<Ip.CBANDS;++M)n.nb_1[i][M]=1e20,n.nb_2[i][M]=1e20,n.nb_s1[i][M]=n.nb_s2[i][M]=1;for(var R=0;R<Ip.SBMAX_l;R++)n.en[i].l[R]=1e20,n.thm[i].l[R]=1e20;for(M=0;M<3;++M){for(R=0;R<Ip.SBMAX_s;R++)n.en[i].s[R][M]=1e20,n.thm[i].s[R][M]=1e20;n.nsPsy.lastAttacks[i]=0}for(M=0;M<9;M++)n.nsPsy.last_en_subshort[i][M]=10}for(n.loudness_sq_save[0]=n.loudness_sq_save[1]=0,n.npart_l=G(n.numlines_l,n.bo_l,n.bm_l,x,w,n.mld_l,n.PSY.bo_l_weight,S,Ip.BLKSIZE,n.scalefac_band.l,Ip.BLKSIZE/1152,Ip.SBMAX_l),zp(n.npart_l<Ip.CBANDS),i=0;i<n.npart_l;i++){var A=d;x[i]>=l&&(A=_*(x[i]-l)/(c-l)+d*(c-x[i])/(c-l)),k[i]=Math.pow(10,A/10),n.numlines_l[i]>0?n.rnumlines_l[i]=1/n.numlines_l[i]:n.rnumlines_l[i]=0}n.s3_ll=Z(n.s3ind,n.npart_l,x,w,k,r);var E;M=0;for(i=0;i<n.npart_l;i++){O=Hp.MAX_VALUE;for(var T=0;T<n.numlines_l[i];T++,M++){var B=S*M/(1e3*Ip.BLKSIZE);C=this.ATHformula(1e3*B,o)-20,C=Math.pow(10,.1*C),O>(C*=n.numlines_l[i])&&(O=C)}n.ATH.cb_l[i]=O,(O=20*x[i]/10-20)>6&&(O=100),O<-15&&(O=-15),O-=8,n.minval_l[i]=Math.pow(10,O/10)*n.numlines_l[i]}for(n.npart_s=G(n.numlines_s,n.bo_s,n.bm_s,x,w,n.mld_s,n.PSY.bo_s_weight,S,Ip.BLKSIZE_s,n.scalefac_band.s,Ip.BLKSIZE_s/384,Ip.SBMAX_s),zp(n.npart_s<Ip.CBANDS),M=0,i=0;i<n.npart_s;i++){var O;A=v;x[i]>=l&&(A=y*(x[i]-l)/(c-l)+v*(c-x[i])/(c-l)),k[i]=Math.pow(10,A/10),O=Hp.MAX_VALUE;for(T=0;T<n.numlines_s[i];T++,M++){var C;B=S*M/(1e3*Ip.BLKSIZE_s);C=this.ATHformula(1e3*B,o)-20,C=Math.pow(10,.1*C),O>(C*=n.numlines_s[i])&&(O=C)}n.ATH.cb_s[i]=O,O=7*x[i]/12-7,x[i]>12&&(O*=1+3.1*Math.log(1+O)),x[i]<12&&(O*=1+2.3*Math.log(1-O)),O<-15&&(O=-15),O-=8,n.minval_s[i]=Math.pow(10,O/10)*n.numlines_s[i]}n.s3_ss=Z(n.s3ind_s,n.npart_s,x,w,k,r),m=Math.pow(10,9/16),h=Math.pow(10,1.5),f=Math.pow(10,1.5),e.init_fft(n),n.decay=Math.exp(-1*t/(.01*S/192)),E=3.5,0!=(2&o.exp_nspsytune)&&(E=1),Math.abs(o.msfix)>0&&(E=o.msfix),o.msfix=E;for(var b=0;b<n.npart_l;b++)n.s3ind[b][1]>n.npart_l-1&&(n.s3ind[b][1]=n.npart_l-1);var I=576*n.mode_gr/S;if(n.ATH.decay=Math.pow(10,-1.2*I),n.ATH.adjust=.01,n.ATH.adjustLimit=1,zp(n.bo_l[Ip.SBMAX_l-1]<=n.npart_l),zp(n.bo_s[Ip.SBMAX_s-1]<=n.npart_s),-1!=o.ATHtype){var j=o.out_samplerate/Ip.BLKSIZE,L=0;for(B=0,i=0;i<Ip.BLKSIZE/2;++i)B+=j,n.ATH.eql_w[i]=1/Math.pow(10,this.ATHformula(B,o)/10),L+=n.ATH.eql_w[i];for(L=1/L,i=Ip.BLKSIZE/2;--i>=0;)n.ATH.eql_w[i]*=L}for(b=M=0;b<n.npart_s;++b)for(i=0;i<n.numlines_s[b];++i)++M;for(b=M=0;b<n.npart_l;++b)for(i=0;i<n.numlines_l[b];++i)++M;for(M=0,i=0;i<n.npart_l;i++){B=S*(M+n.numlines_l[i]/2)/(1*Ip.BLKSIZE);n.mld_cb_l[i]=W(B),M+=n.numlines_l[i]}for(;i<Ip.CBANDS;++i)n.mld_cb_l[i]=1;for(M=0,i=0;i<n.npart_s;i++){B=S*(M+n.numlines_s[i]/2)/(1*Ip.BLKSIZE_s);n.mld_cb_s[i]=W(B),M+=n.numlines_s[i]}for(;i<Ip.CBANDS;++i)n.mld_cb_s[i]=1;return 0},this.ATHformula=function(e,t){var o;switch(t.ATHtype){case 0:o=Q(e,9);break;case 1:o=Q(e,-1);break;case 2:default:o=Q(e,0);break;case 3:o=Q(e,1)+6;break;case 4:o=Q(e,t.ATHcurve)}return o}}function Yp(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=Mp.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var Kp={};Kp.SFBMAX=3*Ip.SBMAX_s;var Gp=hp.new_float,Zp=hp.new_int;function Wp(){this.xr=Gp(576),this.l3_enc=Zp(576),this.scalefac=Zp(Kp.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=Zp(3),this.subblock_gain=Zp(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=Zp(Kp.SFBMAX),this.window=Zp(Kp.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=Zp(4),this.max_nonzero_coeff=0;var e=this;function t(e){return new Int32Array(e)}this.assign=function(o){var n;e.xr=(n=o.xr,new Float32Array(n)),e.l3_enc=t(o.l3_enc),e.scalefac=t(o.scalefac),e.xrpow_max=o.xrpow_max,e.part2_3_length=o.part2_3_length,e.big_values=o.big_values,e.count1=o.count1,e.global_gain=o.global_gain,e.scalefac_compress=o.scalefac_compress,e.block_type=o.block_type,e.mixed_block_flag=o.mixed_block_flag,e.table_select=t(o.table_select),e.subblock_gain=t(o.subblock_gain),e.region0_count=o.region0_count,e.region1_count=o.region1_count,e.preflag=o.preflag,e.scalefac_scale=o.scalefac_scale,e.count1table_select=o.count1table_select,e.part2_length=o.part2_length,e.sfb_lmax=o.sfb_lmax,e.sfb_smin=o.sfb_smin,e.psy_lmax=o.psy_lmax,e.sfbmax=o.sfbmax,e.psymax=o.psymax,e.sfbdivide=o.sfbdivide,e.width=t(o.width),e.window=t(o.window),e.count1bits=o.count1bits,e.sfb_partition_table=o.sfb_partition_table.slice(0),e.slen=t(o.slen),e.max_nonzero_coeff=o.max_nonzero_coeff}}var Qp=hp.new_int;function Jp(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[Qp(4),Qp(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new Wp}var eh=hp.System,sh=hp.new_int;function ah(e,t,o,n){this.l=sh(1+Ip.SBMAX_l),this.s=sh(1+Ip.SBMAX_s),this.psfb21=sh(1+Ip.PSFB21),this.psfb12=sh(1+Ip.PSFB12);var r=this.l,s=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],eh.arraycopy(this.arrL,0,r,0,Math.min(this.arrL.length,this.l.length)),eh.arraycopy(this.arrS,0,s,0,Math.min(this.arrS.length,this.s.length)),eh.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),eh.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var oh=hp.new_float,nh=hp.new_float_n,rh=hp.new_int;function ih(){this.last_en_subshort=nh([4,9]),this.lastAttacks=rh(4),this.pefirbuf=oh(19),this.longfact=oh(Ip.SBMAX_l),this.shortfact=oh(Ip.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function lh(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var ch=hp.new_byte,dh=hp.new_double,uh=hp.new_float,mh=hp.new_float_n,ph=hp.new_int,hh=hp.new_int_n;function fh(){function e(){this.write_timing=0,this.ptr=0,this.buf=ch(40)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=mh([2,fh.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new Jp,this.ms_ratio=uh(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=ph(2),this.CurrentStep=ph(2),this.masking_lower=0,this.bv_scf=ph(576),this.pseudohalf=ph(Kp.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*fh.BPC+1),this.itime=dh(2),this.sideinfo_len=0,this.sb_sample=mh([2,2,18,Ip.SBLIMIT]),this.amp_filter=uh(32),this.header=new Array(fh.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new ah,this.minval_l=uh(Ip.CBANDS),this.minval_s=uh(Ip.CBANDS),this.nb_1=mh([4,Ip.CBANDS]),this.nb_2=mh([4,Ip.CBANDS]),this.nb_s1=mh([4,Ip.CBANDS]),this.nb_s2=mh([4,Ip.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=uh(4),this.loudness_sq=mh([2,2]),this.loudness_sq_save=uh(2),this.mld_l=uh(Ip.SBMAX_l),this.mld_s=uh(Ip.SBMAX_s),this.bm_l=ph(Ip.SBMAX_l),this.bo_l=ph(Ip.SBMAX_l),this.bm_s=ph(Ip.SBMAX_s),this.bo_s=ph(Ip.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=hh([Ip.CBANDS,2]),this.s3ind_s=hh([Ip.CBANDS,2]),this.numlines_s=ph(Ip.CBANDS),this.numlines_l=ph(Ip.CBANDS),this.rnumlines_l=uh(Ip.CBANDS),this.mld_cb_l=uh(Ip.CBANDS),this.mld_cb_s=uh(Ip.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=uh(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=ph(2),this.nsPsy=new ih,this.VBR_seek_table=new lh,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=hh([16,5]),this.bitrate_blockType_Hist=hh([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var i=0;i<this.en.length;i++)this.en[i]=new kp;for(i=0;i<this.thm.length;i++)this.thm[i]=new kp;for(i=0;i<this.header.length;i++)this.header[i]=new e}fh.MFSIZE=3456+Ip.ENCDELAY-Ip.MDCTDELAY,fh.MAX_HEADER_BUF=256,fh.MAX_BITS_PER_CHANNEL=4095,fh.MAX_BITS_PER_GRANULE=7680,fh.BPC=320;var gh=hp.new_float;function _h(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=gh(Ip.SBMAX_l),this.s=gh(Ip.SBMAX_s),this.psfb21=gh(Ip.PSFB21),this.psfb12=gh(Ip.PSFB12),this.cb_l=gh(Ip.CBANDS),this.cb_s=gh(Ip.CBANDS),this.eql_w=gh(Ip.BLKSIZE/2)}var vh=hp.System,bh=hp.Arrays;function yh(){var e=yh.RMS_WINDOW_TIME_NUMERATOR,t=yh.RMS_WINDOW_TIME_DENOMINATOR,o=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],n=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function r(input,e,output,t,o,n){for(;0!=o--;)output[t]=1e-10+input[e+0]*n[0]-output[t-1]*n[1]+input[e-1]*n[2]-output[t-2]*n[3]+input[e-2]*n[4]-output[t-3]*n[5]+input[e-3]*n[6]-output[t-4]*n[7]+input[e-4]*n[8]-output[t-5]*n[9]+input[e-5]*n[10]-output[t-6]*n[11]+input[e-6]*n[12]-output[t-7]*n[13]+input[e-7]*n[14]-output[t-8]*n[15]+input[e-8]*n[16]-output[t-9]*n[17]+input[e-9]*n[18]-output[t-10]*n[19]+input[e-10]*n[20],++t,++e}function l(input,e,output,t,o,n){for(;0!=o--;)output[t]=input[e+0]*n[0]-output[t-1]*n[1]+input[e-1]*n[2]-output[t-2]*n[3]+input[e-2]*n[4],++t,++e}function c(e){return e*e}this.InitGainAnalysis=function(o,n){return function(o,n){for(var i=0;i<MAX_ORDER;i++)o.linprebuf[i]=o.lstepbuf[i]=o.loutbuf[i]=o.rinprebuf[i]=o.rstepbuf[i]=o.routbuf[i]=0;switch(0|n){case 48e3:o.reqindex=0;break;case 44100:o.reqindex=1;break;case 32e3:o.reqindex=2;break;case 24e3:o.reqindex=3;break;case 22050:o.reqindex=4;break;case 16e3:o.reqindex=5;break;case 12e3:o.reqindex=6;break;case 11025:o.reqindex=7;break;case 8e3:o.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return o.sampleWindow=0|(n*e+t-1)/t,o.lsum=0,o.rsum=0,o.totsamp=0,bh.ill(o.A,0),INIT_GAIN_ANALYSIS_OK}(o,n)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(o.linpre=MAX_ORDER,o.rinpre=MAX_ORDER,o.lstep=MAX_ORDER,o.rstep=MAX_ORDER,o.lout=MAX_ORDER,o.rout=MAX_ORDER,bh.fill(o.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(e,t,d,m,h,f,_){var v,y,x,w,k,S,M;if(0==f)return GAIN_ANALYSIS_OK;switch(M=0,k=f,_){case 1:m=t,h=d;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(f<MAX_ORDER?(vh.arraycopy(t,d,e.linprebuf,MAX_ORDER,f),vh.arraycopy(m,h,e.rinprebuf,MAX_ORDER,f)):(vh.arraycopy(t,d,e.linprebuf,MAX_ORDER,MAX_ORDER),vh.arraycopy(m,h,e.rinprebuf,MAX_ORDER,MAX_ORDER));k>0;){S=k>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:k,M<MAX_ORDER?(v=e.linpre+M,y=e.linprebuf,x=e.rinpre+M,w=e.rinprebuf,S>MAX_ORDER-M&&(S=MAX_ORDER-M)):(v=d+M,y=t,x=h+M,w=m),r(y,v,e.lstepbuf,e.lstep+e.totsamp,S,o[e.reqindex]),r(w,x,e.rstepbuf,e.rstep+e.totsamp,S,o[e.reqindex]),l(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,S,n[e.reqindex]),l(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,S,n[e.reqindex]),v=e.lout+e.totsamp,y=e.loutbuf,x=e.rout+e.totsamp,w=e.routbuf;for(var i=S%8;0!=i--;)e.lsum+=c(y[v++]),e.rsum+=c(w[x++]);for(i=S/8;0!=i--;)e.lsum+=c(y[v+0])+c(y[v+1])+c(y[v+2])+c(y[v+3])+c(y[v+4])+c(y[v+5])+c(y[v+6])+c(y[v+7]),v+=8,e.rsum+=c(w[x+0])+c(w[x+1])+c(w[x+2])+c(w[x+3])+c(w[x+4])+c(w[x+5])+c(w[x+6])+c(w[x+7]),x+=8;if(k-=S,M+=S,e.totsamp+=S,e.totsamp==e.sampleWindow){var R=10*yh.STEPS_per_dB*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),A=R<=0?0:0|R;A>=e.A.length&&(A=e.A.length-1),e.A[A]++,e.lsum=e.rsum=0,vh.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),vh.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),vh.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),vh.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return f<MAX_ORDER?(vh.arraycopy(e.linprebuf,f,e.linprebuf,0,MAX_ORDER-f),vh.arraycopy(e.rinprebuf,f,e.rinprebuf,0,MAX_ORDER-f),vh.arraycopy(t,d,e.linprebuf,MAX_ORDER-f,f),vh.arraycopy(m,h,e.rinprebuf,MAX_ORDER-f,f)):(vh.arraycopy(t,d+f-MAX_ORDER,e.linprebuf,0,MAX_ORDER),vh.arraycopy(m,h+f-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){for(var t=function(e,t){var i,o=0;for(i=0;i<t;i++)o+=e[i];if(0==o)return GAIN_NOT_ENOUGH_SAMPLES;var n=0|Math.ceil(o*(1-.95));for(i=t;i-- >0&&!((n-=e[i])<=0););return 64.82-i/yh.STEPS_per_dB}(e.A,e.A.length),i=0;i<e.A.length;i++)e.B[i]+=e.A[i],e.A[i]=0;for(i=0;i<MAX_ORDER;i++)e.linprebuf[i]=e.lstepbuf[i]=e.loutbuf[i]=e.rinprebuf[i]=e.rstepbuf[i]=e.routbuf[i]=0;return e.totsamp=0,e.lsum=e.rsum=0,t}}yh.STEPS_per_dB=100,yh.MAX_dB=120,yh.GAIN_NOT_ENOUGH_SAMPLES=-24601,yh.GAIN_ANALYSIS_ERROR=0,yh.GAIN_ANALYSIS_OK=1,yh.INIT_GAIN_ANALYSIS_ERROR=0,yh.INIT_GAIN_ANALYSIS_OK=1,yh.YULE_ORDER=10,yh.MAX_ORDER=yh.YULE_ORDER,yh.MAX_SAMP_FREQ=48e3,yh.RMS_WINDOW_TIME_NUMERATOR=1,yh.RMS_WINDOW_TIME_DENOMINATOR=20,yh.MAX_SAMPLES_PER_WINDOW=yh.MAX_SAMP_FREQ*yh.RMS_WINDOW_TIME_NUMERATOR/yh.RMS_WINDOW_TIME_DENOMINATOR+1;var xh=hp.new_float,wh=hp.new_int;function kh(){this.linprebuf=xh(NaN),this.linpre=0,this.lstepbuf=xh(NaN),this.lstep=0,this.loutbuf=xh(NaN),this.lout=0,this.rinprebuf=xh(NaN),this.rinpre=0,this.rstepbuf=xh(NaN),this.rstep=0,this.routbuf=xh(NaN),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=wh(0),this.B=wh(0)}function Sh(e){this.bits=e}var Mh=hp.new_float,Rh=hp.new_int,Ah=hp.assert;function Eh(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,o,n){var r,l=e.internal_flags,c=Mh(Kp.SFBMAX),d=Mh(576),m=Rh(2),h=0,f=l.l3_side,_=new Sh(h);this.quantize.rv.ResvFrameBegin(e,_),h=_.bits;for(var v=0;v<l.mode_gr;v++){r=this.quantize.qupvt.on_pe(e,t,m,h,v,v),l.mode_ext==Ip.MPG_MD_MS_LR&&(this.quantize.ms_convert(l.l3_side,v),this.quantize.qupvt.reduce_side(m,o[v],h,r));for(var y=0;y<l.channels_out;y++){var x,w,k=f.tt[v][y];k.block_type!=Ip.SHORT_TYPE?(x=0,w=l.PSY.mask_adjust-x):(x=0,w=l.PSY.mask_adjust_short-x),l.masking_lower=Math.pow(10,.1*w),this.quantize.init_outer_loop(l,k),this.quantize.init_xrpow(l,k,d)&&(this.quantize.qupvt.calc_xmin(e,n[v][y],k,c),this.quantize.outer_loop(e,k,c,d,y,m[y])),this.quantize.iteration_finish_one(l,v,y),Ah(k.part2_3_length<=fh.MAX_BITS_PER_CHANNEL),Ah(k.part2_3_length<=m[y])}}this.quantize.rv.ResvFrameEnd(l,h)}}function Th(e,t,o,n){this.xlen=e,this.linmax=t,this.table=o,this.hlen=n}var Bh={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};Bh.ht=[new Th(0,0,null,null),new Th(2,0,Bh.t1HB,Bh.t1l),new Th(3,0,Bh.t2HB,Bh.t2l),new Th(3,0,Bh.t3HB,Bh.t3l),new Th(0,0,null,null),new Th(4,0,Bh.t5HB,Bh.t5l),new Th(4,0,Bh.t6HB,Bh.t6l),new Th(6,0,Bh.t7HB,Bh.t7l),new Th(6,0,Bh.t8HB,Bh.t8l),new Th(6,0,Bh.t9HB,Bh.t9l),new Th(8,0,Bh.t10HB,Bh.t10l),new Th(8,0,Bh.t11HB,Bh.t11l),new Th(8,0,Bh.t12HB,Bh.t12l),new Th(16,0,Bh.t13HB,Bh.t13l),new Th(0,0,null,Bh.t16_5l),new Th(16,0,Bh.t15HB,Bh.t15l),new Th(1,1,Bh.t16HB,Bh.t16l),new Th(2,3,Bh.t16HB,Bh.t16l),new Th(3,7,Bh.t16HB,Bh.t16l),new Th(4,15,Bh.t16HB,Bh.t16l),new Th(6,63,Bh.t16HB,Bh.t16l),new Th(8,255,Bh.t16HB,Bh.t16l),new Th(10,1023,Bh.t16HB,Bh.t16l),new Th(13,8191,Bh.t16HB,Bh.t16l),new Th(4,15,Bh.t24HB,Bh.t24l),new Th(5,31,Bh.t24HB,Bh.t24l),new Th(6,63,Bh.t24HB,Bh.t24l),new Th(7,127,Bh.t24HB,Bh.t24l),new Th(8,255,Bh.t24HB,Bh.t24l),new Th(9,511,Bh.t24HB,Bh.t24l),new Th(11,2047,Bh.t24HB,Bh.t24l),new Th(13,8191,Bh.t24HB,Bh.t24l),new Th(0,0,Bh.t32HB,Bh.t32l),new Th(0,0,Bh.t33HB,Bh.t33l)],Bh.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],Bh.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],Bh.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],Bh.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],Bh.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],Bh.scfsi_band=[0,6,11,16,21];var Oh=hp.VbrMode,Ch=hp.Float,Ih=hp.Util,jh=hp.new_float,Lh=hp.new_int,Ph=hp.assert;function Nh(){var e=null,t=null,o=null;this.setModules=function(n,r,l){e=n,t=r,o=l},this.IPOW20=function(e){return h[e]};var n=2220446049250313e-31,r=Nh.IXMAX_VAL+2,l=Nh.Q_MAX,c=Nh.Q_MAX2;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var d=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=d,this.sfBandIndex=[new ah([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ah([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ah([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ah([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ah([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ah([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ah([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ah([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ah([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var m=jh(l+c+1),h=jh(l),f=jh(r),_=jh(r);function v(e,t){var n=o.ATHformula(t,e);return n-=100,n=Math.pow(10,n/10+e.ATHlower)}function y(e){this.s=e}this.adj43=_,this.iteration_init=function(t){var i,o=t.internal_flags,n=o.l3_side;if(0==o.iteration_init_init){for(o.iteration_init_init=1,n.main_data_begin=0,function(e){for(var t=e.internal_flags.ATH.l,o=e.internal_flags.ATH.psfb21,n=e.internal_flags.ATH.s,r=e.internal_flags.ATH.psfb12,l=e.internal_flags,c=e.out_samplerate,d=0;d<Ip.SBMAX_l;d++){var m=l.scalefac_band.l[d],h=l.scalefac_band.l[d+1];t[d]=Ch.MAX_VALUE;for(var i=m;i<h;i++){var f=v(e,i*c/1152);t[d]=Math.min(t[d],f)}}for(d=0;d<Ip.PSFB21;d++)for(m=l.scalefac_band.psfb21[d],h=l.scalefac_band.psfb21[d+1],o[d]=Ch.MAX_VALUE,i=m;i<h;i++)f=v(e,i*c/1152),o[d]=Math.min(o[d],f);for(d=0;d<Ip.SBMAX_s;d++){for(m=l.scalefac_band.s[d],h=l.scalefac_band.s[d+1],n[d]=Ch.MAX_VALUE,i=m;i<h;i++)f=v(e,i*c/384),n[d]=Math.min(n[d],f);n[d]*=l.scalefac_band.s[d+1]-l.scalefac_band.s[d]}for(d=0;d<Ip.PSFB12;d++){for(m=l.scalefac_band.psfb12[d],h=l.scalefac_band.psfb12[d+1],r[d]=Ch.MAX_VALUE,i=m;i<h;i++)f=v(e,i*c/384),r[d]=Math.min(r[d],f);r[d]*=l.scalefac_band.s[13]-l.scalefac_band.s[12]}if(e.noATH){for(d=0;d<Ip.SBMAX_l;d++)t[d]=1e-20;for(d=0;d<Ip.PSFB21;d++)o[d]=1e-20;for(d=0;d<Ip.SBMAX_s;d++)n[d]=1e-20;for(d=0;d<Ip.PSFB12;d++)r[d]=1e-20}l.ATH.floor=10*Math.log10(v(e,-1))}(t),f[0]=0,i=1;i<r;i++)f[i]=Math.pow(i,4/3);for(i=0;i<r-1;i++)_[i]=i+1-Math.pow(.5*(f[i]+f[i+1]),.75);for(_[i]=.5,i=0;i<l;i++)h[i]=Math.pow(2,-.1875*(i-210));for(i=0;i<=l+c;i++)m[i]=Math.pow(2,.25*(i-210-c));var d,y,x,w;for(e.huffman_init(o),(i=t.exp_nspsytune>>2&63)>=32&&(i-=64),d=Math.pow(10,i/4/10),(i=t.exp_nspsytune>>8&63)>=32&&(i-=64),y=Math.pow(10,i/4/10),(i=t.exp_nspsytune>>14&63)>=32&&(i-=64),x=Math.pow(10,i/4/10),(i=t.exp_nspsytune>>20&63)>=32&&(i-=64),w=x*Math.pow(10,i/4/10),i=0;i<Ip.SBMAX_l;i++){k=i<=6?d:i<=13?y:i<=20?x:w,o.nsPsy.longfact[i]=k}for(i=0;i<Ip.SBMAX_s;i++){var k;k=i<=5?d:i<=10?y:i<=11?x:w,o.nsPsy.shortfact[i]=k}}},this.on_pe=function(e,o,n,r,l,c){var d,m,h=e.internal_flags,f=0,_=Lh(2),v=new Sh(f),y=t.ResvMaxBits(e,r,v,c),x=(f=v.bits)+y;for(x>fh.MAX_BITS_PER_GRANULE&&(x=fh.MAX_BITS_PER_GRANULE),d=0,m=0;m<h.channels_out;++m)n[m]=Math.min(fh.MAX_BITS_PER_CHANNEL,f/h.channels_out),_[m]=0|n[m]*o[l][m]/700-n[m],_[m]>3*r/4&&(_[m]=3*r/4),_[m]<0&&(_[m]=0),_[m]+n[m]>fh.MAX_BITS_PER_CHANNEL&&(_[m]=Math.max(0,fh.MAX_BITS_PER_CHANNEL-n[m])),d+=_[m];if(d>y)for(m=0;m<h.channels_out;++m)_[m]=y*_[m]/d;for(m=0;m<h.channels_out;++m)n[m]+=_[m],y-=_[m];for(d=0,m=0;m<h.channels_out;++m)d+=n[m];if(d>fh.MAX_BITS_PER_GRANULE){for(m=0;m<h.channels_out;++m)n[m]*=fh.MAX_BITS_PER_GRANULE,n[m]/=d,n[m]}return x},this.reduce_side=function(e,t,o,n){Ph(e[0]+e[1]<=fh.MAX_BITS_PER_GRANULE);var r=.33*(.5-t)/.5;r<0&&(r=0),r>.5&&(r=.5);var l=0|.5*r*(e[0]+e[1]);l>fh.MAX_BITS_PER_CHANNEL-e[0]&&(l=fh.MAX_BITS_PER_CHANNEL-e[0]),l<0&&(l=0),e[1]>=125&&(e[1]-l>125?(e[0]<o&&(e[0]+=l),e[1]-=l):(e[0]+=e[1]-125,e[1]=125)),(l=e[0]+e[1])>n&&(e[0]=n*e[0]/l,e[1]=n*e[1]/l),Ph(e[0]<=fh.MAX_BITS_PER_CHANNEL),Ph(e[1]<=fh.MAX_BITS_PER_CHANNEL),Ph(e[0]+e[1]<=fh.MAX_BITS_PER_GRANULE)},this.athAdjust=function(a,e,t){var o=90.30873362,u=Ih.FAST_LOG10_X(e,10),n=a*a,r=0;return u-=t,n>1e-20&&(r=1+Ih.FAST_LOG10_X(n,10/o)),r<0&&(r=0),u*=r,u+=t+o-94.82444863,Math.pow(10,.1*u)},this.calc_xmin=function(e,t,o,r){var l,c=0,d=e.internal_flags,m=0,h=0,f=d.ATH,_=o.xr,v=e.VBR==Oh.vbr_mtrh?1:0,y=d.masking_lower;for(e.VBR!=Oh.vbr_mtrh&&e.VBR!=Oh.vbr_mt||(y=1),l=0;l<o.psy_lmax;l++){A=(R=e.VBR==Oh.vbr_rh||e.VBR==Oh.vbr_mtrh?athAdjust(f.adjust,f.l[l],f.floor):f.adjust*f.l[l])/(S=o.width[l]),E=n,C=S>>1,O=0;do{O+=I=_[m]*_[m],E+=I<A?I:A,O+=j=_[++m]*_[m],E+=j<A?j:A,m++}while(--C>0);if(O>R&&h++,l==Ip.SBPSY_l)E<(B=R*d.nsPsy.longfact[l])&&(E=B);if(0!=v&&(R=E),!e.ATHonly)if((T=t.en.l[l])>0)B=O*t.thm.l[l]*y/T,0!=v&&(B*=d.nsPsy.longfact[l]),R<B&&(R=B);r[c++]=0!=v?R:R*d.nsPsy.longfact[l]}var x=575;if(o.block_type!=Ip.SHORT_TYPE)for(var w=576;0!=w--&&Gh.EQ(_[w],0);)x=w;o.max_nonzero_coeff=x;for(var k=o.sfb_smin;l<o.psymax;k++,l+=3){var S,b,M;for(M=e.VBR==Oh.vbr_rh||e.VBR==Oh.vbr_mtrh?athAdjust(f.adjust,f.s[k],f.floor):f.adjust*f.s[k],S=o.width[l],b=0;b<3;b++){var R,A,E,T,B,O=0,C=S>>1;A=M/S,E=n;do{var I,j;O+=I=_[m]*_[m],E+=I<A?I:A,O+=j=_[++m]*_[m],E+=j<A?j:A,m++}while(--C>0);if(O>M&&h++,k==Ip.SBPSY_s)E<(B=M*d.nsPsy.shortfact[k])&&(E=B);if(R=0!=v?E:M,!e.ATHonly&&!e.ATHshort)if((T=t.en.s[k][b])>0)B=O*t.thm.s[k][b]*y/T,0!=v&&(B*=d.nsPsy.shortfact[k]),R<B&&(R=B);r[c++]=0!=v?R:R*d.nsPsy.shortfact[k]}e.useTemporal&&(r[c-3]>r[c-3+1]&&(r[c-3+1]+=(r[c-3]-r[c-3+1])*d.decay),r[c-3+1]>r[c-3+2]&&(r[c-3+2]+=(r[c-3+1]-r[c-3+2])*d.decay))}return h},this.calc_noise_core=function(e,t,o,n){var r=0,l=t.s,c=e.l3_enc;if(l>e.count1)for(;0!=o--;){m=e.xr[l],l++,r+=m*m,m=e.xr[l],l++,r+=m*m}else if(l>e.big_values){var d=jh(2);for(d[0]=0,d[1]=n;0!=o--;){m=Math.abs(e.xr[l])-d[c[l]],l++,r+=m*m,m=Math.abs(e.xr[l])-d[c[l]],l++,r+=m*m}}else for(;0!=o--;){var m;m=Math.abs(e.xr[l])-f[c[l]]*n,l++,r+=m*m,m=Math.abs(e.xr[l])-f[c[l]]*n,l++,r+=m*m}return t.s=l,r},this.calc_noise=function(e,t,o,n,r){var l,c,h=0,f=0,_=0,v=0,x=0,w=-20,k=0,S=e.scalefac,M=0;for(n.over_SSD=0,l=0;l<e.psymax;l++){var R,s=e.global_gain-(S[M++]+(0!=e.preflag?d[l]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[l]],A=0;if(null!=r&&r.step[l]==s)A=r.noise[l],k+=e.width[l],o[h++]=A/t[f++],A=r.noise_log[l];else{var E,T=m[s+Nh.Q_MAX2];if(c=e.width[l]>>1,k+e.width[l]>e.max_nonzero_coeff)c=(E=e.max_nonzero_coeff-k+1)>0?E>>1:0;var B=new y(k);A=this.calc_noise_core(e,B,c,T),k=B.s,null!=r&&(r.step[l]=s,r.noise[l]=A),A=o[h++]=A/t[f++],A=Ih.FAST_LOG10(Math.max(A,1e-20)),null!=r&&(r.noise_log[l]=A)}if(null!=r&&(r.global_gain=e.global_gain),x+=A,A>0)R=Math.max(0|10*A+.5,1),n.over_SSD+=R*R,_++,v+=A;w=Math.max(w,A)}return n.over_count=_,n.tot_noise=x,n.over_noise=v,n.max_noise=w,_},this.set_pinfo=function(e,t,o,n,r){var l,c,m,h,f,_=e.internal_flags,v=0==t.scalefac_scale?.5:1,y=t.scalefac,x=jh(L3Side.SFBMAX),w=jh(L3Side.SFBMAX),k=new CalcNoiseResult;calc_xmin(e,o,t,x),calc_noise(t,x,w,k,null);var S=0;for(c=t.sfb_lmax,t.block_type!=Ip.SHORT_TYPE&&0==t.mixed_block_flag&&(c=22),l=0;l<c;l++){var M=_.scalefac_band.l[l],R=(A=_.scalefac_band.l[l+1])-M;for(h=0;S<A;S++)h+=t.xr[S]*t.xr[S];h/=R,f=1e15,_.pinfo.en[n][r][l]=f*h,_.pinfo.xfsf[n][r][l]=f*x[l]*w[l]/R,o.en.l[l]>0&&!e.ATHonly?h/=o.en.l[l]:h=0,_.pinfo.thr[n][r][l]=f*Math.max(h*o.thm.l[l],_.ATH.l[l]),_.pinfo.LAMEsfb[n][r][l]=0,0!=t.preflag&&l>=11&&(_.pinfo.LAMEsfb[n][r][l]=-v*d[l]),l<Ip.SBPSY_l&&(Ph(y[l]>=0),_.pinfo.LAMEsfb[n][r][l]-=v*y[l])}if(t.block_type==Ip.SHORT_TYPE)for(c=l,l=t.sfb_smin;l<Ip.SBMAX_s;l++){M=_.scalefac_band.s[l],R=(A=_.scalefac_band.s[l+1])-M;for(var A,i=0;i<3;i++){for(h=0,m=M;m<A;m++)h+=t.xr[S]*t.xr[S],S++;h=Math.max(h/R,1e-20),f=1e15,_.pinfo.en_s[n][r][3*l+i]=f*h,_.pinfo.xfsf_s[n][r][3*l+i]=f*x[c]*w[c]/R,o.en.s[l][i]>0?h/=o.en.s[l][i]:h=0,(e.ATHonly||e.ATHshort)&&(h=0),_.pinfo.thr_s[n][r][3*l+i]=f*Math.max(h*o.thm.s[l][i],_.ATH.s[l]),_.pinfo.LAMEsfb_s[n][r][3*l+i]=-2*t.subblock_gain[i],l<Ip.SBPSY_s&&(_.pinfo.LAMEsfb_s[n][r][3*l+i]-=v*y[c]),c++}}_.pinfo.LAMEqss[n][r]=t.global_gain,_.pinfo.LAMEmainbits[n][r]=t.part2_3_length+t.part2_length,_.pinfo.LAMEsfbits[n][r]=t.part2_length,_.pinfo.over[n][r]=k.over_count,_.pinfo.max_noise[n][r]=10*k.max_noise,_.pinfo.over_noise[n][r]=10*k.over_noise,_.pinfo.tot_noise[n][r]=10*k.tot_noise,_.pinfo.over_SSD[n][r]=k.over_SSD}}Nh.Q_MAX=257,Nh.Q_MAX2=116,Nh.LARGE_BITS=1e5,Nh.IXMAX_VAL=8206;var Hh=hp.System,$h=hp.Arrays,Fh=hp.new_int,Dh=hp.assert;function Uh(){var e=null;function t(b){this.bits=0|b}this.qupvt=null,this.setModules=function(t){this.qupvt=t,e=t};var o=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function n(e,t,o,n,r,l){var c=.5946/t;for(e>>=1;0!=e--;)r[l++]=c>o[n++]?0:1,r[l++]=c>o[n++]?0:1}function r(t,o,n,r,l,c){var d=(t>>=1)%2;for(t>>=1;0!=t--;){var m,h,f,_,v,y,x,w;m=n[r++]*o,h=n[r++]*o,v=0|m,f=n[r++]*o,y=0|h,_=n[r++]*o,x=0|f,m+=e.adj43[v],w=0|_,h+=e.adj43[y],l[c++]=0|m,f+=e.adj43[x],l[c++]=0|h,_+=e.adj43[w],l[c++]=0|f,l[c++]=0|_}0!=d&&(v=0|(m=n[r++]*o),y=0|(h=n[r++]*o),m+=e.adj43[v],h+=e.adj43[y],l[c++]=0|m,l[c++]=0|h)}var l=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function c(e,t,o,s){var n=function(e,t,o){var n=0,r=0;do{var l=e[t++],c=e[t++];n<l&&(n=l),r<c&&(r=c)}while(t<o);return n<r&&(n=r),n}(e,t,o);switch(n){case 0:return n;case 1:return function(e,t,o,s){var n=0,r=Bh.ht[1].hlen;do{var l=2*e[t+0]+e[t+1];t+=2,n+=r[l]}while(t<o);return s.bits+=n,1}(e,t,o,s);case 2:case 3:return function(e,t,o,n,s){var r,l,c=0,d=Bh.ht[n].xlen;l=2==n?Bh.table23:Bh.table56;do{var m=e[t+0]*d+e[t+1];t+=2,c+=l[m]}while(t<o);return r=65535&c,(c>>=16)>r&&(c=r,n++),s.bits+=c,n}(e,t,o,l[n-1],s);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return function(e,t,o,n,s){var r=0,l=0,c=0,d=Bh.ht[n].xlen,m=Bh.ht[n].hlen,h=Bh.ht[n+1].hlen,f=Bh.ht[n+2].hlen;do{var _=e[t+0]*d+e[t+1];t+=2,r+=m[_],l+=h[_],c+=f[_]}while(t<o);var v=n;return r>l&&(r=l,v++),r>c&&(r=c,v=n+2),s.bits+=r,v}(e,t,o,l[n-1],s);default:if(n>Nh.IXMAX_VAL)return s.bits=Nh.LARGE_BITS,-1;var r,c;for(n-=15,r=24;r<32&&!(Bh.ht[r].linmax>=n);r++);for(c=r-8;c<24&&!(Bh.ht[c].linmax>=n);c++);return function(e,t,o,n,r,s){var l,c=65536*Bh.ht[n].xlen+Bh.ht[r].xlen,d=0;do{var m=e[t++],h=e[t++];0!=m&&(m>14&&(m=15,d+=c),m*=16),0!=h&&(h>14&&(h=15,d+=c),m+=h),d+=Bh.largetbl[m]}while(t<o);return l=65535&d,(d>>=16)>l&&(d=l,n=r),s.bits+=d,n}(e,t,o,c,r,s)}}function d(e,o,n,r,l,d,m,h){for(var f=o.big_values,_=2;_<Ip.SBMAX_l+1;_++){var v=e.scalefac_band.l[_];if(v>=f)break;var y=l[_-2]+o.count1bits;if(n.part2_3_length<=y)break;var x=new t(y),w=c(r,v,f,x);y=x.bits,n.part2_3_length<=y||(n.assign(o),n.part2_3_length=y,n.region0_count=d[_-2],n.region1_count=_-2-d[_-2],n.table_select[0]=m[_-2],n.table_select[1]=h[_-2],n.table_select[2]=w)}}this.noquant_count_bits=function(e,o,n){var r=o.l3_enc,i=Math.min(576,o.max_nonzero_coeff+2>>1<<1);for(null!=n&&(n.sfb_count1=0);i>1&&0==(r[i-1]|r[i-2]);i-=2);o.count1=i;for(var l=0,d=0;i>3;i-=4){var m;if((2147483647&(r[i-1]|r[i-2]|r[i-3]|r[i-4]))>1)break;m=2*(2*(2*r[i-4]+r[i-3])+r[i-2])+r[i-1],l+=Bh.t32l[m],d+=Bh.t33l[m]}var h=l;if(o.count1table_select=0,l>d&&(h=d,o.count1table_select=1),o.count1bits=h,o.big_values=i,0==i)return h;if(o.block_type==Ip.SHORT_TYPE)(l=3*e.scalefac_band.s[3])>o.big_values&&(l=o.big_values),d=o.big_values;else if(o.block_type==Ip.NORM_TYPE){if(l=o.region0_count=e.bv_scf[i-2],d=o.region1_count=e.bv_scf[i-1],d=e.scalefac_band.l[l+d+2],l=e.scalefac_band.l[l+1],d<i){var f=new t(h);o.table_select[2]=c(r,d,i,f),h=f.bits}}else o.region0_count=7,o.region1_count=Ip.SBMAX_l-1-7-1,(l=e.scalefac_band.l[8])>(d=i)&&(l=d);if(l=Math.min(l,i),d=Math.min(d,i),l>0){f=new t(h);o.table_select[0]=c(r,0,l,f),h=f.bits}if(l<d){f=new t(h);o.table_select[1]=c(r,l,d,f),h=f.bits}if(2==e.use_best_huffman&&(o.part2_3_length=h,best_huffman_divide(e,o),h=o.part2_3_length),null!=n&&o.block_type==Ip.NORM_TYPE){for(var _=0;e.scalefac_band.l[_]<o.big_values;)_++;n.sfb_count1=_}return h},this.count_bits=function(t,o,l,c){var d=l.l3_enc,m=Nh.IXMAX_VAL/e.IPOW20(l.global_gain);if(l.xrpow_max>m)return Nh.LARGE_BITS;if(function(t,o,l,c,d){var m,h,f,_=0,v=0,y=0,x=0,w=o,k=0,S=w,M=0,R=t,A=0;for(f=null!=d&&c.global_gain==d.global_gain,h=c.block_type==Ip.SHORT_TYPE?38:21,m=0;m<=h;m++){var E=-1;if((f||c.block_type==Ip.NORM_TYPE)&&(E=c.global_gain-(c.scalefac[m]+(0!=c.preflag?e.pretab[m]:0)<<c.scalefac_scale+1)-8*c.subblock_gain[c.window[m]]),Dh(c.width[m]>=0),f&&d.step[m]==E)0!=v&&(r(v,l,R,A,S,M),v=0),0!=y&&(n(y,l,R,A,S,M),y=0);else{var T,B=c.width[m];if(_+c.width[m]>c.max_nonzero_coeff&&(T=c.max_nonzero_coeff-_+1,$h.fill(o,c.max_nonzero_coeff,576,0),(B=T)<0&&(B=0),m=h+1),0==v&&0==y&&(S=w,M=k,R=t,A=x),null!=d&&d.sfb_count1>0&&m>=d.sfb_count1&&d.step[m]>0&&E>=d.step[m]?(0!=v&&(r(v,l,R,A,S,M),v=0,S=w,M=k,R=t,A=x),y+=B):(0!=y&&(n(y,l,R,A,S,M),y=0,S=w,M=k,R=t,A=x),v+=B),B<=0){0!=y&&(n(y,l,R,A,S,M),y=0),0!=v&&(r(v,l,R,A,S,M),v=0);break}}m<=h&&(k+=c.width[m],x+=c.width[m],_+=c.width[m])}0!=v&&(r(v,l,R,A,S,M),v=0),0!=y&&(n(y,l,R,A,S,M),y=0)}(o,d,e.IPOW20(l.global_gain),l,c),0!=(2&t.substep_shaping))for(var h=0,f=l.global_gain+l.scalefac_scale,_=.634521682242439/e.IPOW20(f),v=0;v<l.sfbmax;v++){var y,x=l.width[v];if(0==t.pseudohalf[v])h+=x;else for(y=h,h+=x;y<h;++y)d[y]=o[y]>=_?d[y]:0}return this.noquant_count_bits(t,l,c)},this.best_huffman_divide=function(e,o){var n=new Wp,r=o.l3_enc,l=Fh(23),m=Fh(23),h=Fh(23),f=Fh(23);if(o.block_type!=Ip.SHORT_TYPE||1!=e.mode_gr){n.assign(o),o.block_type==Ip.NORM_TYPE&&(!function(e,o,n,r,l,d,m){for(var h=o.big_values,f=0;f<=22;f++)r[f]=Nh.LARGE_BITS;for(f=0;f<16;f++){var _=e.scalefac_band.l[f+1];if(_>=h)break;var v=0,y=new t(v),x=c(n,0,_,y);v=y.bits;for(var w=0;w<8;w++){var k=e.scalefac_band.l[f+w+2];if(k>=h)break;var S=v,M=c(n,_,k,y=new t(S));S=y.bits,r[f+w]>S&&(r[f+w]=S,l[f+w]=f,d[f+w]=x,m[f+w]=M)}}}(e,o,r,l,m,h,f),d(e,n,o,r,l,m,h,f));var i=n.big_values;if(!(0==i||(r[i-2]|r[i-1])>1||(i=o.count1+2)>576)){n.assign(o),n.count1=i;for(var _=0,v=0;i>n.big_values;i-=4){var y=2*(2*(2*r[i-4]+r[i-3])+r[i-2])+r[i-1];_+=Bh.t32l[y],v+=Bh.t33l[y]}if(n.big_values=i,n.count1table_select=0,_>v&&(_=v,n.count1table_select=1),n.count1bits=_,n.block_type==Ip.NORM_TYPE)d(e,n,o,r,l,m,h,f);else{if(n.part2_3_length=_,(_=e.scalefac_band.l[8])>i&&(_=i),_>0){var x=new t(n.part2_3_length);n.table_select[0]=c(r,0,_,x),n.part2_3_length=x.bits}if(i>_){x=new t(n.part2_3_length);n.table_select[1]=c(r,_,i,x),n.part2_3_length=x.bits}o.part2_3_length>n.part2_3_length&&o.assign(n)}}}};var m=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],h=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],f=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],_=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];Uh.slen1_tab=f,Uh.slen2_tab=_,this.best_scalefac_store=function(t,o,n,r){var l,i,c,d,v=r.tt[o][n],y=0;for(c=0,l=0;l<v.sfbmax;l++){var x=v.width[l];for(c+=x,d=-x;d<0&&0==v.l3_enc[d+c];d++);0==d&&(v.scalefac[l]=y=-2)}if(0==v.scalefac_scale&&0==v.preflag){var s=0;for(l=0;l<v.sfbmax;l++)v.scalefac[l]>0&&(s|=v.scalefac[l]);if(0==(1&s)&&0!=s){for(l=0;l<v.sfbmax;l++)v.scalefac[l]>0&&(v.scalefac[l]>>=1);v.scalefac_scale=y=1}}if(0==v.preflag&&v.block_type!=Ip.SHORT_TYPE&&2==t.mode_gr){for(l=11;l<Ip.SBPSY_l&&!(v.scalefac[l]<e.pretab[l]&&-2!=v.scalefac[l]);l++);if(l==Ip.SBPSY_l){for(l=11;l<Ip.SBPSY_l;l++)v.scalefac[l]>0&&(v.scalefac[l]-=e.pretab[l]);v.preflag=y=1}}for(i=0;i<4;i++)r.scfsi[n][i]=0;for(2==t.mode_gr&&1==o&&r.tt[0][n].block_type!=Ip.SHORT_TYPE&&r.tt[1][n].block_type!=Ip.SHORT_TYPE&&(!function(e,t){for(var o,n=t.tt[1][e],r=t.tt[0][e],i=0;i<Bh.scfsi_band.length-1;i++){for(o=Bh.scfsi_band[i];o<Bh.scfsi_band[i+1]&&!(r.scalefac[o]!=n.scalefac[o]&&n.scalefac[o]>=0);o++);if(o==Bh.scfsi_band[i+1]){for(o=Bh.scfsi_band[i];o<Bh.scfsi_band[i+1];o++)n.scalefac[o]=-1;t.scfsi[e][i]=1}}var l=0,c=0;for(o=0;o<11;o++)-1!=n.scalefac[o]&&(c++,l<n.scalefac[o]&&(l=n.scalefac[o]));for(var d=0,v=0;o<Ip.SBPSY_l;o++)-1!=n.scalefac[o]&&(v++,d<n.scalefac[o]&&(d=n.scalefac[o]));for(i=0;i<16;i++)if(l<m[i]&&d<h[i]){var y=f[i]*c+_[i]*v;n.part2_length>y&&(n.part2_length=y,n.scalefac_compress=i)}}(n,r),y=0),l=0;l<v.sfbmax;l++)-2==v.scalefac[l]&&(v.scalefac[l]=0);0!=y&&(2==t.mode_gr?this.scale_bitcount(v):this.scale_bitcount_lsf(t,v))};var v=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],y=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],x=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var o,n,r,l=0,c=0,d=t.scalefac;if(Dh(function(e,t){for(var i=0;i<t;++i)if(e[i]<0)return!1;return!0}(d,t.sfbmax)),t.block_type==Ip.SHORT_TYPE)r=v,0!=t.mixed_block_flag&&(r=y);else if(r=x,0==t.preflag){for(n=11;n<Ip.SBPSY_l&&!(d[n]<e.pretab[n]);n++);if(n==Ip.SBPSY_l)for(t.preflag=1,n=11;n<Ip.SBPSY_l;n++)d[n]-=e.pretab[n]}for(n=0;n<t.sfbdivide;n++)l<d[n]&&(l=d[n]);for(;n<t.sfbmax;n++)c<d[n]&&(c=d[n]);for(t.part2_length=Nh.LARGE_BITS,o=0;o<16;o++)l<m[o]&&c<h[o]&&t.part2_length>r[o]&&(t.part2_length=r[o],t.scalefac_compress=o);return t.part2_length==Nh.LARGE_BITS};var w=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,o){var n,r,l,c,d,m,i,h,f=Fh(4),_=o.scalefac;for(n=0!=o.preflag?2:0,i=0;i<4;i++)f[i]=0;if(o.block_type==Ip.SHORT_TYPE){r=1;var v=e.nr_of_sfb_block[n][r];for(h=0,l=0;l<4;l++)for(c=v[l]/3,i=0;i<c;i++,h++)for(d=0;d<3;d++)_[3*h+d]>f[l]&&(f[l]=_[3*h+d])}else{r=0;v=e.nr_of_sfb_block[n][r];for(h=0,l=0;l<4;l++)for(c=v[l],i=0;i<c;i++,h++)_[h]>f[l]&&(f[l]=_[h])}for(m=!1,l=0;l<4;l++)f[l]>w[n][l]&&(m=!0);if(!m){var y,x,S,M;for(o.sfb_partition_table=e.nr_of_sfb_block[n][r],l=0;l<4;l++)o.slen[l]=k[f[l]];switch(y=o.slen[0],x=o.slen[1],S=o.slen[2],M=o.slen[3],n){case 0:o.scalefac_compress=(5*y+x<<4)+(S<<2)+M;break;case 1:o.scalefac_compress=400+(5*y+x<<2)+S;break;case 2:o.scalefac_compress=500+3*y+x;break;default:Hh.err.printf("intensity stereo not implemented yet\n")}}if(!m)for(Dh(null!=o.sfb_partition_table),o.part2_length=0,l=0;l<4;l++)o.part2_length+=o.slen[l]*o.sfb_partition_table[l];return m};var k=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var i=2;i<=576;i+=2){for(var t,n=0;e.scalefac_band.l[++n]<i;);for(t=o[n][0];e.scalefac_band.l[t+1]>i;)t--;for(t<0&&(t=o[n][0]),e.bv_scf[i-2]=t,t=o[n][1];e.scalefac_band.l[t+e.bv_scf[i-2]+2]>i;)t--;t<0&&(t=o[n][1]),e.bv_scf[i-1]=t}}}var qh=hp.System,Vh=hp.Arrays,zh=hp.new_byte,Xh=hp.new_float_n,Yh=hp.new_int,Kh=hp.assert;function Gh(){var e=this,t=null,o=null,n=null,r=null;this.setModules=function(e,l,c,d){t=e,o=l,n=c,r=d};var l=null,c=0,d=0,m=0;function h(e){qh.arraycopy(e.header[e.w_ptr].buf,0,l,d,e.sideinfo_len),d+=e.sideinfo_len,c+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&fh.MAX_HEADER_BUF-1}function f(e,t,o){for(;o>0;){var n;0==m&&(m=8,d++,Kh(e.header[e.w_ptr].write_timing>=c),e.header[e.w_ptr].write_timing==c&&h(e),l[d]=0),o-=n=Math.min(o,m),m-=n,l[d]|=t>>o<<m,c+=n}}function _(e,t,o){for(;o>0;){var n;0==m&&(m=8,d++,l[d]=0),o-=n=Math.min(o,m),m-=n,l[d]|=t>>o<<m,c+=n}}function v(e,t){var i,o=e.internal_flags;if(t>=8&&(f(o,76,8),t-=8),t>=8&&(f(o,65,8),t-=8),t>=8&&(f(o,77,8),t-=8),t>=8&&(f(o,69,8),t-=8),t>=32){var r=n.getLameShortVersion();if(t>=32)for(i=0;i<r.length&&t>=8;++i)t-=8,f(o,r.charAt(i),8)}for(;t>=1;t-=1)f(o,o.ancillary_flag,1),o.ancillary_flag^=e.disable_reservoir?0:1}function y(e,t,o){for(var n=e.header[e.h_ptr].ptr;o>0;){var r=Math.min(o,8-(7&n));o-=r,e.header[e.h_ptr].buf[n>>3]|=t>>o<<8-(7&n)-r,n+=r}e.header[e.h_ptr].ptr=n}function x(e,t){e<<=8;for(var i=0;i<8;i++)0!=(65536&((t<<=1)^(e<<=1)))&&(t^=32773);return t}function w(e,t){var i,h2=Bh.ht[t.count1table_select+32],o=0,n=t.big_values,r=t.big_values;for(Kh(t.count1table_select<2),i=(t.count1-t.big_values)/4;i>0;--i){var l=0,c=0;0!=t.l3_enc[n+0]&&(c+=8,t.xr[r+0]<0&&l++),0!=t.l3_enc[n+1]&&(c+=4,l*=2,t.xr[r+1]<0&&l++),0!=t.l3_enc[n+2]&&(c+=2,l*=2,t.xr[r+2]<0&&l++),0!=t.l3_enc[n+3]&&(c++,l*=2,t.xr[r+3]<0&&l++),n+=4,r+=4,f(e,l+h2.table[c],h2.hlen[c]),o+=h2.hlen[c]}return o}function k(e,t,o,n,r){var h2=Bh.ht[t],l=0;if(0==t)return l;for(var i=o;i<n;i+=2){var c=0,d=0,m=h2.xlen,h=h2.xlen,_=0,v=r.l3_enc[i],y=r.l3_enc[i+1];if(0!=v&&(r.xr[i]<0&&_++,c--),t>15){if(v>14){var x=v-15;Kh(x<=h2.linmax),_|=x<<1,d=m,v=15}if(y>14){var w=y-15;Kh(w<=h2.linmax),_<<=m,_|=w,d+=m,y=15}h=16}0!=y&&(_<<=1,r.xr[i+1]<0&&_++,c--),v=v*h+y,d-=c,c+=h2.hlen[v],f(e,h2.table[v],c),f(e,_,d),l+=c+d}return l}function S(e,t){var o=3*e.scalefac_band.s[3];o>t.big_values&&(o=t.big_values);var n=k(e,t.table_select[0],0,o,t);return n+=k(e,t.table_select[1],o,t.big_values,t)}function M(e,t){var o,n,r,l;o=t.big_values;var i=t.region0_count+1;return Kh(i<e.scalefac_band.l.length),r=e.scalefac_band.l[i],i+=t.region1_count+1,Kh(i<e.scalefac_band.l.length),r>o&&(r=o),(l=e.scalefac_band.l[i])>o&&(l=o),n=k(e,t.table_select[0],0,r,t),n+=k(e,t.table_select[1],r,l,t),n+=k(e,t.table_select[2],l,o,t)}function R(){this.total=0}function A(t,o){var n,r,l,m,h,f=t.internal_flags;return h=f.w_ptr,-1==(m=f.h_ptr-1)&&(m=fh.MAX_HEADER_BUF-1),n=f.header[m].write_timing-c,o.total=n,n>=0&&(r=1+m-h,m<h&&(r=1+m-h+fh.MAX_HEADER_BUF),n-=8*r*f.sideinfo_len),n+=l=e.getframebits(t),o.total+=l,o.total%8!=0?o.total=1+o.total/8:o.total=o.total/8,o.total+=d+1,n<0&&qh.err.println("strange error flushing buffer ... \n"),n}this.getframebits=function(e){var t,o=e.internal_flags;return t=0!=o.bitrate_index?Bh.bitrate_table[e.version][o.bitrate_index]:e.brate,8*(0|72e3*(e.version+1)*t/e.out_samplerate+o.padding)},this.CRC_writeheader=function(e,header){var t=65535;t=x(255&header[2],t),t=x(255&header[3],t);for(var i=6;i<e.sideinfo_len;i++)t=x(255&header[i],t);header[4]=byte(t>>8),header[5]=byte(255&t)},this.flush_bitstream=function(e){var o,n,r=e.internal_flags,l=r.h_ptr-1;if(-1==l&&(l=fh.MAX_HEADER_BUF-1),o=r.l3_side,!((n=A(e,new R))<0)){if(v(e,n),Kh(r.header[l].write_timing+this.getframebits(e)==c),r.ResvSize=0,o.main_data_begin=0,r.findReplayGain){var d=t.GetTitleGain(r.rgdata);Kh(NEQ(d,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),r.RadioGain=0|Math.floor(10*d+.5)}r.findPeakSample&&(r.noclipGainChange=0|Math.ceil(20*Math.log10(r.PeakSample/32767)*10),r.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?r.noclipScale=Math.floor(32767/r.PeakSample*100)/100:r.noclipScale=-1)}},this.add_dummy_byte=function(e,t,o){for(var i,n=e.internal_flags;o-- >0;)for(_(0,t,8),i=0;i<fh.MAX_HEADER_BUF;++i)n.header[i].write_timing+=8},this.format_bitstream=function(e){var t,o=e.internal_flags;t=o.l3_side;var n=this.getframebits(e);v(e,t.resvDrain_pre),function(e,t){var o,n,r,l=e.internal_flags;if(o=l.l3_side,l.header[l.h_ptr].ptr=0,Vh.fill(l.header[l.h_ptr].buf,0,l.sideinfo_len,0),e.out_samplerate<16e3?y(l,4094,12):y(l,4095,12),y(l,e.version,1),y(l,1,2),y(l,e.error_protection?0:1,1),y(l,l.bitrate_index,4),y(l,l.samplerate_index,2),y(l,l.padding,1),y(l,e.extension,1),y(l,e.mode.ordinal(),2),y(l,l.mode_ext,2),y(l,e.copyright,1),y(l,e.original,1),y(l,e.emphasis,2),e.error_protection&&y(l,0,16),1==e.version){for(Kh(o.main_data_begin>=0),y(l,o.main_data_begin,9),2==l.channels_out?y(l,o.private_bits,3):y(l,o.private_bits,5),r=0;r<l.channels_out;r++){var c;for(c=0;c<4;c++)y(l,o.scfsi[r][c],1)}for(n=0;n<2;n++)for(r=0;r<l.channels_out;r++)y(l,(d=o.tt[n][r]).part2_3_length+d.part2_length,12),y(l,d.big_values/2,9),y(l,d.global_gain,8),y(l,d.scalefac_compress,4),d.block_type!=Ip.NORM_TYPE?(y(l,1,1),y(l,d.block_type,2),y(l,d.mixed_block_flag,1),14==d.table_select[0]&&(d.table_select[0]=16),y(l,d.table_select[0],5),14==d.table_select[1]&&(d.table_select[1]=16),y(l,d.table_select[1],5),y(l,d.subblock_gain[0],3),y(l,d.subblock_gain[1],3),y(l,d.subblock_gain[2],3)):(y(l,0,1),14==d.table_select[0]&&(d.table_select[0]=16),y(l,d.table_select[0],5),14==d.table_select[1]&&(d.table_select[1]=16),y(l,d.table_select[1],5),14==d.table_select[2]&&(d.table_select[2]=16),y(l,d.table_select[2],5),Kh(d.region0_count>=0&&d.region0_count<16),Kh(d.region1_count>=0&&d.region1_count<8),y(l,d.region0_count,4),y(l,d.region1_count,3)),y(l,d.preflag,1),y(l,d.scalefac_scale,1),y(l,d.count1table_select,1)}else for(Kh(o.main_data_begin>=0),y(l,o.main_data_begin,8),y(l,o.private_bits,l.channels_out),n=0,r=0;r<l.channels_out;r++){var d;y(l,(d=o.tt[n][r]).part2_3_length+d.part2_length,12),y(l,d.big_values/2,9),y(l,d.global_gain,8),y(l,d.scalefac_compress,9),d.block_type!=Ip.NORM_TYPE?(y(l,1,1),y(l,d.block_type,2),y(l,d.mixed_block_flag,1),14==d.table_select[0]&&(d.table_select[0]=16),y(l,d.table_select[0],5),14==d.table_select[1]&&(d.table_select[1]=16),y(l,d.table_select[1],5),y(l,d.subblock_gain[0],3),y(l,d.subblock_gain[1],3),y(l,d.subblock_gain[2],3)):(y(l,0,1),14==d.table_select[0]&&(d.table_select[0]=16),y(l,d.table_select[0],5),14==d.table_select[1]&&(d.table_select[1]=16),y(l,d.table_select[1],5),14==d.table_select[2]&&(d.table_select[2]=16),y(l,d.table_select[2],5),Kh(d.region0_count>=0&&d.region0_count<16),Kh(d.region1_count>=0&&d.region1_count<8),y(l,d.region0_count,4),y(l,d.region1_count,3)),y(l,d.scalefac_scale,1),y(l,d.count1table_select,1)}e.error_protection&&CRC_writeheader(l,l.header[l.h_ptr].buf);var m=l.h_ptr;Kh(l.header[m].ptr==8*l.sideinfo_len),l.h_ptr=m+1&fh.MAX_HEADER_BUF-1,l.header[l.h_ptr].write_timing=l.header[m].write_timing+t,l.h_ptr==l.w_ptr&&qh.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}(e,n);var r=8*o.sideinfo_len;if(r+=function(e){var t,o,n,r,l=0,c=e.internal_flags,d=c.l3_side;if(1==e.version)for(t=0;t<2;t++)for(o=0;o<c.channels_out;o++){var m=d.tt[t][o],h=Uh.slen1_tab[m.scalefac_compress],_=Uh.slen2_tab[m.scalefac_compress];for(r=0,n=0;n<m.sfbdivide;n++)-1!=m.scalefac[n]&&(f(c,m.scalefac[n],h),r+=h);for(;n<m.sfbmax;n++)-1!=m.scalefac[n]&&(f(c,m.scalefac[n],_),r+=_);Kh(r==m.part2_length),m.block_type==Ip.SHORT_TYPE?r+=S(c,m):r+=M(c,m),r+=w(c,m),Kh(r==m.part2_3_length+m.part2_length),l+=r}else for(t=0,o=0;o<c.channels_out;o++){m=d.tt[t][o];var i,v,y=0;if(Kh(null!=m.sfb_partition_table),r=0,n=0,v=0,m.block_type==Ip.SHORT_TYPE){for(;v<4;v++){var x=m.sfb_partition_table[v]/3,k=m.slen[v];for(i=0;i<x;i++,n++)f(c,Math.max(m.scalefac[3*n+0],0),k),f(c,Math.max(m.scalefac[3*n+1],0),k),f(c,Math.max(m.scalefac[3*n+2],0),k),y+=3*k}r+=S(c,m)}else{for(;v<4;v++)for(x=m.sfb_partition_table[v],k=m.slen[v],i=0;i<x;i++,n++)f(c,Math.max(m.scalefac[n],0),k),y+=k;r+=M(c,m)}r+=w(c,m),Kh(r==m.part2_3_length),Kh(y==m.part2_length),l+=y+r}return l}(e),v(e,t.resvDrain_post),r+=t.resvDrain_post,t.main_data_begin+=(n-r)/8,A(e,new R)!=o.ResvSize&&qh.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=o.ResvSize&&(qh.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,o.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*o.sideinfo_len,r-t.resvDrain_post-8*o.sideinfo_len,r,r%8,n),qh.err.println("This is a fatal error.  It has several possible causes:"),qh.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),qh.err.println(" 9%%  Your system is overclocked"),qh.err.println(" 1%%  bug in LAME encoding library"),o.ResvSize=8*t.main_data_begin),c>1e9){var i;for(i=0;i<fh.MAX_HEADER_BUF;++i)o.header[i].write_timing-=c;c=0}return 0},this.copy_buffer=function(e,n,c,h,f){var _=d+1;if(_<=0)return 0;if(0!=h&&_>h)return-1;if(qh.arraycopy(l,0,n,c,_),d=-1,m=0,0!=f){var v=Yh(1);if(v[0]=e.nMusicCRC,r.updateMusicCRC(v,n,c,_),e.nMusicCRC=v[0],_>0&&(e.VBR_seek_table.nBytesWritten+=_),e.decode_on_the_fly)for(var i,y=Xh([2,1152]),x=_,w=-1;0!=w;)if(w=o.hip_decode1_unclipped(e.hip,n,c,x,y[0],y[1]),x=0,-1==w&&(w=0),w>0){if(e.findPeakSample){for(i=0;i<w;i++)y[0][i]>e.PeakSample?e.PeakSample=y[0][i]:-y[0][i]>e.PeakSample&&(e.PeakSample=-y[0][i]);if(e.channels_out>1)for(i=0;i<w;i++)y[1][i]>e.PeakSample?e.PeakSample=y[1][i]:-y[1][i]>e.PeakSample&&(e.PeakSample=-y[1][i])}if(e.findReplayGain&&t.AnalyzeSamples(e.rgdata,y[0],0,y[1],0,w,e.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}return _},this.init_bit_stream_w=function(e){l=zh(af.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,d=-1,m=0,c=0}}Gh.EQ=function(a,b){return Math.abs(a)>Math.abs(b)?Math.abs(a-b)<=1e-6*Math.abs(a):Math.abs(a-b)<=1e-6*Math.abs(b)},Gh.NEQ=function(a,b){return!Gh.EQ(a,b)};var Zh=hp.System,Wh=hp.VbrMode,Qh=hp.ShortBlock,Jh=hp.new_float,ef=hp.new_int_n,tf=hp.new_short_n,sf=hp.assert;function af(){var e=this;af.V9=410,af.V8=420,af.V7=430,af.V6=440,af.V5=450,af.V4=460,af.V3=470,af.V2=480,af.V1=490,af.V0=500,af.R3MIX=1e3,af.STANDARD=1001,af.EXTREME=1002,af.INSANE=1003,af.STANDARD_FAST=1004,af.EXTREME_FAST=1005,af.MEDIUM=1006,af.MEDIUM_FAST=1007;var t,o,n,r,l;af.LAME_MAXMP3BUFFER=147456;var c,d,m,h=new Xp;function f(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=Jh(Ip.SBMAX_l),this.bo_s_weight=Jh(Ip.SBMAX_s)}function _(){this.lowerlimit=0}function v(e,t){this.lowpass=t}this.enc=new Ip,this.setModules=function(e,f,_,v,y,x,w,k,S){t=e,o=f,n=_,r=v,l=y,c=x,d=k,m=S,this.enc.setModules(o,h,r,c)};var y=4294479419;function x(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function w(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:case 11025:return t.version=0,0;case 24e3:case 12e3:return t.version=0,1;case 16e3:case 8e3:return t.version=0,2;default:return t.version=0,-1}}function k(e,t,o){o<16e3&&(t=2);for(var n=Bh.bitrate_table[t][1],i=2;i<=14;i++)Bh.bitrate_table[t][i]>0&&Math.abs(Bh.bitrate_table[t][i]-e)<Math.abs(n-e)&&(n=Bh.bitrate_table[t][i]);return n}function S(e,t,o){o<16e3&&(t=2);for(var i=0;i<=14;i++)if(Bh.bitrate_table[t][i]>0&&Bh.bitrate_table[t][i]==e)return i;return-1}function M(t,o){var n=[new v(8,2e3),new v(16,3700),new v(24,3900),new v(32,5500),new v(40,7e3),new v(48,7500),new v(56,1e4),new v(64,11e3),new v(80,13500),new v(96,15100),new v(112,15600),new v(128,17e3),new v(160,17500),new v(192,18600),new v(224,19400),new v(256,19700),new v(320,20500)],r=e.nearestBitrateFullIndex(o);t.lowerlimit=n[r].lowpass}function R(e){var t=Ip.BLKSIZE+e.framesize-Ip.FFTOFFSET;return t=Math.max(t,512+e.framesize-32)}function A(t,o,n,r,l,c){var d=e.enc.lame_encode_mp3_frame(t,o,n,r,l,c);return t.frameNum++,d}function E(){this.n_in=0,this.n_out=0}function T(){this.num_used=0}function B(i,e){return 0!=e?B(e,i%e):i}function O(e,t,o){var n=Math.PI*t;(e/=o)<0&&(e=0),e>1&&(e=1);var r=e-.5,l=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(r)<1e-9?n/Math.PI:l*Math.sin(o*n*r)/(Math.PI*o*r)}function C(e,t,o,n,r,l,c,d,m){var i,h,f=e.internal_flags,_=0,v=e.out_samplerate/B(e.out_samplerate,e.in_samplerate);v>fh.BPC&&(v=fh.BPC);var y=Math.abs(f.resample_ratio-Math.floor(.5+f.resample_ratio))<1e-4?1:0,x=1/f.resample_ratio;x>1&&(x=1);var w=31;w%2==0&&--w;var k=(w+=y)+1;if(0==f.fill_buffer_resample_init){for(f.inbuf_old[0]=Jh(k),f.inbuf_old[1]=Jh(k),i=0;i<=2*v;++i)f.blackfilt[i]=Jh(k);for(f.itime[0]=0,f.itime[1]=0,_=0;_<=2*v;_++){var S=0,M=(_-v)/(2*v);for(i=0;i<=w;i++)S+=f.blackfilt[_][i]=O(i-M,x,w);for(i=0;i<=w;i++)f.blackfilt[_][i]/=S}f.fill_buffer_resample_init=1}var R=f.inbuf_old[m];for(h=0;h<n;h++){var A,E;if(A=h*f.resample_ratio,w+(_=0|Math.floor(A-f.itime[m]))-w/2>=c)break;M=A-f.itime[m]-(_+w%2*.5);E=0|Math.floor(2*M*v+v+.5);var T=0;for(i=0;i<=w;++i){var C=0|i+_-w/2;T+=(C<0?R[k+C]:r[l+C])*f.blackfilt[E][i]}t[o+h]=T}if(d.num_used=Math.min(c,w+_-w/2),f.itime[m]+=d.num_used-h*f.resample_ratio,d.num_used>=k)for(i=0;i<k;i++)R[i]=r[l+d.num_used+i-k];else{var I=k-d.num_used;for(i=0;i<I;++i)R[i]=R[i+d.num_used];for(_=0;i<k;++i,++_)R[i]=r[l+_];sf(_==d.num_used)}return h}function I(e,t,o,n,r,l){var c=e.internal_flags;if(c.resample_ratio<.9999||c.resample_ratio>1.0001)for(var d=0;d<c.channels_out;d++){var m=new T;l.n_out=C(e,t[d],c.mf_size,e.framesize,o[d],n,r,m,d),l.n_in=m.num_used}else{l.n_out=Math.min(e.framesize,r),l.n_in=l.n_out;for(var i=0;i<l.n_out;++i)t[0][c.mf_size+i]=o[0][n+i],2==c.channels_out&&(t[1][c.mf_size+i]=o[1][n+i])}}this.lame_init=function(){var e=new Yp;return function(e){var t;e.class_id=y,t=e.internal_flags=new fh,e.mode=Mp.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=Wh.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=Ip.ENCDELAY+Ip.POSTDELAY,e.encoder_padding=0,t.mf_size=Ip.ENCDELAY-Ip.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0}(e),e.lame_allocated_gfp=1,e},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],o=0,n=0,r=0,l=0;l=t[16],r=16,n=t[16],o=16;for(var b=0;b<16;b++)if(Math.max(e,t[b+1])!=e){l=t[b+1],r=b+1,n=t[b],o=b;break}return l-e>e-n?o:r},this.lame_init_params=function(e){var v,R,A,E=e.internal_flags;if(E.Class_ID=0,null==E.ATH&&(E.ATH=new _h),null==E.PSY&&(E.PSY=new f),null==E.rgdata&&(E.rgdata=new kh),E.channels_in=e.num_channels,1==E.channels_in&&(e.mode=Mp.MONO),E.channels_out=e.mode==Mp.MONO?1:2,E.mode_ext=Ip.MPG_MD_MS_LR,e.mode==Mp.MONO&&(e.force_ms=!1),e.VBR==Wh.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==Wh.vbr_off||e.VBR==Wh.vbr_mtrh||e.VBR==Wh.vbr_mt||(e.free_format=!1),e.VBR==Wh.vbr_off&&0==e.brate&&Gh.EQ(e.compression_ratio,0)&&(e.compression_ratio=11.025),e.VBR==Wh.vbr_off&&e.compression_ratio>0&&(0==e.out_samplerate&&(e.out_samplerate=map2MP3Frequency(int(.97*e.in_samplerate))),e.brate=0|16*e.out_samplerate*E.channels_out/(1e3*e.compression_ratio),E.samplerate_index=w(e.out_samplerate,e),e.free_format||(e.brate=k(e.brate,e.version,e.out_samplerate))),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){var T=16e3;switch(e.VBR){case Wh.vbr_off:M(B=new _,e.brate),T=B.lowerlimit;break;case Wh.vbr_abr:var B;M(B=new _,e.VBR_mean_bitrate_kbps),T=B.lowerlimit;break;case Wh.vbr_rh:var O=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(e.VBR_q>=0&&e.VBR_q<=9){var a=O[e.VBR_q],b=O[e.VBR_q+1],C=e.VBR_q_frac;T=linear_int(a,b,C)}else T=19500;break;default:O=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(e.VBR_q>=0&&e.VBR_q<=9){a=O[e.VBR_q],b=O[e.VBR_q+1],C=e.VBR_q_frac;T=linear_int(a,b,C)}else T=19500}e.mode!=Mp.MONO||e.VBR!=Wh.vbr_off&&e.VBR!=Wh.vbr_abr||(T*=1.5),e.lowpassfreq=0|T}if(0==e.out_samplerate&&(2*e.lowpassfreq>e.in_samplerate&&(e.lowpassfreq=e.in_samplerate/2),e.out_samplerate=(v=0|e.lowpassfreq,R=e.in_samplerate,A=44100,R>=48e3?A=48e3:R>=44100?A=44100:R>=32e3?A=32e3:R>=24e3?A=24e3:R>=22050?A=22050:R>=16e3?A=16e3:R>=12e3?A=12e3:R>=11025?A=11025:R>=8e3&&(A=8e3),-1==v?A:(v<=15960&&(A=44100),v<=15250&&(A=32e3),v<=11220&&(A=24e3),v<=9970&&(A=22050),v<=7230&&(A=16e3),v<=5420&&(A=12e3),v<=4510&&(A=11025),v<=3970&&(A=8e3),R<A?R>44100?48e3:R>32e3?44100:R>24e3?32e3:R>22050?24e3:R>16e3?22050:R>12e3?16e3:R>11025?12e3:R>8e3?11025:8e3:A))),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==Wh.vbr_off&&(e.compression_ratio=16*e.out_samplerate*E.channels_out/(1e3*e.brate)),e.VBR==Wh.vbr_abr&&(e.compression_ratio=16*e.out_samplerate*E.channels_out/(1e3*e.VBR_mean_bitrate_kbps)),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,E.findPeakSample=!1),E.findReplayGain=e.findReplayGain,E.decode_on_the_fly=e.decode_on_the_fly,E.decode_on_the_fly&&(E.findPeakSample=!0),E.findReplayGain&&t.InitGainAnalysis(E.rgdata,e.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return e.internal_flags=null,-6;switch(E.decode_on_the_fly&&!e.decode_only&&(null!=E.hip&&m.hip_decode_exit(E.hip),E.hip=m.hip_decode_init()),E.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*E.mode_gr,e.encoder_delay=Ip.ENCDELAY,E.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case Wh.vbr_mt:case Wh.vbr_rh:case Wh.vbr_mtrh:e.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][e.VBR_q];break;case Wh.vbr_abr:e.compression_ratio=16*e.out_samplerate*E.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*E.channels_out/(1e3*e.brate)}if(e.mode==Mp.NOT_SET&&(e.mode=Mp.JOINT_STEREO),e.highpassfreq>0?(E.highpass1=2*e.highpassfreq,e.highpasswidth>=0?E.highpass2=2*(e.highpassfreq+e.highpasswidth):E.highpass2=2*e.highpassfreq,E.highpass1/=e.out_samplerate,E.highpass2/=e.out_samplerate):(E.highpass1=0,E.highpass2=0),e.lowpassfreq>0?(E.lowpass2=2*e.lowpassfreq,e.lowpasswidth>=0?(E.lowpass1=2*(e.lowpassfreq-e.lowpasswidth),E.lowpass1<0&&(E.lowpass1=0)):E.lowpass1=2*e.lowpassfreq,E.lowpass1/=e.out_samplerate,E.lowpass2/=e.out_samplerate):(E.lowpass1=0,E.lowpass2=0),function(e){var t=e.internal_flags,o=32,n=-1;if(t.lowpass1>0){for(var r=999,l=0;l<=31;l++)(h=l/31)>=t.lowpass2&&(o=Math.min(o,l)),t.lowpass1<h&&h<t.lowpass2&&(r=Math.min(r,l));t.lowpass1=999==r?(o-.75)/31:(r-.75)/31,t.lowpass2=o/31}if(t.highpass2>0&&t.highpass2<.75/31*.9&&(t.highpass1=0,t.highpass2=0,Zh.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){var c=-1;for(l=0;l<=31;l++)(h=l/31)<=t.highpass1&&(n=Math.max(n,l)),t.highpass1<h&&h<t.highpass2&&(c=Math.max(c,l));t.highpass1=n/31,t.highpass2=-1==c?(n+.75)/31:(c+.75)/31}for(l=0;l<32;l++){var d,m,h=l/31;d=t.highpass2>t.highpass1?x((t.highpass2-h)/(t.highpass2-t.highpass1+1e-20)):1,m=t.lowpass2>t.lowpass1?x((h-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[l]=d*m}}(e),E.samplerate_index=w(e.out_samplerate,e),E.samplerate_index<0)return e.internal_flags=null,-1;if(e.VBR==Wh.vbr_off){if(e.free_format)E.bitrate_index=0;else if(e.brate=k(e.brate,e.version,e.out_samplerate),E.bitrate_index=S(e.brate,e.version,e.out_samplerate),E.bitrate_index<=0)return e.internal_flags=null,-1}else E.bitrate_index=1;e.analysis&&(e.bWriteVbrTag=!1),null!=E.pinfo&&(e.bWriteVbrTag=!1),o.init_bit_stream_w(E);for(var I,j=E.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),i=0;i<Ip.SBMAX_l+1;i++)E.scalefac_band.l[i]=r.sfBandIndex[j].l[i];for(i=0;i<Ip.PSFB21+1;i++){var L=(E.scalefac_band.l[22]-E.scalefac_band.l[21])/Ip.PSFB21,P=E.scalefac_band.l[21]+i*L;E.scalefac_band.psfb21[i]=P}E.scalefac_band.psfb21[Ip.PSFB21]=576;for(i=0;i<Ip.SBMAX_s+1;i++)E.scalefac_band.s[i]=r.sfBandIndex[j].s[i];for(i=0;i<Ip.PSFB12+1;i++){L=(E.scalefac_band.s[13]-E.scalefac_band.s[12])/Ip.PSFB12,P=E.scalefac_band.s[12]+i*L;E.scalefac_band.psfb12[i]=P}for(E.scalefac_band.psfb12[Ip.PSFB12]=192,1==e.version?E.sideinfo_len=1==E.channels_out?21:36:E.sideinfo_len=1==E.channels_out?13:21,e.error_protection&&(E.sideinfo_len+=2),function(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&d.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=ef([16,5]),t.bitrate_blockType_Hist=ef([16,6]),t.PeakSample=0,e.bWriteVbrTag&&c.InitVbrTag(e)}(e),E.Class_ID=y,I=0;I<19;I++)E.nsPsy.pefirbuf[I]=700*E.mode_gr*E.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),sf(e.VBR_q<=9),sf(e.VBR_q>=0),e.VBR){case Wh.vbr_mt:e.VBR=Wh.vbr_mtrh;case Wh.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),n.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),e.quality>5&&(e.quality=5),E.PSY.mask_adjust=e.maskingadjust,E.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?E.sfb21_extra=!1:E.sfb21_extra=e.out_samplerate>44e3,E.iteration_loop=new VBRNewIterationLoop(l);break;case Wh.vbr_rh:n.apply_preset(e,500-10*e.VBR_q,0),E.PSY.mask_adjust=e.maskingadjust,E.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?E.sfb21_extra=!1:E.sfb21_extra=e.out_samplerate>44e3,e.quality>6&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),E.iteration_loop=new VBROldIterationLoop(l);break;default:var N;E.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),(N=e.VBR)==Wh.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),n.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=N,E.PSY.mask_adjust=e.maskingadjust,E.PSY.mask_adjust_short=e.maskingadjust_short,N==Wh.vbr_off?E.iteration_loop=new Eh(l):E.iteration_loop=new ABRIterationLoop(l)}if(sf(e.scale>=0),e.VBR!=Wh.vbr_off){if(E.VBR_min_bitrate=1,E.VBR_max_bitrate=14,e.out_samplerate<16e3&&(E.VBR_max_bitrate=8),0!=e.VBR_min_bitrate_kbps&&(e.VBR_min_bitrate_kbps=k(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),E.VBR_min_bitrate=S(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),E.VBR_min_bitrate<0))return-1;if(0!=e.VBR_max_bitrate_kbps&&(e.VBR_max_bitrate_kbps=k(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),E.VBR_max_bitrate=S(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),E.VBR_max_bitrate<0))return-1;e.VBR_min_bitrate_kbps=Bh.bitrate_table[e.version][E.VBR_min_bitrate],e.VBR_max_bitrate_kbps=Bh.bitrate_table[e.version][E.VBR_max_bitrate],e.VBR_mean_bitrate_kbps=Math.min(Bh.bitrate_table[e.version][E.VBR_max_bitrate],e.VBR_mean_bitrate_kbps),e.VBR_mean_bitrate_kbps=Math.max(Bh.bitrate_table[e.version][E.VBR_min_bitrate],e.VBR_mean_bitrate_kbps)}return e.tune&&(E.PSY.mask_adjust+=e.tune_value_a,E.PSY.mask_adjust_short+=e.tune_value_a),function(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0}}(e),sf(e.scale>=0),e.athaa_type<0?E.ATH.useAdjust=3:E.ATH.useAdjust=e.athaa_type,E.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=Qh.short_block_allowed),e.short_blocks!=Qh.short_block_allowed||e.mode!=Mp.JOINT_STEREO&&e.mode!=Mp.STEREO||(e.short_blocks=Qh.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=Xp.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=Xp.NSATTACKTHRE_S),sf(e.scale>=0),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),E.slot_lag=E.frac_SpF=0,e.VBR==Wh.vbr_off&&(E.slot_lag=E.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),r.iteration_init(e),h.psymodel_init(e),sf(e.scale>=0),0},this.lame_encode_flush=function(e,t,n,r){var l,c,m,h,f=e.internal_flags,_=tf([2,1152]),v=0,y=f.mf_samples_to_encode-Ip.POSTDELAY,x=R(e);if(f.mf_samples_to_encode<1)return 0;for(l=0,e.in_samplerate!=e.out_samplerate&&(y+=16*e.out_samplerate/e.in_samplerate),(m=e.framesize-y%e.framesize)<576&&(m+=e.framesize),e.encoder_padding=m,h=(y+m)/e.framesize;h>0&&v>=0;){var w=x-f.mf_size,k=e.frameNum;w*=e.in_samplerate,(w/=e.out_samplerate)>1152&&(w=1152),w<1&&(w=1),c=r-l,0==r&&(c=0),n+=v=this.lame_encode_buffer(e,_[0],_[1],w,t,n,c),l+=v,h-=k!=e.frameNum?1:0}if(f.mf_samples_to_encode=0,v<0)return v;if(c=r-l,0==r&&(c=0),o.flush_bitstream(e),(v=o.copy_buffer(f,t,n,c,1))<0)return v;if(n+=v,c=r-(l+=v),0==r&&(c=0),e.write_id3tag_automatic){if(d.id3tag_write_v1(e),(v=o.copy_buffer(f,t,n,c,0))<0)return v;l+=v}return l},this.lame_encode_buffer=function(e,n,r,l,c,d,m){var h=e.internal_flags,f=[null,null];if(h.Class_ID!=y)return-3;if(0==l)return 0;!function(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=Jh(t),e.in_buffer_1=Jh(t),e.in_buffer_nsamples=t)}(h,l),f[0]=h.in_buffer_0,f[1]=h.in_buffer_1;for(var i=0;i<l;i++)f[0][i]=n[i],h.channels_in>1&&(f[1][i]=r[i]);return function(e,n,r,l,c,d,m){var h,i,f,_,v,x=e.internal_flags,w=0,k=[null,null],S=[null,null];if(x.Class_ID!=y)return-3;if(0==l)return 0;if((v=o.copy_buffer(x,c,d,m,0))<0)return v;if(d+=v,w+=v,S[0]=n,S[1]=r,Gh.NEQ(e.scale,0)&&Gh.NEQ(e.scale,1))for(i=0;i<l;++i)S[0][i]*=e.scale,2==x.channels_out&&(S[1][i]*=e.scale);if(Gh.NEQ(e.scale_left,0)&&Gh.NEQ(e.scale_left,1))for(i=0;i<l;++i)S[0][i]*=e.scale_left;if(Gh.NEQ(e.scale_right,0)&&Gh.NEQ(e.scale_right,1))for(i=0;i<l;++i)S[1][i]*=e.scale_right;if(2==e.num_channels&&1==x.channels_out)for(i=0;i<l;++i)S[0][i]=.5*(S[0][i]+S[1][i]),S[1][i]=0;_=R(e),k[0]=x.mfbuf[0],k[1]=x.mfbuf[1];var M=0;for(;l>0;){var T=[null,null],B=0,O=0;T[0]=S[0],T[1]=S[1];var C=new E;if(I(e,k,T,M,l,C),B=C.n_in,O=C.n_out,x.findReplayGain&&!x.decode_on_the_fly&&t.AnalyzeSamples(x.rgdata,k[0],x.mf_size,k[1],x.mf_size,O,x.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(l-=B,M+=B,x.channels_out,x.mf_size+=O,sf(x.mf_size<=fh.MFSIZE),x.mf_samples_to_encode<1&&(x.mf_samples_to_encode=Ip.ENCDELAY+Ip.POSTDELAY),x.mf_samples_to_encode+=O,x.mf_size>=_){var j=m-w;if(0==m&&(j=0),(h=A(e,k[0],k[1],c,d,j))<0)return h;for(d+=h,w+=h,x.mf_size-=e.framesize,x.mf_samples_to_encode-=e.framesize,f=0;f<x.channels_out;f++)for(i=0;i<x.mf_size;i++)k[f][i]=k[f][i+e.framesize]}}return w}(e,f[0],f[1],l,c,d,m)}}var of=hp.VbrMode;function nf(){function e(e,t,o,n,r,l,c,d,m,h,f,_,v,y,x){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=o,this.expY=n,this.st_lrm=r,this.st_s=l,this.masking_adj=c,this.masking_adj_short=d,this.ath_lower=m,this.ath_curve=h,this.ath_sensitivity=f,this.interch=_,this.safejoint=v,this.sfb21mod=y,this.msfix=x}function t(e,t,o,n,r,l,c,d,m,mask,h,f,_,v){this.quant_comp=t,this.quant_comp_s=o,this.safejoint=n,this.nsmsfix=r,this.st_lrm=l,this.st_s=c,this.nsbass=d,this.scale=m,this.masking_adj=mask,this.ath_lower=h,this.ath_curve=f,this.interch=_,this.sfscale=v}var o;this.setModules=function(e){o=e};var n=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],r=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function l(e,a,t){var o=e.VBR==of.vbr_rh?n:r,l=e.VBR_q_frac,c=o[a],q=o[a+1],d=c;c.st_lrm=c.st_lrm+l*(q.st_lrm-c.st_lrm),c.st_s=c.st_s+l*(q.st_s-c.st_s),c.masking_adj=c.masking_adj+l*(q.masking_adj-c.masking_adj),c.masking_adj_short=c.masking_adj_short+l*(q.masking_adj_short-c.masking_adj_short),c.ath_lower=c.ath_lower+l*(q.ath_lower-c.ath_lower),c.ath_curve=c.ath_curve+l*(q.ath_curve-c.ath_curve),c.ath_sensitivity=c.ath_sensitivity+l*(q.ath_sensitivity-c.ath_sensitivity),c.interch=c.interch+l*(q.interch-c.interch),c.msfix=c.msfix+l*(q.msfix-c.msfix),function(e,t){var o=0;t<0&&(o=-1,t=0);t>9&&(o=-1,t=9);e.VBR_q=t,e.VBR_q_frac=0}(e,d.vbr_q),0!=t?e.quant_comp=d.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=d.quant_comp),0!=t?e.quant_comp_short=d.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=d.quant_comp_s),0!=d.expY&&(e.experimentalY=0!=d.expY),0!=t?e.internal_flags.nsPsy.attackthre=d.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=d.st_lrm),0!=t?e.internal_flags.nsPsy.attackthre_s=d.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=d.st_s),0!=t?e.maskingadjust=d.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=d.masking_adj),0!=t?e.maskingadjust_short=d.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=d.masking_adj_short),0!=t?e.ATHlower=-d.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-d.ath_lower/10),0!=t?e.ATHcurve=d.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=d.ath_curve),0!=t?e.athaa_sensitivity=d.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=d.ath_sensitivity),d.interch>0&&(0!=t?e.interChRatio=d.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=d.interch)),d.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|d.safejoint),d.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|d.sfb21mod<<20),0!=t?e.msfix=d.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=d.msfix),0==t&&(e.VBR_q=a,e.VBR_q_frac=l)}var c=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function d(e,t,n){var r=t,l=o.nearestBitrateFullIndex(t);if(e.VBR=of.vbr_abr,e.VBR_mean_bitrate_kbps=r,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),c[l].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),c[l].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(c[l].nsbass)>0){var d=int(4*c[l].nsbass);d<0&&(d+=64),e.exp_nspsytune=e.exp_nspsytune|d<<2}return 0!=n?e.quant_comp=c[l].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=c[l].quant_comp),0!=n?e.quant_comp_short=c[l].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=c[l].quant_comp_s),0!=n?e.msfix=c[l].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=c[l].nsmsfix),0!=n?e.internal_flags.nsPsy.attackthre=c[l].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=c[l].st_lrm),0!=n?e.internal_flags.nsPsy.attackthre_s=c[l].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=c[l].st_s),0!=n?e.scale=c[l].scale:Math.abs(e.scale- -1)>0||(e.scale=c[l].scale),0!=n?e.maskingadjust=c[l].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=c[l].masking_adj),c[l].masking_adj>0?0!=n?e.maskingadjust_short=.9*c[l].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*c[l].masking_adj):0!=n?e.maskingadjust_short=1.1*c[l].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*c[l].masking_adj),0!=n?e.ATHlower=-c[l].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-c[l].ath_lower/10),0!=n?e.ATHcurve=c[l].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=c[l].ath_curve),0!=n?e.interChRatio=c[l].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=c[l].interch),t}this.apply_preset=function(e,t,o){switch(t){case af.R3MIX:t=af.V3,e.VBR=of.vbr_mtrh;break;case af.MEDIUM:t=af.V4,e.VBR=of.vbr_rh;break;case af.MEDIUM_FAST:t=af.V4,e.VBR=of.vbr_mtrh;break;case af.STANDARD:t=af.V2,e.VBR=of.vbr_rh;break;case af.STANDARD_FAST:t=af.V2,e.VBR=of.vbr_mtrh;break;case af.EXTREME:t=af.V0,e.VBR=of.vbr_rh;break;case af.EXTREME_FAST:t=af.V0,e.VBR=of.vbr_mtrh;break;case af.INSANE:return t=320,e.preset=t,d(e,t,o),e.VBR=of.vbr_off,t}switch(e.preset=t,t){case af.V9:return l(e,9,o),t;case af.V8:return l(e,8,o),t;case af.V7:return l(e,7,o),t;case af.V6:return l(e,6,o),t;case af.V5:return l(e,5,o),t;case af.V4:return l(e,4,o),t;case af.V3:return l(e,3,o),t;case af.V2:return l(e,2,o),t;case af.V1:return l(e,1,o),t;case af.V0:return l(e,0,o),t}return t>=8&&t<=320?d(e,t,o):(e.preset=0,t)}}function rf(){this.setModules=function(e,t){}}function lf(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var cf=hp.new_float,df=hp.new_int;function uf(){this.global_gain=0,this.sfb_count1=0,this.step=df(39),this.noise=cf(39),this.noise_log=cf(39)}var mf=hp.System,pf=hp.VbrMode,hf=hp.Util,ff=hp.Arrays,gf=hp.new_float,_f=hp.assert;function vf(){var e,t,o;this.rv=null,this.qupvt=null;var n,r=new rf;function l(e){this.ordinal=e}function c(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function d(e,t,o,n,r){var l;switch(e){default:case 9:t.over_count>0?(l=o.over_SSD<=t.over_SSD,o.over_SSD==t.over_SSD&&(l=o.bits<t.bits)):l=o.max_noise<0&&10*o.max_noise+o.bits<=10*t.max_noise+t.bits;break;case 0:l=o.over_count<t.over_count||o.over_count==t.over_count&&o.over_noise<t.over_noise||o.over_count==t.over_count&&BitStream.EQ(o.over_noise,t.over_noise)&&o.tot_noise<t.tot_noise;break;case 8:o.max_noise=function(e,t){for(var o,n=1e-37,r=0;r<t.psymax;r++)n+=(o=e[r],hf.FAST_LOG10(.368+.632*o*o*o));return Math.max(1e-20,n)}(r,n);case 1:l=o.max_noise<t.max_noise;break;case 2:l=o.tot_noise<t.tot_noise;break;case 3:l=o.tot_noise<t.tot_noise&&o.max_noise<t.max_noise;break;case 4:l=o.max_noise<=0&&t.max_noise>.2||o.max_noise<=0&&t.max_noise<0&&t.max_noise>o.max_noise-.2&&o.tot_noise<t.tot_noise||o.max_noise<=0&&t.max_noise>0&&t.max_noise>o.max_noise-.2&&o.tot_noise<t.tot_noise+t.over_noise||o.max_noise>0&&t.max_noise>-.05&&t.max_noise>o.max_noise-.1&&o.tot_noise+o.over_noise<t.tot_noise+t.over_noise||o.max_noise>0&&t.max_noise>-.1&&t.max_noise>o.max_noise-.15&&o.tot_noise+o.over_noise+o.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:l=o.over_noise<t.over_noise||BitStream.EQ(o.over_noise,t.over_noise)&&o.tot_noise<t.tot_noise;break;case 6:l=o.over_noise<t.over_noise||BitStream.EQ(o.over_noise,t.over_noise)&&(o.max_noise<t.max_noise||BitStream.EQ(o.max_noise,t.max_noise)&&o.tot_noise<=t.tot_noise);break;case 7:l=o.over_count<t.over_count||o.over_noise<t.over_noise}return 0==t.over_count&&(l=l&&o.bits<t.bits),l}function m(e,t,r,l,d){var m=e.internal_flags;!function(e,t,o,n,r){var l,c=e.internal_flags;l=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var d=0,m=0;m<t.sfbmax;m++)d<o[m]&&(d=o[m]);var h=c.noise_shaping_amp;switch(3==h&&(h=r?2:1),h){case 2:break;case 1:d>1?d=Math.pow(d,.5):d*=.95;break;default:d>1?d=1:d*=.95}var f=0;for(m=0;m<t.sfbmax;m++){var _,v=t.width[m];if(f+=v,!(o[m]<d)){if(0!=(2&c.substep_shaping)&&(c.pseudohalf[m]=0==c.pseudohalf[m]?1:0,0==c.pseudohalf[m]&&2==c.noise_shaping_amp))return;for(t.scalefac[m]++,_=-v;_<0;_++)n[f+_]*=l,n[f+_]>t.xrpow_max&&(t.xrpow_max=n[f+_]);if(2==c.noise_shaping_amp)return}}}(e,t,r,l,d);var h=c(t);return!h&&(!(h=2==m.mode_gr?n.scale_bitcount(t):n.scale_bitcount_lsf(m,t))||(m.noise_shaping>1&&(ff.fill(m.pseudohalf,0),0==t.scalefac_scale?(!function(e,t){for(var n=0,r=0;r<e.sfbmax;r++){var l=e.width[r],s=e.scalefac[r];if(0!=e.preflag&&(s+=o.pretab[r]),n+=l,0!=(1&s)){s++;for(var c=-l;c<0;c++)t[n+c]*=1.2968395546510096,t[n+c]>e.xrpow_max&&(e.xrpow_max=t[n+c])}e.scalefac[r]=s>>1}e.preflag=0,e.scalefac_scale=1}(t,l),h=!1):t.block_type==Ip.SHORT_TYPE&&m.subblock_gain>0&&(h=function(e,t,n){var r,l=t.scalefac;for(r=0;r<t.sfb_lmax;r++)if(l[r]>=16)return!0;for(var c=0;c<3;c++){var d=0,m=0;for(r=t.sfb_lmax+c;r<t.sfbdivide;r+=3)d<l[r]&&(d=l[r]);for(;r<t.sfbmax;r+=3)m<l[r]&&(m=l[r]);if(!(d<16&&m<8)){if(t.subblock_gain[c]>=7)return!0;t.subblock_gain[c]++;var h=e.scalefac_band.l[t.sfb_lmax];for(r=t.sfb_lmax+c;r<t.sfbmax;r+=3){var f=t.width[r],s=l[r];if((s-=4>>t.scalefac_scale)>=0)l[r]=s,h+=3*f;else{l[r]=0;var _=210+(s<<t.scalefac_scale+1);y=o.IPOW20(_),h+=f*(c+1);for(var v=-f;v<0;v++)n[h+v]*=y,n[h+v]>t.xrpow_max&&(t.xrpow_max=n[h+v]);h+=f*(3-c-1)}}var y=o.IPOW20(202);for(h+=t.width[r]*(c+1),v=-t.width[r];v<0;v++)n[h+v]*=y,n[h+v]>t.xrpow_max&&(t.xrpow_max=n[h+v])}}return!1}(m,t,l)||c(t))),h||(h=2==m.mode_gr?n.scale_bitcount(t):n.scale_bitcount_lsf(m,t)),!h))}this.setModules=function(l,c,d,m){e=l,t=c,this.rv=c,o=d,this.qupvt=d,n=m,r.setModules(o,n)},this.ms_convert=function(e,t){for(var i=0;i<576;++i){var o=e.tt[t][0].xr[i],n=e.tt[t][1].xr[i];e.tt[t][0].xr[i]=(o+n)*(.5*hf.SQRT2),e.tt[t][1].xr[i]=(o-n)*(.5*hf.SQRT2)}},this.init_xrpow=function(e,t,o){var n=0,r=0|t.max_nonzero_coeff;if(t.xrpow_max=0,ff.fill(o,r,576,0),n=function(e,t,o,n){n=0;for(var i=0;i<=o;++i){var r=Math.abs(e.xr[i]);n+=r,t[i]=Math.sqrt(r*Math.sqrt(r)),t[i]>e.xrpow_max&&(e.xrpow_max=t[i])}return n}(t,o,r,n),n>1e-20){var l=0;0!=(2&e.substep_shaping)&&(l=1);for(var i=0;i<t.psymax;i++)e.pseudohalf[i]=l;return!0}return ff.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=Ip.SBPSY_l,t.sfb_smin=Ip.SBPSY_s,t.psy_lmax=e.sfb21_extra?Ip.SBMAX_l:Ip.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var n=0;n<Ip.SBMAX_l;n++)t.width[n]=e.scalefac_band.l[n+1]-e.scalefac_band.l[n],t.window[n]=3;if(t.block_type==Ip.SHORT_TYPE){var r=gf(576);t.sfb_smin=0,t.sfb_lmax=0,0!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?Ip.SBMAX_s:Ip.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(Ip.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var l=e.scalefac_band.l[t.sfb_lmax];mf.arraycopy(t.xr,0,r,0,576);for(n=t.sfb_smin;n<Ip.SBMAX_s;n++)for(var c=e.scalefac_band.s[n],d=e.scalefac_band.s[n+1],m=0;m<3;m++)for(var h=c;h<d;h++)t.xr[l++]=r[3*h+m];var f=t.sfb_lmax;for(n=t.sfb_smin;n<Ip.SBMAX_s;n++)t.width[f]=t.width[f+1]=t.width[f+2]=e.scalefac_band.s[n+1]-e.scalefac_band.s[n],t.window[f]=0,t.window[f+1]=1,t.window[f+2]=2,f+=3}t.count1bits=0,t.sfb_partition_table=o.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,ff.fill(t.scalefac,0),function(e,t){var n=e.ATH,r=t.xr;if(t.block_type!=Ip.SHORT_TYPE)for(var l=!1,c=Ip.PSFB21-1;c>=0&&!l;c--){var d=e.scalefac_band.psfb21[c],m=e.scalefac_band.psfb21[c+1],h=o.athAdjust(n.adjust,n.psfb21[c],n.floor);e.nsPsy.longfact[21]>1e-12&&(h*=e.nsPsy.longfact[21]);for(var f=m-1;f>=d;f--){if(!(Math.abs(r[f])<h)){l=!0;break}r[f]=0}}else for(var _=0;_<3;_++)for(l=!1,c=Ip.PSFB12-1;c>=0&&!l;c--){m=(d=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*_+(e.scalefac_band.psfb12[c]-e.scalefac_band.psfb12[0]))+(e.scalefac_band.psfb12[c+1]-e.scalefac_band.psfb12[c]);var v=o.athAdjust(n.adjust,n.psfb12[c],n.floor);for(e.nsPsy.shortfact[12]>1e-12&&(v*=e.nsPsy.shortfact[12]),f=m-1;f>=d;f--){if(!(Math.abs(r[f])<v)){l=!0;break}r[f]=0}}}(e,t)},l.BINSEARCH_NONE=new l(0),l.BINSEARCH_UP=new l(1),l.BINSEARCH_DOWN=new l(2),this.trancate_smallspectrums=function(e,t,r,l){var c=gf(Kp.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=Ip.SHORT_TYPE)&&0==(128&e.substep_shaping)){o.calc_noise(t,r,c,new lf,null);for(var d=0;d<576;d++){var m=0;0!=t.l3_enc[d]&&(m=Math.abs(t.xr[d])),l[d]=m}d=0;var h=8;t.block_type==Ip.SHORT_TYPE&&(h=6);do{var f,_,v,y,x=t.width[h];if(d+=x,!(c[h]>=1||(ff.sort(l,d-x,x),BitStream.EQ(l[d-1],0)))){f=(1-c[h])*r[h],_=0,y=0;do{var w;for(v=1;y+v<x&&!BitStream.NEQ(l[y+d-x],l[y+d+v-x]);v++);if(f<(w=l[y+d-x]*l[y+d-x]*v)){0!=y&&(_=l[y+d-x-1]);break}f-=w,y+=v}while(y<x);if(!BitStream.EQ(_,0))do{Math.abs(t.xr[d-x])<=_&&(t.l3_enc[d-x]=0)}while(--x>0)}}while(++h<t.psymax);t.part2_3_length=n.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,r,c,h,f){var _=e.internal_flags,v=new Wp,y=gf(576),x=gf(Kp.SFBMAX),w=new lf,k=new uf,S=9999999,M=!1,R=!1,A=0;if(function(e,t,o,r,c){var d,m=e.CurrentStep[r],h=!1,f=e.OldValue[r],_=l.BINSEARCH_NONE;for(t.global_gain=f,o-=t.part2_length;;){var v;if(d=n.count_bits(e,c,t,null),1==m||d==o)break;d>o?(_==l.BINSEARCH_DOWN&&(h=!0),h&&(m/=2),_=l.BINSEARCH_UP,v=m):(_==l.BINSEARCH_UP&&(h=!0),h&&(m/=2),_=l.BINSEARCH_DOWN,v=-m),t.global_gain+=v,t.global_gain<0&&(t.global_gain=0,h=!0),t.global_gain>255&&(t.global_gain=255,h=!0)}for(_f(t.global_gain>=0),_f(t.global_gain<256);d>o&&t.global_gain<255;)t.global_gain++,d=n.count_bits(e,c,t,null);e.CurrentStep[r]=f-t.global_gain>=4?4:2,e.OldValue[r]=t.global_gain,t.part2_3_length=d}(_,t,f,h,c),0==_.noise_shaping)return 100;o.calc_noise(t,r,x,w,k),w.bits=t.part2_3_length,v.assign(t);var E=0;for(mf.arraycopy(c,0,y,0,576);!M;){do{var T,B=new lf,O=255;if(T=0!=(2&_.substep_shaping)?20:3,_.sfb21_extra){if(x[v.sfbmax]>1)break;if(v.block_type==Ip.SHORT_TYPE&&(x[v.sfbmax+1]>1||x[v.sfbmax+2]>1))break}if(!m(e,v,x,c,R))break;0!=v.scalefac_scale&&(O=254);var C=f-v.part2_length;if(C<=0)break;for(;(v.part2_3_length=n.count_bits(_,c,v,k))>C&&v.global_gain<=O;)v.global_gain++;if(v.global_gain>O)break;if(0==w.over_count){for(;(v.part2_3_length=n.count_bits(_,c,v,k))>S&&v.global_gain<=O;)v.global_gain++;if(v.global_gain>O)break}if(o.calc_noise(v,r,x,B,k),B.bits=v.part2_3_length,0!=(d(t.block_type!=Ip.SHORT_TYPE?e.quant_comp:e.quant_comp_short,w,B,v,x)?1:0))S=t.part2_3_length,w=B,t.assign(v),E=0,mf.arraycopy(c,0,y,0,576);else if(0==_.full_outer_loop){if(++E>T&&0==w.over_count)break;if(3==_.noise_shaping_amp&&R&&E>30)break;if(3==_.noise_shaping_amp&&R&&v.global_gain-A>15)break}}while(v.global_gain+v.scalefac_scale<255);3==_.noise_shaping_amp?R?M=!0:(v.assign(t),mf.arraycopy(y,0,c,0,576),E=0,A=v.global_gain,R=!0):M=!0}return _f(t.global_gain+t.scalefac_scale<=255),e.VBR==pf.vbr_rh||e.VBR==pf.vbr_mtrh?mf.arraycopy(y,0,c,0,576):0!=(1&_.substep_shaping)&&trancate_smallspectrums(_,t,r,c),w.over_count},this.iteration_finish_one=function(e,o,r){var l=e.l3_side,c=l.tt[o][r];n.best_scalefac_store(e,o,r,l),1==e.use_best_huffman&&n.best_huffman_divide(e,c),t.ResvAdjust(e,c)},this.VBR_encode_granule=function(e,t,o,n,r,l,c){var d,m=e.internal_flags,h=new Wp,f=gf(576),_=c,v=c+1,y=(c+l)/2,x=0,w=m.sfb21_extra;_f(_<=LameInternalFlags.MAX_BITS_PER_CHANNEL),ff.fill(h.l3_enc,0);do{m.sfb21_extra=!(y>_-42)&&w,outer_loop(e,t,o,n,r,y)<=0?(x=1,v=t.part2_3_length,h.assign(t),mf.arraycopy(n,0,f,0,576),d=(c=v-32)-l,y=(c+l)/2):(d=c-(l=y+32),y=(c+l)/2,0!=x&&(x=2,t.assign(h),mf.arraycopy(f,0,n,0,576)))}while(d>12);m.sfb21_extra=w,2==x&&mf.arraycopy(h.l3_enc,0,t.l3_enc,0,576),_f(t.part2_3_length<=_)},this.get_framebits=function(o,n){var r=o.internal_flags;r.bitrate_index=r.VBR_min_bitrate;var l=e.getframebits(o);r.bitrate_index=1,l=e.getframebits(o);for(var i=1;i<=r.VBR_max_bitrate;i++){r.bitrate_index=i;var c=new MeanBits(l);n[i]=t.ResvFrameBegin(o,c),l=c.bits}},this.VBR_old_prepare=function(e,n,r,l,c,d,m,h,f){var _,v=e.internal_flags,y=0,x=1,w=0;v.bitrate_index=v.VBR_max_bitrate;var k=t.ResvFrameBegin(e,new MeanBits(0))/v.mode_gr;get_framebits(e,d);for(var S=0;S<v.mode_gr;S++){var M=o.on_pe(e,n,h[S],k,S,0);v.mode_ext==Ip.MPG_MD_MS_LR&&(ms_convert(v.l3_side,S),o.reduce_side(h[S],r[S],k,M));for(var R=0;R<v.channels_out;++R){var A=v.l3_side.tt[S][R];A.block_type!=Ip.SHORT_TYPE?(y=1.28/(1+Math.exp(3.5-n[S][R]/300))-.05,_=v.PSY.mask_adjust-y):(y=2.56/(1+Math.exp(3.5-n[S][R]/300))-.14,_=v.PSY.mask_adjust_short-y),v.masking_lower=Math.pow(10,.1*_),init_outer_loop(v,A),f[S][R]=o.calc_xmin(e,l[S][R],A,c[S][R]),0!=f[S][R]&&(x=0),m[S][R]=126,w+=h[S][R]}}for(S=0;S<v.mode_gr;S++)for(R=0;R<v.channels_out;R++)w>d[v.VBR_max_bitrate]&&(h[S][R]*=d[v.VBR_max_bitrate],h[S][R]/=w),m[S][R]>h[S][R]&&(m[S][R]=h[S][R]);return x},this.bitpressure_strategy=function(e,t,o,n){for(var r=0;r<e.mode_gr;r++)for(var l=0;l<e.channels_out;l++){for(var c=e.l3_side.tt[r][l],d=t[r][l],m=0,h=0;h<c.psy_lmax;h++)d[m++]*=1+.029*h*h/Ip.SBMAX_l/Ip.SBMAX_l;if(c.block_type==Ip.SHORT_TYPE)for(h=c.sfb_smin;h<Ip.SBMAX_s;h++)d[m++]*=1+.029*h*h/Ip.SBMAX_s/Ip.SBMAX_s,d[m++]*=1+.029*h*h/Ip.SBMAX_s/Ip.SBMAX_s,d[m++]*=1+.029*h*h/Ip.SBMAX_s/Ip.SBMAX_s;n[r][l]=0|Math.max(o[r][l],.9*n[r][l])}},this.VBR_new_prepare=function(e,n,r,l,c,d){var m,h=e.internal_flags,f=1,_=0,v=0;if(e.free_format){h.bitrate_index=0;y=new MeanBits(_);m=t.ResvFrameBegin(e,y),_=y.bits,c[0]=m}else{h.bitrate_index=h.VBR_max_bitrate;var y=new MeanBits(_);t.ResvFrameBegin(e,y),_=y.bits,get_framebits(e,c),m=c[h.VBR_max_bitrate]}for(var x=0;x<h.mode_gr;x++){o.on_pe(e,n,d[x],_,x,0),h.mode_ext==Ip.MPG_MD_MS_LR&&ms_convert(h.l3_side,x);for(var w=0;w<h.channels_out;++w){var k=h.l3_side.tt[x][w];h.masking_lower=Math.pow(10,.1*h.PSY.mask_adjust),init_outer_loop(h,k),0!=o.calc_xmin(e,r[x][w],k,l[x][w])&&(f=0),v+=d[x][w]}}for(x=0;x<h.mode_gr;x++)for(w=0;w<h.channels_out;w++)v>m&&(d[x][w]*=m,d[x][w]/=v);return f},this.calc_target_bits=function(n,r,l,c,d,m){var h,f,_,v,y=n.internal_flags,x=y.l3_side,w=0;y.bitrate_index=y.VBR_max_bitrate;var k=new MeanBits(w);for(m[0]=t.ResvFrameBegin(n,k),w=k.bits,y.bitrate_index=1,w=e.getframebits(n)-8*y.sideinfo_len,d[0]=w/(y.mode_gr*y.channels_out),w=n.VBR_mean_bitrate_kbps*n.framesize*1e3,0!=(1&y.substep_shaping)&&(w*=1.09),w/=n.out_samplerate,w-=8*y.sideinfo_len,w/=y.mode_gr*y.channels_out,(h=.93+.07*(11-n.compression_ratio)/5.5)<.9&&(h=.9),h>1&&(h=1),f=0;f<y.mode_gr;f++){var S=0;for(_=0;_<y.channels_out;_++){if(c[f][_]=int(h*w),r[f][_]>700){var M=int((r[f][_]-700)/1.4),R=x.tt[f][_];c[f][_]=int(h*w),R.block_type==Ip.SHORT_TYPE&&M<w/2&&(M=w/2),M>3*w/2?M=3*w/2:M<0&&(M=0),c[f][_]+=M}c[f][_]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(c[f][_]=LameInternalFlags.MAX_BITS_PER_CHANNEL),S+=c[f][_]}if(S>LameInternalFlags.MAX_BITS_PER_GRANULE)for(_=0;_<y.channels_out;++_)c[f][_]*=LameInternalFlags.MAX_BITS_PER_GRANULE,c[f][_]/=S}if(y.mode_ext==Ip.MPG_MD_MS_LR)for(f=0;f<y.mode_gr;f++)o.reduce_side(c[f],l[f],w*y.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(v=0,f=0;f<y.mode_gr;f++)for(_=0;_<y.channels_out;_++)c[f][_]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(c[f][_]=LameInternalFlags.MAX_BITS_PER_CHANNEL),v+=c[f][_];if(v>m[0])for(f=0;f<y.mode_gr;f++)for(_=0;_<y.channels_out;_++)c[f][_]*=m[0],c[f][_]/=v}}var bf=hp.assert;function yf(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,o){var n,r=t.internal_flags,l=r.l3_side,c=e.getframebits(t);o.bits=(c-8*r.sideinfo_len)/r.mode_gr;var d=2048*r.mode_gr-8;t.brate>320?n=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(n=11520,t.strict_ISO&&(n=8*int(32e4/(t.out_samplerate/1152)/8+.5))),r.ResvMax=n-c,r.ResvMax>d&&(r.ResvMax=d),(r.ResvMax<0||t.disable_reservoir)&&(r.ResvMax=0);var m=o.bits*r.mode_gr+Math.min(r.ResvSize,r.ResvMax);return m>n&&(m=n),bf(r.ResvMax%8==0),bf(r.ResvMax>=0),l.resvDrain_pre=0,null!=r.pinfo&&(r.pinfo.mean_bits=o.bits/2,r.pinfo.resvsize=r.ResvSize),m},this.ResvMaxBits=function(e,t,o,n){var r,l=e.internal_flags,c=l.ResvSize,d=l.ResvMax;0!=n&&(c+=t),0!=(1&l.substep_shaping)&&(d*=.9),o.bits=t,10*c>9*d?(r=c-9*d/10,o.bits+=r,l.substep_shaping|=128):(r=0,l.substep_shaping&=127,e.disable_reservoir||0!=(1&l.substep_shaping)||(o.bits-=.1*t));var m=c<6*l.ResvMax/10?c:6*l.ResvMax/10;return(m-=r)<0&&(m=0),m},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var o,n=e.l3_side;e.ResvSize+=t*e.mode_gr;var r=0;n.resvDrain_post=0,n.resvDrain_pre=0,0!=(o=e.ResvSize%8)&&(r+=o),(o=e.ResvSize-r-e.ResvMax)>0&&(r+=o);var l=Math.min(8*n.main_data_begin,r)/8;n.resvDrain_pre+=8*l,r-=8*l,e.ResvSize-=8*l,n.main_data_begin-=l,n.resvDrain_post+=r,e.ResvSize-=r}}function xf(){this.getLameVersion=function(){return"3.98.4"},this.getLameShortVersion=function(){return"3.98.4"},this.getLameVeryShortVersion=function(){return"LAME3.98r"},this.getPsyVersion=function(){return"0.93"},this.getLameUrl=function(){return"http://www.mp3dev.org/"},this.getLameOsBitness=function(){return"32bits"}}var wf=hp.System,kf=hp.VbrMode,Sf=hp.ShortBlock,Mf=hp.Arrays,Rf=hp.new_byte,Af=hp.assert;function Ef(){var e,t,o;this.setModules=function(n,r,l){e=n,t=r,o=l};var n=Ef.NUMTOCENTRIES,r=Ef.MAXFRAMESIZE,l=n+4+4+4+4+4+9+1+1+8+1+1+3+1+1+2+4+2+2,c="Xing",d="Info",m=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function h(e,t){var o=255&e[t+0];return o<<=8,o|=255&e[t+1],o<<=8,o|=255&e[t+2],o<<=8,o|=255&e[t+3]}function f(e,t,o){e[t+0]=255&o>>24,e[t+1]=255&o>>16,e[t+2]=255&o>>8,e[t+3]=255&o}function _(e,t,o){e[t+0]=255&o>>8,e[t+1]=255&o}function v(e,t,o){return 255&(e<<t|o&~(-1<<t))}function y(t,o){var n=t.internal_flags;o[0]=v(o[0],8,255),o[1]=v(o[1],3,7),o[1]=v(o[1],1,t.out_samplerate<16e3?0:1),o[1]=v(o[1],1,t.version),o[1]=v(o[1],2,1),o[1]=v(o[1],1,t.error_protection?0:1),o[2]=v(o[2],4,n.bitrate_index),o[2]=v(o[2],2,n.samplerate_index),o[2]=v(o[2],1,0),o[2]=v(o[2],1,t.extension),o[3]=v(o[3],2,t.mode.ordinal()),o[3]=v(o[3],2,n.mode_ext),o[3]=v(o[3],1,t.copyright),o[3]=v(o[3],1,t.original),o[3]=v(o[3],2,t.emphasis),o[0]=255;var r,l,c=241&o[1];r=1==t.version?128:t.out_samplerate<16e3?32:64,t.VBR==kf.vbr_off&&(r=t.brate),l=t.free_format?0:255&16*e.BitrateIndex(r,t.version,t.out_samplerate),1==t.version?(o[1]=255&(10|c),c=13&o[2],o[2]=255&(l|c)):(o[1]=255&(2|c),c=13&o[2],o[2]=255&(l|c))}function x(e,t){return t=t>>8^m[255&(t^e)]}this.addVbrFrame=function(e){var t=e.internal_flags,o=Tables.bitrate_table[e.version][t.bitrate_index];Af(null!=t.VBR_seek_table.bag),function(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var i=1;i<e.size;i+=2)e.bag[i/2]=e.bag[i];e.want*=2,e.pos/=2}}(t.VBR_seek_table,o)},this.getVbrTag=function(e){var t=new VBRTagData,o=0;t.flags=0;var r=e[o+1]>>3&1,l=e[o+2]>>2&3,m=e[o+3]>>6&3,f=e[o+2]>>4&15;if(f=Tables.bitrate_table[r][f],e[o+1]>>4==14?t.samprate=Tables.samplerate_table[2][l]:t.samprate=Tables.samplerate_table[r][l],!function(e,t){return new String(e,t,c.length(),null).equals(c)||new String(e,t,d.length(),null).equals(d)}(e,o+=0!=r?3!=m?36:21:3!=m?21:13))return null;o+=4,t.hId=r;var _=t.flags=h(e,o);if(o+=4,0!=(1&_)&&(t.frames=h(e,o),o+=4),0!=(2&_)&&(t.bytes=h(e,o),o+=4),0!=(4&_)){if(null!=t.toc)for(var i=0;i<n;i++)t.toc[i]=e[o+i];o+=n}t.vbrScale=-1,0!=(8&_)&&(t.vbrScale=h(e,o),o+=4),t.headersize=72e3*(r+1)*f/t.samprate;var v=e[(o+=21)+0]<<4;v+=e[o+1]>>4;var y=(15&e[o+1])<<8;return(v<0||v>3e3)&&(v=-1),((y+=255&e[o+2])<0||y>3e3)&&(y=-1),t.encDelay=v,t.encPadding=y,t},this.InitVbrTag=function(e){var o,n=e.internal_flags;o=1==e.version?128:e.out_samplerate<16e3?32:64,e.VBR==kf.vbr_off&&(o=e.brate);var c=72e3*(e.version+1)*o/e.out_samplerate,d=n.sideinfo_len+l;if(n.VBR_seek_table.TotalFrameSize=c,c<d||c>r)e.bWriteVbrTag=!1;else{n.VBR_seek_table.nVbrNumFrames=0,n.VBR_seek_table.nBytesWritten=0,n.VBR_seek_table.sum=0,n.VBR_seek_table.seen=0,n.VBR_seek_table.want=1,n.VBR_seek_table.pos=0,null==n.VBR_seek_table.bag&&(n.VBR_seek_table.bag=new int[400],n.VBR_seek_table.size=400);var m=Rf(r);y(e,m);for(var h=n.VBR_seek_table.TotalFrameSize,i=0;i<h;++i)t.add_dummy_byte(e,255&m[i],1)}},this.updateMusicCRC=function(e,t,o,n){for(var i=0;i<n;++i)e[0]=x(t[o+i],e[0])},this.getLameTagFrame=function(e,r){var l=e.internal_flags;if(!e.bWriteVbrTag)return 0;if(l.Class_ID!=Lame.LAME_ID)return 0;if(l.VBR_seek_table.pos<=0)return 0;if(r.length<l.VBR_seek_table.TotalFrameSize)return l.VBR_seek_table.TotalFrameSize;Mf.fill(r,0,l.VBR_seek_table.TotalFrameSize,0),y(e,r);var m=Rf(n);if(e.free_format)for(var i=1;i<n;++i)m[i]=255&255*i/100;else!function(e,t){if(!(e.pos<=0))for(var i=1;i<n;++i){var o=i/n,r=0|Math.floor(o*e.pos);r>e.pos-1&&(r=e.pos-1);var l=0|256*e.bag[r]/e.sum;l>255&&(l=255),t[i]=255&l}}(l.VBR_seek_table,m);var h=l.sideinfo_len;e.error_protection&&(h-=2),e.VBR==kf.vbr_off?(r[h++]=255&d.charAt(0),r[h++]=255&d.charAt(1),r[h++]=255&d.charAt(2),r[h++]=255&d.charAt(3)):(r[h++]=255&c.charAt(0),r[h++]=255&c.charAt(1),r[h++]=255&c.charAt(2),r[h++]=255&c.charAt(3)),f(r,h,15),f(r,h+=4,l.VBR_seek_table.nVbrNumFrames),h+=4;var v=l.VBR_seek_table.nBytesWritten+l.VBR_seek_table.TotalFrameSize;f(r,h,0|v),h+=4,wf.arraycopy(m,0,r,h,m.length),h+=m.length,e.error_protection&&t.CRC_writeheader(l,r);var w=0;for(i=0;i<h;i++)w=x(r[i],w);return h+=function(e,t,n,r,l){var c,d,m,h,v,y=e.internal_flags,w=0,k=e.encoder_delay,S=e.encoder_padding,M=100-10*e.VBR_q-e.quality,R=o.getLameVeryShortVersion(),A=[1,5,3,2,4,0,3],E=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),T=0,B=0,O=e.internal_flags.noise_shaping,C=0,I=0,j=0,L=0!=(1&e.exp_nspsytune),P=0!=(2&e.exp_nspsytune),N=!1,H=!1,$=e.internal_flags.nogap_total,F=e.internal_flags.nogap_current,D=e.ATHtype;switch(e.VBR){case vbr_abr:v=e.VBR_mean_bitrate_kbps;break;case vbr_off:v=e.brate;break;default:v=e.VBR_min_bitrate_kbps}switch(c=0+(e.VBR.ordinal()<A.length?A[e.VBR.ordinal()]:0),y.findReplayGain&&(y.RadioGain>510&&(y.RadioGain=510),y.RadioGain<-510&&(y.RadioGain=-510),B=8192,B|=3072,y.RadioGain>=0?B|=y.RadioGain:(B|=512,B|=-y.RadioGain)),y.findPeakSample&&(T=Math.abs(0|y.PeakSample/32767*Math.pow(2,23)+.5)),-1!=$&&(F>0&&(H=!0),F<$-1&&(N=!0)),h=D+((L?1:0)<<4)+((P?1:0)<<5)+((N?1:0)<<6)+((H?1:0)<<7),M<0&&(M=0),e.mode){case MONO:C=0;break;case STEREO:C=1;break;case DUAL_CHANNEL:C=2;break;case JOINT_STEREO:C=e.force_ms?4:3;break;case NOT_SET:default:C=7}j=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:e.in_samplerate>48e3?3:1,(e.short_blocks==Sf.short_block_forced||e.short_blocks==Sf.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==D||e.in_samplerate<=32e3)&&(I=1),d=O+(C<<2)+(I<<5)+(j<<6),m=y.nMusicCRC,f(n,r+w,M),w+=4;for(var U=0;U<9;U++)n[r+w+U]=255&R.charAt(U);n[r+(w+=9)]=255&c,n[r+ ++w]=255&E,f(n,r+ ++w,T),_(n,r+(w+=4),B),_(n,r+(w+=2),0),n[r+(w+=2)]=255&h,n[r+ ++w]=v>=255?255:255&v,n[r+ ++w]=255&k>>4,n[r+w+1]=255&(k<<4)+(S>>8),n[r+w+2]=255&S,n[r+(w+=3)]=255&d,w++,n[r+w++]=0,_(n,r+w,e.preset),f(n,r+(w+=2),t),_(n,r+(w+=4),m),w+=2;for(var i=0;i<w;i++)l=x(n[r+i],l);return _(n,r+w,l),w+2}(e,v,r,h,w),l.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(e,t){if(e.internal_flags.VBR_seek_table.pos<=0)return-1;if(t.seek(t.length()),0==t.length())return-1;var o=function(e){e.seek(0);var t=Rf(10);return e.readFully(t),new String(t,"ISO-8859-1").startsWith("ID3")?0:((127&t[6])<<21|(127&t[7])<<14|(127&t[8])<<7|127&t[9])+t.length}(t);t.seek(o);var n=Rf(r),l=getLameTagFrame(e,n);return l>n.length?-1:(l<1||t.write(n,0,l),0)}}Ef.NUMTOCENTRIES=100,Ef.MAXFRAMESIZE=2880;var Tf=hp.new_byte,Bf=hp.assert;function Of(){this.setModules=function(e,t){}}function Cf(){this.setModules=function(e,t,o){}}function If(){}function jf(){this.setModules=function(e,t){}}function Lf(e,t,o){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,o=128);var n=new af,r=new Of,l=new yh,c=new Gh,d=new nf,m=new Nh,h=new vf,f=new Ef,_=new xf,v=new jf,y=new yf,x=new Uh,w=new Cf,k=new If;n.setModules(l,c,d,m,h,f,_,v,k),c.setModules(l,k,_,f),v.setModules(c,_),d.setModules(n),h.setModules(c,y,m,x),m.setModules(x,y,n.enc.psy),y.setModules(c),x.setModules(m),f.setModules(n,c,_),r.setModules(w,k),w.setModules(_,v,d);var S=n.lame_init();S.num_channels=e,S.in_samplerate=t,S.brate=o,S.mode=Mp.STEREO,S.quality=3,S.bWriteVbrTag=!1,S.disable_reservoir=!0,S.write_id3tag_automatic=!1,n.lame_init_params(S);var M=1152,R=0|1.25*M+7200,A=Tf(R);this.encodeBuffer=function(t,o){1==e&&(o=t),Bf(t.length==o.length),t.length>M&&(M=t.length,A=Tf(R=0|1.25*M+7200));var r=n.lame_encode_buffer(S,t,o,t.length,A,0,R);return new Int8Array(A.subarray(0,r))},this.flush=function(){var e=n.lame_encode_flush(S,A,0,R);return new Int8Array(A.subarray(0,e))}}function Pf(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}Pf("RIFF"),Pf("WAVE"),Pf("fmt "),Pf("data");class Nf{constructor(e){this.bitRate=e.bitRate,this.sampleRate=e.sampleRate,this.dataBuffer=[],this.encoder=new Lf(1,this.sampleRate,this.bitRate)}encode(e){const t=1152,o=this._convertBuffer(e);let n=o.length;for(let i=0;n>=0;i+=t){const e=o.subarray(i,i+t),r=this.encoder.encodeBuffer(e);this.dataBuffer.push(new Int8Array(r)),n-=t}}finish(){this.dataBuffer.push(this.encoder.flush());const e=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:e,url:URL.createObjectURL(e)}}_floatTo16BitPCM(input,output){for(let i=0;i<input.length;i++){const s=Math.max(-1,Math.min(1,input[i]));output[i]=s<0?32768*s:32767*s}}_convertBuffer(e){const data=new Float32Array(e),t=new Int16Array(e.length);return this._floatTo16BitPCM(data,t),t}}class Hf{constructor(e={}){this.beforeRecording=e.beforeRecording,this.pauseRecording=e.pauseRecording,this.afterRecording=e.afterRecording,this.micFailed=e.micFailed,this.encoderOptions={bitRate:e.bitRate,sampleRate:e.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia({video:!1,audio:{channelCount:1,echoCancellation:!1}}).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new Nf(this.encoderOptions))}stop(){this.stream.getTracks().forEach((e=>e.stop())),this.input.disconnect(),this.processor.disconnect(),this.context.close();let e=null;e=this.lameEncoder.finish(),e.duration=this.duration,this.records.push(e),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(e)}pause(){this.stream.getTracks().forEach((e=>e.stop())),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(e){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let o=0;this.lameEncoder&&this.lameEncoder.encode(t);for(let i=0;i<t.length;++i)o+=t[i]*t[i];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(o/t.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(e){this.micFailed&&this.micFailed(e)}}function $f(){var e=function(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}const Ff={name:"RoomFooter",components:{SvgIcon:ar,EmojiPickerContainer:_m,RoomFiles:Sm,RoomMessageReply:qm,RoomUsersTag:Km,RoomEmojis:Wm,RoomTemplatesText:ap},directives:{clickOutside:cc},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new qd,emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some((e=>e.loading))},recordedTime(){return new Date(1e3*this.recorder.duration).toISOString().substr(14,5)},shadowFooter(){return!!(this.filteredEmojis.length||this.filteredUsersTag.length||this.filteredTemplatesText.length||this.files.length||this.messageReply)}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout((()=>this.onChangeInput())))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){this.replyMessage(e)},initEditMessage(e){this.editMessage(e)}},mounted(){const e=$f();let t=!0;this.getTextareaRef().addEventListener("keyup",(o=>{"Enter"!==o.key||o.shiftKey||this.fileDialog||(e?(this.message=this.message+"\n",setTimeout((()=>this.onChangeInput()))):!t||this.filteredEmojis.length||this.filteredUsersTag.length||this.filteredTemplatesText.length||this.sendMessage()),t=!o.isComposing,setTimeout((()=>{this.updateFooterLists()}),60)})),this.getTextareaRef().addEventListener("click",(()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()})),this.getTextareaRef().addEventListener("blur",(()=>{setTimeout((()=>{this.resetFooterList()}),100),e&&setTimeout((()=>this.keepKeyboardOpen=!1))}))},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){$f()&&e||this.getTextareaRef()&&(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout((()=>{this.getTextareaRef().setSelectionRange(this.cursorRangePosition,this.cursorRangePosition),this.cursorRangePosition=null})))},onChangeInput(){var e,t,o;((null==(e=this.getTextareaRef())?void 0:e.value)||""===(null==(t=this.getTextareaRef())?void 0:t.value))&&(this.message=null==(o=this.getTextareaRef())?void 0:o.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-2*t+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var t;const o=null==(t=e.clipboardData)?void 0:t.items;o&&Array.from(o).forEach((e=>{if(e.type.includes("image")){const t=e.getAsFile();this.onFileChange([t])}}))},updateActiveUpOrDown(e){this.filteredEmojis.length?this.activeUpOrDownEmojis=e:this.filteredUsersTag.length?this.activeUpOrDownUsersTag=e:this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=e)},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:o}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(o,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(template){if(this.selectTemplatesTextItem=!1,!template)return;const{position:e,endPosition:t}=this.getCharPosition("/"),o=this.message.substr(t,t).length?"":" ";this.message=this.message.substr(0,e-1)+template.text+o+this.message.substr(t,this.message.length-1),this.cursorRangePosition=e+template.text.length+o.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach((async e=>{const t=URL.createObjectURL(e),o=e.name.lastIndexOf(".");this.files.push({loading:!0,name:e.name.substring(0,o),size:e.size,type:e.type,extension:e.name.substring(o+1),localUrl:t});const n=await fetch(t).then((e=>e.blob()));let r=this.files.find((e=>e.localUrl===t));r&&(r.blob=n,r.loading=!1,delete r.loading)})),setTimeout((()=>this.fileDialog=!1),500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,this.recorder.isRecording)try{this.recorder.stop();const e=this.recorder.records[0];this.files.push({blob:e.blob,name:`audio.${this.format}`,size:e.blob.size,duration:e.duration,type:e.blob.type,audio:!0,localUrl:URL.createObjectURL(e.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout((()=>this.stopRecorder()),100)}else setTimeout((()=>this.recorder.start()),200)},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout((()=>this.stopRecorder()),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var e;let t=this.message.trim();if(!this.files.length&&!t)return;if(this.isFileLoading)return;this.selectedUsersTag.forEach((e=>{t=t.replace(`@${e.username}`,`<usertag>${e._id}</usertag>`)}));const o=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==t||(null==(e=this.editedMessage.files)?void 0:e.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:t,files:o,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:t,files:o,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const o=t,n="<usertag>",r="</usertag>";[...t.matchAll(new RegExp(n,"gi"))].map((a=>a.index)).forEach((e=>{const l=o.substring(e+n.length,o.indexOf(r,e)),c=this.room.users.find((e=>e._id===l));t=t.replace(`<usertag>${l}</usertag>`,`@${(null==c?void 0:c.username)||"unknown"}`),this.selectUserTag(c,!0)})),this.message=t,e.files&&(this.files=[...e.files]),setTimeout((()=>this.resizeTextarea()))},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef())return;if(":"===e&&!this.emojisSuggestionEnabled)return;if(!("@"!==e||this.userTagsEnabled&&this.room.users))return;if("/"===e&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let o=t;for(;o>0&&this.message.charAt(o-1)!==e&&(" "!==this.message.charAt(o-1)||":"!==e);)o--;const n=this.message.charAt(o-2),r=!n.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(o-1)!==e||n&&" "!==n&&!r)this.resetFooterList(e);else{const n=this.message.substring(o,t);":"===e?this.updateEmojis(n):"@"===e?this.updateShowUsersTag(n):"/"===e&&this.updateShowTemplatesText(n)}},updateShowUsersTag(e){this.filteredUsersTag=Tc(this.room.users,"username",e,!0).filter((e=>e._id!==this.currentUserId))},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:o,endPosition:n}=this.getCharPosition("@"),r=this.message.substr(n,n).length?"":" ";this.message=this.message.substr(0,o)+e.username+r+this.message.substr(n,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=o+e.username.length+r.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=Tc(this.templatesText,"tag",e,!0)},getCharPosition(e){let t=this.getTextareaRef().selectionStart;for(;t>0&&this.message.charAt(t-1)!==e;)t--;return{position:t,endPosition:this.getTextareaRef().selectionEnd}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map((e=>e.unicode))},resetFooterList(e=null){":"===e?this.filteredEmojis=[]:"@"===e?this.filteredUsersTag=[]:("/"===e||(this.filteredEmojis=[],this.filteredUsersTag=[]),this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),!this.textareaAutoFocus&&t||setTimeout((()=>this.focusTextarea(e)))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new Hf({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},Df={key:0,class:"vac-icon-textarea-left"},Uf=ro("div",{class:"vac-dot-audio-record"},null,-1),qf={class:"vac-dot-audio-record-time"},Vf=["placeholder"],zf={class:"vac-icon-textarea"},Xf={key:1},Yf=["accept"];var Kf=Vn(Ff,[["render",function(e,t,o,n,r,l){const c=Js("room-emojis"),d=Js("room-users-tag"),m=Js("room-templates-text"),h=Js("room-message-reply"),f=Js("room-files"),_=Js("svg-icon"),v=Js("emoji-picker-container"),y=ta("click-outside");return Zs((Ga(),Ja("div",{id:"room-footer",class:Ge(["vac-room-footer",{"vac-app-box-shadow":l.shadowFooter}])},[io(c,{"filtered-emojis":r.filteredEmojis,"select-item":r.selectEmojiItem,"active-up-or-down":r.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=e=>l.selectEmoji(e)),onActivateItem:t[1]||(t[1]=e=>r.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),io(d,{"filtered-users-tag":r.filteredUsersTag,"select-item":r.selectUsersTagItem,"active-up-or-down":r.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=e=>l.selectUserTag(e)),onActivateItem:t[3]||(t[3]=e=>r.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),io(m,{"filtered-templates-text":r.filteredTemplatesText,"select-item":r.selectTemplatesTextItem,"active-up-or-down":r.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=e=>l.selectTemplateText(e)),onActivateItem:t[5]||(t[5]=e=>r.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),io(h,{room:o.room,"message-reply":r.messageReply,"text-formatting":o.textFormatting,"link-options":o.linkOptions,onResetMessage:l.resetMessage},na({_:2},[oa(e.$slots,((i,t)=>({name:t,fn:us((data=>[ra(e.$slots,t,Ze(lo(data)))]))})))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),io(f,{files:r.files,onRemoveFile:l.removeFile,onResetMessage:l.resetMessage},na({_:2},[oa(e.$slots,((i,t)=>({name:t,fn:us((data=>[ra(e.$slots,t,Ze(lo(data)))]))})))]),1032,["files","onRemoveFile","onResetMessage"]),ro("div",{class:Ge(["vac-box-footer",{"vac-box-footer-border":!r.files.length}])},[o.showAudio&&!r.files.length?(Ga(),Ja("div",Df,[r.isRecording?(Ga(),Ja(qa,{key:0},[ro("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...e)=>l.stopRecorder&&l.stopRecorder(...e))},[ra(e.$slots,"audio-stop-icon",{},(()=>[io(_,{name:"close-outline"})]))]),Uf,ro("div",qf,We(l.recordedTime),1),ro("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=e=>l.toggleRecorder(!1))},[ra(e.$slots,"audio-check-icon",{},(()=>[io(_,{name:"checkmark"})]))])],64)):(Ga(),Ja("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=e=>l.toggleRecorder(!0))},[ra(e.$slots,"microphone-icon",{},(()=>[io(_,{name:"microphone",class:"vac-icon-microphone"})]))]))])):mo("",!0),ro("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:o.textMessages.TYPE_MESSAGE,class:Ge(["vac-textarea",{"vac-textarea-outline":r.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...e)=>l.onChangeInput&&l.onChangeInput(...e)),onKeydown:[t[10]||(t[10]=Hn(((...e)=>l.escapeTextarea&&l.escapeTextarea(...e)),["esc"])),t[11]||(t[11]=Hn(Pn(((...e)=>l.selectItem&&l.selectItem(...e)),["exact","prevent"]),["enter"])),t[13]||(t[13]=Hn(Pn((()=>{}),["exact","prevent"]),["tab"])),t[14]||(t[14]=Hn(((...e)=>l.selectItem&&l.selectItem(...e)),["tab"])),t[15]||(t[15]=Hn(Pn((()=>{}),["exact","prevent"]),["up"])),t[16]||(t[16]=Hn((e=>l.updateActiveUpOrDown(-1)),["up"])),t[17]||(t[17]=Hn(Pn((()=>{}),["exact","prevent"]),["down"])),t[18]||(t[18]=Hn((e=>l.updateActiveUpOrDown(1)),["down"]))],onPaste:t[12]||(t[12]=(...e)=>l.onPasteImage&&l.onPasteImage(...e))},null,42,Vf),ro("div",zf,[r.editedMessage._id?(Ga(),Ja("div",{key:0,class:"vac-svg-button",onClick:t[19]||(t[19]=(...e)=>l.resetMessage&&l.resetMessage(...e))},[ra(e.$slots,"edit-close-icon",{},(()=>[io(_,{name:"close-outline"})]))])):mo("",!0),o.showEmojis?Zs((Ga(),Ja("div",Xf,[ra(e.$slots,"emoji-picker",go({emojiOpened:r.emojiOpened},{addEmoji:l.addEmoji}),(()=>[io(v,{"emoji-opened":r.emojiOpened,"position-top":!0,onAddEmoji:l.addEmoji,onOpenEmoji:t[20]||(t[20]=e=>r.emojiOpened=e)},{"emoji-picker-icon":us((()=>[ra(e.$slots,"emoji-picker-icon")])),_:3},8,["emoji-opened","onAddEmoji"])]))])),[[y,()=>r.emojiOpened=!1]]):mo("",!0),o.showFiles?(Ga(),Ja("div",{key:2,class:"vac-svg-button",onClick:t[21]||(t[21]=(...e)=>l.launchFilePicker&&l.launchFilePicker(...e))},[ra(e.$slots,"paperclip-icon",{},(()=>[io(_,{name:"paperclip"})]))])):mo("",!0),o.textareaActionEnabled?(Ga(),Ja("div",{key:3,class:"vac-svg-button",onClick:t[22]||(t[22]=(...e)=>l.textareaActionHandler&&l.textareaActionHandler(...e))},[ra(e.$slots,"custom-action-icon",{},(()=>[io(_,{name:"deleted"})]))])):mo("",!0),o.showFiles?(Ga(),Ja("input",{key:4,ref:"file",type:"file",multiple:"",accept:o.acceptedFiles,style:{display:"none"},onChange:t[23]||(t[23]=e=>l.onFileChange(e.target.files))},null,40,Yf)):mo("",!0),o.showSendIcon?(Ga(),Ja("div",{key:5,class:Ge(["vac-svg-button",{"vac-send-disabled":l.isMessageEmpty}]),onClick:t[24]||(t[24]=(...e)=>l.sendMessage&&l.sendMessage(...e))},[ra(e.$slots,"send-icon",{},(()=>[io(_,{name:"send",param:l.isMessageEmpty||l.isFileLoading?"disabled":""},null,8,["param"])]))],2)):mo("",!0)])],2)],2)),[[$n,Object.keys(o.room).length&&o.showFooter]])}]]);const Gf={class:"vac-reply-message"},Zf={class:"vac-reply-username"},Wf={key:0,class:"vac-image-reply-container"},Qf={key:1,class:"vac-video-reply-container"},Jf={controls:""},eg=["src"],tg={key:3,class:"vac-file-container"},sg={class:"vac-text-ellipsis"},ag={key:0,class:"vac-text-ellipsis vac-text-extension"},og={class:"vac-reply-content"};var ng=Vn({name:"MessageReply",components:{AudioPlayer:Om,SvgIcon:ar,FormatMessage:tc},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find((t=>t._id===e));return t?t.username:""},firstFile(){var e,t;return(null==(t=null==(e=this.message.replyMessage)?void 0:e.files)?void 0:t.length)?this.message.replyMessage.files[0]:{}},isAudio(){return fc(this.firstFile)},isImage(){return mc(this.firstFile)},isVideo(){return pc(this.firstFile)},isOtherFile(){var e;return(null==(e=this.message.replyMessage.files)?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},[["render",function(e,t,o,n,r,l){const c=Js("audio-player"),d=Js("svg-icon"),m=Js("format-message");return Ga(),Ja("div",Gf,[ro("div",Zf,We(l.replyUsername),1),l.isImage?(Ga(),Ja("div",Wf,[ro("div",{class:"vac-message-image vac-message-image-reply",style:ze({"background-image":`url('${l.firstFile.url}')`})},null,4)])):l.isVideo?(Ga(),Ja("div",Qf,[ro("video",Jf,[ro("source",{src:l.firstFile.url},null,8,eg)])])):l.isAudio?(Ga(),eo(c,{key:2,src:l.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=t=>e.progressTime=t),onHoverAudioProgress:t[1]||(t[1]=t=>e.hoverAudioProgress=t)},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["src"])):l.isOtherFile?(Ga(),Ja("div",tg,[ro("div",null,[ra(e.$slots,"file-icon",{},(()=>[io(d,{name:"file"})]))]),ro("div",sg,We(l.firstFile.name),1),l.firstFile.extension?(Ga(),Ja("div",ag,We(l.firstFile.extension),1)):mo("",!0)])):mo("",!0),ro("div",og,[io(m,{"message-id":o.message.replyMessage._id,content:o.message.replyMessage.content,users:o.roomUsers,"text-formatting":o.textFormatting,"link-options":o.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}]]);const rg={name:"ProgressBar",props:{progress:{type:Number,default:0}},data:()=>({radius:35,stroke:4,normalizedRadius:27,circumference:54*Math.PI}),computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},ig={ref:"progress",class:"vac-progress-wrapper"},lg=["height","width"],cg=["stroke-dasharray","stroke-width","r","cx","cy"],dg={class:"vac-progress-text"},ug=ro("span",{class:"vac-progress-pourcent"},"%",-1);var mg=Vn(rg,[["render",function(e,t,o,n,r,l){return Ga(),eo(un,{name:"vac-fade-spinner",appear:""},{default:us((()=>[ro("div",ig,[(Ga(),Ja("svg",{height:2*r.radius,width:2*r.radius},[ro("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":r.circumference+" "+r.circumference,style:ze({strokeDashoffset:l.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":r.stroke,fill:"transparent",r:r.normalizedRadius,cx:r.radius,cy:r.radius},null,12,cg)],8,lg)),ro("div",{class:"vac-progress-content",style:ze({height:2*r.radius-19+"px",width:2*r.radius-19+"px"})},[ro("div",dg,[uo(We(o.progress),1),ug])],4)],512)])),_:1})}]]);const pg={name:"MessageFile",components:{SvgIcon:ar,Loader:Qn,ProgressBar:mg},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data:()=>({imageResponsive:"",imageLoading:!1,imageHover:!1}),computed:{isImageLoading(){return-1!==this.file.url.indexOf("blob:http")||this.imageLoading},isImage(){return mc(this.file)},isVideo(){return pc(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!mc(this.file))return;this.imageLoading=!0;const image=new Image;image.src=this.file.url,image.addEventListener("load",(()=>this.imageLoading=!1))},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},hg={class:"vac-message-file-container"},fg={key:0,class:"vac-image-buttons"},gg={controls:""},_g=["src"];const vg={name:"MessageFiles",components:{SvgIcon:ar,FormatMessage:tc,ProgressBar:mg,MessageFile:Vn(pg,[["render",function(e,t,o,n,r,l){const c=Js("progress-bar"),d=Js("loader"),m=Js("svg-icon");return Ga(),Ja("div",hg,[l.isImage?(Ga(),Ja("div",{key:0,ref:"imageRef"+o.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=e=>r.imageHover=!0),onMouseleave:t[3]||(t[3]=e=>r.imageHover=!1),onClick:t[4]||(t[4]=e=>l.openFile(e,"preview"))},[o.file.progress>=0?(Ga(),eo(c,{key:0,progress:o.file.progress,style:ze({top:`${r.imageResponsive.loaderTop}px`})},null,8,["progress","style"])):(Ga(),eo(d,{key:1,show:l.isImageLoading,type:"message-file","message-id":o.message._id,style:ze({top:`${r.imageResponsive.loaderTop}px`})},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["show","message-id","style"])),ro("div",{class:Ge(["vac-message-image",{"vac-blur-loading":l.isImageLoading&&o.message.senderId===o.currentUserId}]),style:ze({"background-image":`url('${l.isImageLoading&&o.file.preview||o.file.url}')`,"max-height":`${r.imageResponsive.maxHeight}px`})},[io(un,{name:"vac-fade-image"},{default:us((()=>[o.messageSelectionEnabled||!r.imageHover||l.isImageLoading?mo("",!0):(Ga(),Ja("div",fg,[ro("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=e=>l.openFile(e,"preview"))},[ra(e.$slots,"eye-icon_"+o.message._id,{},(()=>[io(m,{name:"eye"})]))]),ro("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=e=>l.openFile(e,"download"))},[ra(e.$slots,"document-icon_"+o.message._id,{},(()=>[io(m,{name:"document"})]))])]))])),_:3})],6)],544)):l.isVideo?(Ga(),Ja("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=Pn((e=>l.openFile(e,"preview")),["prevent"]))},[o.file.progress>=0?(Ga(),eo(c,{key:0,progress:o.file.progress},null,8,["progress"])):mo("",!0),ro("video",gg,[ro("source",{src:o.file.url},null,8,_g)])])):mo("",!0)])}]])},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter((e=>hc(e)))},otherFiles(){return this.message.files.filter((e=>!hc(e)))}},methods:{openFile(e,t,o){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:o}))}}},bg={class:"vac-message-files-container"},yg=["onClick"],xg={class:"vac-svg-button"},wg={class:"vac-text-ellipsis"},kg={key:0,class:"vac-text-ellipsis vac-text-extension"};var Sg=Vn(vg,[["render",function(e,t,o,n,r,l){const c=Js("message-file"),d=Js("progress-bar"),m=Js("svg-icon"),h=Js("format-message");return Ga(),Ja("div",bg,[(Ga(!0),Ja(qa,null,oa(l.imageVideoFiles,((n,i)=>(Ga(),Ja("div",{key:i+"iv"},[io(c,{file:n,"current-user-id":o.currentUserId,message:o.message,index:i,"message-selection-enabled":o.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=t=>e.$emit("open-file",t))},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["file","current-user-id","message","index","message-selection-enabled"])])))),128)),(Ga(!0),Ja(qa,null,oa(l.otherFiles,((t,i)=>(Ga(),Ja("div",{key:i+"a",class:"vac-file-wrapper"},[t.progress>=0?(Ga(),eo(d,{key:0,progress:t.progress,style:{top:"44px"}},null,8,["progress"])):mo("",!0),ro("div",{class:Ge(["vac-file-container",{"vac-file-container-progress":t.progress>=0}]),onClick:e=>l.openFile(e,t,"download")},[ro("div",xg,[ra(e.$slots,"document-icon",{},(()=>[io(m,{name:"document"})]))]),ro("div",wg,We(t.name),1),t.extension?(Ga(),Ja("div",kg,We(t.extension),1)):mo("",!0)],10,yg)])))),128)),io(h,{"message-id":o.message._id,content:o.message.content,users:o.roomUsers,"text-formatting":o.textFormatting,"link-options":o.linkOptions,onOpenUserTag:t[1]||(t[1]=t=>e.$emit("open-user-tag",t))},null,8,["message-id","content","users","text-formatting","link-options"])])}]]);const Mg={name:"MessageActions",components:{SvgIcon:ar,EmojiPickerContainer:_m},directives:{clickOutside:cc},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data:()=>({menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}),computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter((e=>!e.onlyMe))}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout((()=>{const e=document.querySelector("vue-advanced-chat").shadowRoot.getElementById("room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,o=this.$refs.actionIcon.getBoundingClientRect().top,n=e.getBoundingClientRect().top-o>t+50;this.menuOptionsTop=n?30:-t})))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout((()=>this.optionsClosing=!1),100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},Rg={class:"vac-message-actions-wrapper"},Ag={key:"3"},Eg={class:"vac-menu-list"},Tg=["onClick"];const Bg=["onClick"];function Og(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]&&void 0!==e[t]}const Cg={name:"RoomMessage",components:{SvgIcon:ar,FormatMessage:tc,AudioPlayer:Om,MessageReply:ng,MessageFiles:Sg,MessageActions:Vn(Mg,[["render",function(e,t,o,n,r,l){const c=Js("svg-icon"),d=Js("emoji-picker-container"),m=ta("click-outside");return Ga(),Ja("div",Rg,[ro("div",{class:"vac-options-container",style:ze({display:o.hoverAudioProgress?"none":"initial",width:l.filteredMessageActions.length&&o.showReactionEmojis?"70px":"45px"})},[io(Bn,{name:"vac-slide-left",tag:"span"},{default:us((()=>[l.isMessageActions||l.isMessageReactions?(Ga(),Ja("div",{key:"1",class:Ge(["vac-blur-container",{"vac-options-me":o.message.senderId===o.currentUserId}])},null,2)):mo("",!0),l.isMessageActions?(Ga(),Ja("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...e)=>l.openOptions&&l.openOptions(...e))},[ra(e.$slots,"dropdown-icon_"+o.message._id,{},(()=>[io(c,{name:"dropdown",param:"message"})]))],512)):mo("",!0),l.isMessageReactions?Zs((Ga(),Ja("div",Ag,[ra(e.$slots,"emoji-picker",go({emojiOpened:r.emojiOpened},{addEmoji:l.sendMessageReaction}),(()=>[io(d,{class:"vac-message-emojis",style:ze({right:l.isMessageActions?"30px":"5px"}),"emoji-opened":r.emojiOpened,"emoji-reaction":!0,"position-right":o.message.senderId===o.currentUserId,"message-id":o.message._id,onAddEmoji:l.sendMessageReaction,onOpenEmoji:l.openEmoji},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["style","emoji-opened","position-right","message-id","onAddEmoji","onOpenEmoji"])]))])),[[m,l.closeEmoji]]):mo("",!0)])),_:3})],4),l.filteredMessageActions.length?(Ga(),eo(un,{key:0,name:o.message.senderId===o.currentUserId?"vac-slide-left":"vac-slide-right"},{default:us((()=>[r.optionsOpened?Zs((Ga(),Ja("div",{key:0,ref:"menuOptions",class:Ge(["vac-menu-options",{"vac-menu-left":o.message.senderId!==o.currentUserId}]),style:ze({top:`${r.menuOptionsTop}px`})},[ro("div",Eg,[(Ga(!0),Ja(qa,null,oa(l.filteredMessageActions,(e=>(Ga(),Ja("div",{key:e.name},[ro("div",{class:"vac-menu-item",onClick:t=>l.messageActionHandler(e)},We(e.title),9,Tg)])))),128))])],6)),[[m,l.closeOptions]]):mo("",!0)])),_:1},8,["name"])):mo("",!0)])}]]),MessageReactions:Vn({name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},[["render",function(e,t,o,n,r,l){return o.message.deleted?mo("",!0):(Ga(),eo(Bn,{key:0,name:"vac-slide-left",tag:"span"},{default:us((()=>[(Ga(!0),Ja(qa,null,oa(o.message.reactions,((e,t)=>Zs((Ga(),Ja("button",{key:t+0,class:Ge(["vac-button-reaction",{"vac-reaction-me":-1!==e.indexOf(o.currentUserId)}]),style:ze({float:o.message.senderId===o.currentUserId?"right":"left"}),onClick:o=>l.sendMessageReaction({unicode:t},e)},[uo(We(t),1),ro("span",null,We(e.length),1)],14,Bg)),[[$n,e.length]]))),128))])),_:1}))}]])},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data:()=>({hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}),computed:{showUsername(){return!(!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId)&&this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return null==(e=this.message.files)?void 0:e.some((e=>fc(e)))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some((e=>e.senderId===this.currentUserId&&e.avatar))},hasSenderUserAvatar(){return this.messages.some((e=>e.senderId!==this.currentUserId&&e.avatar))},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find((e=>e._id===this.message._id))}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){e.length&&this.showNewMessagesDivider?this.newMessage=e.reduce(((e,t)=>t.index<e.index?t:e)):this.newMessage={}}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){!function(e){if(t=e,![{key:"_id",type:["string","number"]},{key:"content",type:["string","number"]},{key:"senderId",type:["string","number"]}].every((e=>e.type.find((o=>o===typeof t[e.key]))&&Og(t,e.key))))throw new Error("Messages object is not valid! Must contain _id[String, Number], content[String, Number] and senderId[String, Number]");var t}(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(this.optionsOpened||this.emojiOpened||(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout((()=>{this.$emit("message-action-handler",{action:e,message:this.message})}),300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&-1!==t.indexOf(this.currentUserId)}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},Ig=["id"],jg={key:0,class:"vac-card-info vac-card-date"},Lg={key:1,class:"vac-line-new"},Pg={key:2,class:"vac-card-info vac-card-system"},Ng={key:1,class:"vac-avatar-offset"},Hg={key:0,class:"vac-progress-time"},$g={class:"vac-text-timestamp"},Fg={key:0,class:"vac-icon-edited"},Dg={key:1},Ug=[ro("div",{class:"vac-failure-text"},"!",-1)],qg={key:3,class:"vac-avatar-current-offset"};const Vg={name:"ChatRoom",components:{Loader:Qn,SvgIcon:ar,RoomHeader:Wc,RoomFooter:Kf,RoomMessage:Vn(Cg,[["render",function(e,t,o,n,r,l){const c=Js("format-message"),d=Js("message-reply"),m=Js("message-files"),h=Js("audio-player"),f=Js("svg-icon"),_=Js("message-actions"),v=Js("message-reactions");return Ga(),Ja("div",{id:o.message._id,ref:"message",class:"vac-message-wrapper"},[l.showDate?(Ga(),Ja("div",jg,We(o.message.date),1)):mo("",!0),r.newMessage._id===o.message._id?(Ga(),Ja("div",Lg,We(o.textMessages.NEW_MESSAGES),1)):mo("",!0),o.message.system?(Ga(),Ja("div",Pg,[ra(e.$slots,"message_"+o.message._id,{},(()=>[io(c,{"message-id":o.message._id,content:o.message.content,deleted:!!o.message.deleted,users:o.roomUsers,"text-messages":o.textMessages,"text-formatting":o.textFormatting,"link-options":o.linkOptions,onOpenUserTag:l.openUserTag},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])]))])):(Ga(),Ja("div",{key:3,class:Ge(["vac-message-box",{"vac-offset-current":o.message.senderId===o.currentUserId}]),onClick:t[8]||(t[8]=(...e)=>l.selectMessage&&l.selectMessage(...e))},[ra(e.$slots,"message_"+o.message._id,{},(()=>[o.message.avatar&&o.message.senderId!==o.currentUserId?(Ga(),Ja("div",{key:0,class:"vac-avatar",style:ze({"background-image":`url('${o.message.avatar}')`})},null,4)):mo("",!0),l.hasSenderUserAvatar&&!o.message.avatar?(Ga(),Ja("div",Ng)):mo("",!0),ro("div",{class:Ge(["vac-message-container",{"vac-message-container-offset":l.messageOffset}])},[ro("div",{class:Ge(["vac-message-card",{"vac-message-highlight":l.isMessageHover,"vac-message-current":o.message.senderId===o.currentUserId,"vac-message-deleted":o.message.deleted,"vac-item-clickable":o.messageSelectionEnabled,"vac-message-selected":l.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...e)=>l.onHoverMessage&&l.onHoverMessage(...e)),onMouseleave:t[6]||(t[6]=(...e)=>l.onLeaveMessage&&l.onLeaveMessage(...e))},[l.showUsername?(Ga(),Ja("div",{key:0,class:Ge(["vac-text-username",{"vac-username-reply":!o.message.deleted&&o.message.replyMessage}])},[ro("span",null,We(o.message.username),1)],2)):mo("",!0),!o.message.deleted&&o.message.replyMessage?(Ga(),eo(d,{key:1,message:o.message,"room-users":o.roomUsers,"text-formatting":o.textFormatting,"link-options":o.linkOptions},na({_:2},[oa(e.$slots,((i,t)=>({name:t,fn:us((data=>[ra(e.$slots,t,Ze(lo(data)))]))})))]),1032,["message","room-users","text-formatting","link-options"])):mo("",!0),!o.message.deleted&&o.message.files&&o.message.files.length?!l.isAudio||o.message.files.length>1?(Ga(),eo(m,{key:3,"current-user-id":o.currentUserId,message:o.message,"room-users":o.roomUsers,"text-formatting":o.textFormatting,"link-options":o.linkOptions,"message-selection-enabled":o.messageSelectionEnabled,onOpenFile:l.openFile,onOpenUserTag:l.openUserTag},na({_:2},[oa(e.$slots,((i,t)=>({name:t,fn:us((data=>[ra(e.$slots,t,Ze(lo(data)))]))})))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(Ga(),Ja(qa,{key:4},[io(h,{"message-id":o.message._id,src:o.message.files[0].url,"message-selection-enabled":o.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=e=>r.progressTime=e),onHoverAudioProgress:t[1]||(t[1]=e=>r.hoverAudioProgress=e)},na({_:2},[oa(e.$slots,((i,t)=>({name:t,fn:us((data=>[ra(e.$slots,t,Ze(lo(data)))]))})))]),1032,["message-id","src","message-selection-enabled"]),o.message.deleted?mo("",!0):(Ga(),Ja("div",Hg,We(r.progressTime),1))],64)):(Ga(),eo(c,{key:2,"message-id":o.message._id,content:o.message.content,deleted:!!o.message.deleted,users:o.roomUsers,"text-formatting":o.textFormatting,"text-messages":o.textMessages,"link-options":o.linkOptions,onOpenUserTag:l.openUserTag},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])),ro("div",$g,[o.message.edited&&!o.message.deleted?(Ga(),Ja("div",Fg,[ra(e.$slots,"pencil-icon_"+o.message._id,{},(()=>[io(f,{name:"pencil"})]))])):mo("",!0),ro("span",null,We(o.message.timestamp),1),l.isCheckmarkVisible?(Ga(),Ja("span",Dg,[ra(e.$slots,"checkmark-icon_"+o.message._id,{},(()=>[io(f,{name:o.message.distributed?"double-checkmark":"checkmark",param:o.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])]))])):mo("",!0)]),io(_,{"current-user-id":o.currentUserId,message:o.message,"message-actions":o.messageActions,"show-reaction-emojis":o.showReactionEmojis,"message-hover":r.messageHover,"hover-message-id":r.hoverMessageId,"hover-audio-progress":r.hoverAudioProgress,onUpdateMessageHover:t[2]||(t[2]=e=>r.messageHover=e),onUpdateOptionsOpened:t[3]||(t[3]=e=>r.optionsOpened=e),onUpdateEmojiOpened:t[4]||(t[4]=e=>r.emojiOpened=e),onMessageActionHandler:l.messageActionHandler,onSendMessageReaction:l.sendMessageReaction},na({_:2},[oa(e.$slots,((i,t)=>({name:t,fn:us((data=>[ra(e.$slots,t,Ze(lo(data)))]))})))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","onMessageActionHandler","onSendMessageReaction"])],34),io(v,{"current-user-id":o.currentUserId,message:o.message,onSendMessageReaction:l.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),ra(e.$slots,"message-failure_"+o.message._id,{},(()=>[o.message.failure&&o.message.senderId===o.currentUserId?(Ga(),Ja("div",{key:0,class:Ge(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":o.message.avatar&&o.message.senderId===o.currentUserId}]),onClick:t[7]||(t[7]=t=>e.$emit("open-failed-message",{message:o.message}))},Ug,2)):mo("",!0)])),o.message.avatar&&o.message.senderId===o.currentUserId?(Ga(),Ja("div",{key:2,class:"vac-avatar vac-avatar-current",style:ze({"background-image":`url('${o.message.avatar}')`})},null,4)):mo("",!0),l.hasCurrentUserAvatar&&!o.message.avatar?(Ga(),Ja("div",qg)):mo("",!0)]))],2))],8,Ig)}]])},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data:()=>({editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[]}),computed:{room(){return this.rooms.find((e=>e.roomId===this.roomId))||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach(((e,i)=>{this.showNewMessagesDivider&&!e.seen&&e.senderId!==this.currentUserId&&this.newMessages.push({_id:e._id,index:i})})),(null==t?void 0:t.length)===(null==e?void 0:e.length)-1&&(this.newMessages=[]),setTimeout((()=>this.loadingMoreMessages=!1))}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout((()=>this.initIntersectionObserver()))},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=document.querySelector("vue-advanced-chat").shadowRoot.getElementById("infinite-loader-messages");if(e){const t={root:document.querySelector("vue-advanced-chat").shadowRoot.getElementById("messages-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver((e=>{e[0].isIntersecting&&this.loadMoreMessages()}),t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,o=new ResizeObserver((n=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),o.disconnect())}));for(var i=0;i<e.children.length;i++)o.observe(e.children[i])},touchStart(e){if(!this.singleRoom&&1===e.changedTouches.length){const t=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY;addEventListener("touchend",(e=>this.touchEnd(e,t,o)),{once:!0})}},touchEnd(e,t,o){if(1===e.changedTouches.length){const n=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY,l=n-t>100,c=Math.abs(r-o)>50;l&&!c&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch((()=>this.messages),(t=>{if(!t||!t.length)return;const o=this.$refs.scrollContainer;o&&(e(),setTimeout((()=>{o.scrollTo({top:o.scrollHeight}),this.updateLoadingMessages(!1)})))}))},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter((t=>t._id!==e))},onMessageAdded({message:e,index:t,ref:o}){if(t!==this.messages.length-1)return;const n=o.offsetHeight+60;setTimeout((()=>{const t=this.getBottomScroll(this.$refs.scrollContainer)>n;e.senderId===this.currentUserId?t?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():t?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)}))},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout((()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId)return this.loadingMoreMessages=!1,void(this.showLoader=!1);this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}}),500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":return void(this.initReplyMessage=t);case"editMessage":return void(this.initEditMessage=t);case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":return this.selectedMessages=[t],void(this.messageSelectionEnabled=!0);default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:o,scrollTop:n}=e;return t-o-n},scrollToBottom(){setTimeout((()=>{const e=this.$refs.scrollContainer;e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout((()=>e.classList.remove("vac-scroll-smooth")))}),50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)}}},zg={class:"vac-container-center vac-room-empty"},Xg={class:"vac-messages-container"},Yg={key:0,class:"vac-text-started"},Kg={key:1,class:"vac-text-started"},Gg={key:0,id:"infinite-loader-messages"},Zg={key:2},Wg={key:0,class:"vac-badge-counter vac-messages-count"};var Qg=Vn(Vg,[["render",function(e,t,o,n,r,l){const c=Js("room-header"),d=Js("loader"),m=Js("room-message"),h=Js("svg-icon"),f=Js("room-footer");return Zs((Ga(),Ja("div",{class:"vac-col-messages",onTouchstart:t[12]||(t[12]=(...e)=>l.touchStart&&l.touchStart(...e))},[l.showNoRoom?ra(e.$slots,"no-room-selected",{key:0},(()=>[ro("div",zg,[ro("div",null,We(o.textMessages.ROOM_EMPTY),1)])])):(Ga(),eo(c,{key:1,"current-user-id":o.currentUserId,"text-messages":o.textMessages,"single-room":o.singleRoom,"show-rooms-list":o.showRoomsList,"is-mobile":o.isMobile,"room-info-enabled":o.roomInfoEnabled,"menu-actions":o.menuActions,room:l.room,"message-selection-enabled":r.messageSelectionEnabled,"message-selection-actions":o.messageSelectionActions,"selected-messages-total":r.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=t=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=t=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=t=>e.$emit("menu-action-handler",t)),onMessageSelectionActionHandler:l.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=e=>r.messageSelectionEnabled=!1)},na({_:2},[oa(e.$slots,((i,t)=>({name:t,fn:us((data=>[ra(e.$slots,t,Ze(lo(data)))]))})))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),ro("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...e)=>l.onContainerScroll&&l.onContainerScroll(...e))},[io(d,{show:r.loadingMessages,type:"messages"},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["show"]),ro("div",Xg,[ro("div",{class:Ge({"vac-messages-hidden":r.loadingMessages})},[io(un,{name:"vac-fade-message"},{default:us((()=>[ro("div",null,[l.showNoMessages?(Ga(),Ja("div",Yg,[ra(e.$slots,"messages-empty",{},(()=>[uo(We(o.textMessages.MESSAGES_EMPTY),1)]))])):mo("",!0),l.showMessagesStarted?(Ga(),Ja("div",Kg,We(o.textMessages.CONVERSATION_STARTED)+" "+We(o.messages[0].date),1)):mo("",!0)])])),_:3}),o.messages.length&&!o.messagesLoaded?(Ga(),Ja("div",Gg,[io(d,{show:!0,infinite:!0,type:"infinite-messages"},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1024)])):mo("",!0),(Ga(),eo(Bn,{key:o.roomId,name:"vac-fade-message",tag:"span"},{default:us((()=>[(Ga(!0),Ja(qa,null,oa(o.messages,((n,i)=>(Ga(),Ja("div",{key:n.indexId||n._id},[io(m,{"current-user-id":o.currentUserId,message:n,index:i,messages:o.messages,"edited-message-id":r.editedMessageId,"message-actions":o.messageActions,"room-users":l.room.users,"text-messages":o.textMessages,"new-messages":r.newMessages,"show-reaction-emojis":o.showReactionEmojis,"show-new-messages-divider":o.showNewMessagesDivider,"text-formatting":o.textFormatting,"link-options":o.linkOptions,"username-options":o.usernameOptions,"message-selection-enabled":r.messageSelectionEnabled,"selected-messages":r.selectedMessages,onMessageAdded:l.onMessageAdded,onMessageActionHandler:l.messageActionHandler,onOpenFile:l.openFile,onOpenUserTag:l.openUserTag,onOpenFailedMessage:t[4]||(t[4]=t=>e.$emit("open-failed-message",t)),onSendMessageReaction:l.sendMessageReaction,onSelectMessage:l.selectMessage,onUnselectMessage:l.unselectMessage},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])])))),128))])),_:3}))],2)])],544),r.loadingMessages?mo("",!0):(Ga(),Ja("div",Zg,[io(un,{name:"vac-bounce"},{default:us((()=>[r.scrollIcon?(Ga(),Ja("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...e)=>l.scrollToBottom&&l.scrollToBottom(...e))},[io(un,{name:"vac-bounce"},{default:us((()=>[r.scrollMessagesCount?(Ga(),Ja("div",Wg,We(r.scrollMessagesCount),1)):mo("",!0)])),_:1}),ra(e.$slots,"scroll-icon",{},(()=>[io(h,{name:"dropdown",param:"scroll"})]))])):mo("",!0)])),_:3})])),io(f,{room:l.room,"room-id":o.roomId,"room-message":o.roomMessage,"text-messages":o.textMessages,"show-send-icon":o.showSendIcon,"show-files":o.showFiles,"show-audio":o.showAudio,"show-emojis":o.showEmojis,"show-footer":o.showFooter,"accepted-files":o.acceptedFiles,"textarea-action-enabled":o.textareaActionEnabled,"textarea-auto-focus":o.textareaAutoFocus,"user-tags-enabled":o.userTagsEnabled,"emojis-suggestion-enabled":o.emojisSuggestionEnabled,"templates-text":o.templatesText,"text-formatting":o.textFormatting,"link-options":o.linkOptions,"audio-bit-rate":o.audioBitRate,"audio-sample-rate":o.audioSampleRate,"init-reply-message":r.initReplyMessage,"init-edit-message":r.initEditMessage,onUpdateEditedMessageId:t[7]||(t[7]=e=>r.editedMessageId=e),onEditMessage:t[8]||(t[8]=t=>e.$emit("edit-message",t)),onSendMessage:t[9]||(t[9]=t=>e.$emit("send-message",t)),onTypingMessage:t[10]||(t[10]=t=>e.$emit("typing-message",t)),onTextareaActionHandler:t[11]||(t[11]=t=>e.$emit("textarea-action-handler",t))},na({_:2},[oa(e.$slots,((t,o)=>({name:o,fn:us((data=>[ra(e.$slots,o,Ze(lo(data)))]))})))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message"])],544)),[[$n,o.isMobile&&!o.showRoomsList||!o.isMobile||o.singleRoom]])}]]);const Jg={key:0,class:"vac-media-preview-container"},e_={key:1,class:"vac-media-preview-container"},t_={controls:"",autoplay:""},s_=["src"],a_={class:"vac-svg-button"};var o_={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const n_={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}};const r_={name:"ChatContainer",components:{RoomsList:Pc,Room:Qg,MediaPreview:Vn({name:"MediaPreview",components:{SvgIcon:ar},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return mc(this.file)},isVideo(){return pc(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},[["render",function(e,t,o,n,r,l){const c=Js("svg-icon");return Ga(),Ja("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=Pn(((...e)=>l.closeModal&&l.closeModal(...e)),["stop"])),onKeydown:t[1]||(t[1]=Hn(((...e)=>l.closeModal&&l.closeModal(...e)),["esc"]))},[io(un,{name:"vac-bounce-preview",appear:""},{default:us((()=>[l.isImage?(Ga(),Ja("div",Jg,[ro("div",{class:"vac-image-preview",style:ze({"background-image":`url('${o.file.url}')`})},null,4)])):l.isVideo?(Ga(),Ja("div",e_,[ro("video",t_,[ro("source",{src:o.file.url},null,8,s_)])])):mo("",!0)])),_:1}),ro("div",a_,[ra(e.$slots,"preview-close-icon",{},(()=>[io(c,{name:"close-outline",param:"preview"})]))])],544)}]])},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1,italic:"_",bold:"*",strike:"~",underline:"°",multilineCode:"```",inlineCode:"`"})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","room-action-handler","message-selection-action-handler"],data:()=>({slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}),computed:{t(){return{...o_,...this.textMessagesCasted}},cssVars(){const e=n_[this.theme],t={};return Object.keys(e).map((o=>{t[o]={...e[o],...this.stylesCasted[o]||{}}})),(({general:e,container:t,header:header,footer:footer,sidemenu:o,content:content,dropdown:n,message:r,markdown:l,room:c,emoji:d,icons:m})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":header.background,"--chat-header-color-name":header.colorRoomName,"--chat-header-color-info":header.colorRoomInfo,"--chat-footer-bg-color":footer.background,"--chat-border-style-input":footer.borderStyleInput,"--chat-border-color-input-selected":footer.borderInputSelected,"--chat-footer-bg-color-reply":footer.backgroundReply,"--chat-footer-bg-color-tag-active":footer.backgroundTagActive,"--chat-footer-bg-color-tag":footer.backgroundTag,"--chat-content-bg-color":content.background,"--chat-sidemenu-bg-color":o.background,"--chat-sidemenu-bg-color-hover":o.backgroundHover,"--chat-sidemenu-bg-color-active":o.backgroundActive,"--chat-sidemenu-color-active":o.colorActive,"--chat-sidemenu-border-color-search":o.borderColorSearch,"--chat-dropdown-bg-color":n.background,"--chat-dropdown-bg-color-hover":n.backgroundHover,"--chat-message-bg-color":r.background,"--chat-message-bg-color-me":r.backgroundMe,"--chat-message-color-started":r.colorStarted,"--chat-message-bg-color-deleted":r.backgroundDeleted,"--chat-message-bg-color-selected":r.backgroundSelected,"--chat-message-color-deleted":r.colorDeleted,"--chat-message-color-username":r.colorUsername,"--chat-message-color-timestamp":r.colorTimestamp,"--chat-message-bg-color-date":r.backgroundDate,"--chat-message-color-date":r.colorDate,"--chat-message-bg-color-system":r.backgroundSystem,"--chat-message-color-system":r.colorSystem,"--chat-message-color":r.color,"--chat-message-bg-color-media":r.backgroundMedia,"--chat-message-bg-color-reply":r.backgroundReply,"--chat-message-color-reply-username":r.colorReplyUsername,"--chat-message-color-reply-content":r.colorReply,"--chat-message-color-tag":r.colorTag,"--chat-message-bg-color-image":r.backgroundImage,"--chat-message-color-new-messages":r.colorNewMessages,"--chat-message-bg-color-scroll-counter":r.backgroundScrollCounter,"--chat-message-color-scroll-counter":r.colorScrollCounter,"--chat-message-bg-color-reaction":r.backgroundReaction,"--chat-message-border-style-reaction":r.borderStyleReaction,"--chat-message-bg-color-reaction-hover":r.backgroundReactionHover,"--chat-message-border-style-reaction-hover":r.borderStyleReactionHover,"--chat-message-color-reaction-counter":r.colorReactionCounter,"--chat-message-bg-color-reaction-me":r.backgroundReactionMe,"--chat-message-border-style-reaction-me":r.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":r.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":r.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":r.colorReactionCounterMe,"--chat-message-bg-color-audio-record":r.backgroundAudioRecord,"--chat-message-bg-color-audio-line":r.backgroundAudioLine,"--chat-message-bg-color-audio-progress":r.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":r.backgroundAudioProgressSelector,"--chat-message-color-file-extension":r.colorFileExtension,"--chat-markdown-bg":l.background,"--chat-markdown-border":l.border,"--chat-markdown-color":l.color,"--chat-markdown-color-multi":l.colorMulti,"--chat-room-color-username":c.colorUsername,"--chat-room-color-message":c.colorMessage,"--chat-room-color-timestamp":c.colorTimestamp,"--chat-room-color-online":c.colorStateOnline,"--chat-room-color-offline":c.colorStateOffline,"--chat-room-bg-color-badge":c.backgroundCounterBadge,"--chat-room-color-badge":c.colorCounterBadge,"--chat-emoji-bg-color":d.background,"--chat-icon-color-search":m.search,"--chat-icon-color-add":m.add,"--chat-icon-color-toggle":m.toggle,"--chat-icon-color-menu":m.menu,"--chat-icon-color-close":m.close,"--chat-icon-color-close-image":m.closeImage,"--chat-icon-color-file":m.file,"--chat-icon-color-paperclip":m.paperclip,"--chat-icon-color-close-outline":m.closeOutline,"--chat-icon-color-close-preview":m.closePreview,"--chat-icon-color-send":m.send,"--chat-icon-color-send-disabled":m.sendDisabled,"--chat-icon-color-emoji":m.emoji,"--chat-icon-color-emoji-reaction":m.emojiReaction,"--chat-icon-color-document":m.document,"--chat-icon-color-pencil":m.pencil,"--chat-icon-color-checkmark":m.checkmark,"--chat-icon-color-checkmark-seen":m.checkmarkSeen,"--chat-icon-color-eye":m.eye,"--chat-icon-color-dropdown-message":m.dropdownMessage,"--chat-icon-bg-dropdown-message":m.dropdownMessageBackground,"--chat-icon-color-dropdown-room":m.dropdownRoom,"--chat-icon-color-dropdown-scroll":m.dropdownScroll,"--chat-icon-color-microphone":m.microphone,"--chat-icon-color-audio-play":m.audioPlay,"--chat-icon-color-audio-pause":m.audioPause,"--chat-icon-color-audio-cancel":m.audioCancel,"--chat-icon-color-audio-confirm":m.audioConfirm}))(t)},orderedRooms(){return this.roomsCasted.slice().sort(((a,b)=>{const e=a.index||0,t=b.index||0;return"asc"===this.roomsOrder?e<t?-1:t<e?1:0:e>t?-1:t>e?1:0}))},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if(e[0]&&e.find((e=>e.roomId===this.room.roomId))||(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const t=e.find((e=>e.roomId===this.roomId))||{};this.fetchRoom({room:t})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const t=this.roomsCasted.find((t=>t.roomId===e));this.fetchRoom({room:t})}else t&&!e&&(this.room={})}},room(e){e&&0!==Object.entries(e).length&&(!function(e){if(t=e,![{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}].every((e=>{let o=!1;return("array"===e.type[0]&&Array.isArray(t[e.key])||e.type.find((o=>o===typeof t[e.key])))&&(o=!0),o&&Og(t,e.key)})))throw new Error("Rooms object is not valid! Must contain roomId[String, Number], roomName[String] and users[Array]");var t}(e),e.users.forEach((e=>{!function(e){if(t=e,![{key:"_id",type:["string","number"]},{key:"username",type:["string"]}].every((e=>e.type.find((o=>o===typeof t[e.key]))&&Og(t,e.key))))throw new Error("Participants object is not valid! Must contain _id[String, Number] and username[String]");var t}(e)})))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",(e=>{e.isTrusted&&this.updateResponsive()}))},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean:e=>"true"===e||!0===e,castArray:e=>e?Array.isArray(e)?e:JSON.parse(e):[],castObject:e=>e?"object"==typeof e?e:JSON.parse(e):{},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&"preview"===t.action?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},i_={class:"vac-chat-container"};const l_=function(e,t){const o=function(e){return ft(e)?{setup:e,name:e.name}:e}(e);class n extends ln{constructor(e){super(o,e,t)}}return n.def=o,n}(Vn(r_,[["render",function(e,t,o,n,r,l){const c=Js("rooms-list"),d=Js("room"),m=Js("media-preview");return Ga(),Ja("div",{class:"vac-card-window",style:ze([{height:o.height},l.cssVars])},[ro("div",i_,[l.singleRoomCasted?mo("",!0):(Ga(),eo(c,{key:0,"current-user-id":o.currentUserId,rooms:l.orderedRooms,"loading-rooms":l.loadingRoomsCasted,"rooms-loaded":l.roomsLoadedCasted,room:r.room,"room-actions":l.roomActionsCasted,"text-messages":l.t,"show-search":l.showSearchCasted,"show-add-room":l.showAddRoomCasted,"show-rooms-list":r.showRoomsList&&l.roomsListOpenedCasted,"text-formatting":l.textFormattingCasted,"link-options":l.linkOptionsCasted,"is-mobile":r.isMobile,"scroll-distance":o.scrollDistance,onFetchRoom:l.fetchRoom,onFetchMoreRooms:l.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=e=>r.loadingMoreRooms=e),onAddRoom:l.addRoom,onRoomActionHandler:l.roomActionHandler},na({_:2},[oa(r.slots,(t=>({name:t.slot,fn:us((data=>[ra(e.$slots,t.slot,Ze(lo(data)))]))})))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onRoomActionHandler"])),io(d,{"current-user-id":o.currentUserId,rooms:l.roomsCasted,"room-id":r.room.roomId||"","load-first-room":l.loadFirstRoomCasted,messages:l.messagesCasted,"room-message":o.roomMessage,"messages-loaded":l.messagesLoadedCasted,"menu-actions":l.menuActionsCasted,"message-actions":l.messageActionsCasted,"message-selection-actions":l.messageSelectionActionsCasted,"auto-scroll":l.autoScrollCasted,"show-send-icon":l.showSendIconCasted,"show-files":l.showFilesCasted,"show-audio":l.showAudioCasted,"audio-bit-rate":o.audioBitRate,"audio-sample-rate":o.audioSampleRate,"show-emojis":l.showEmojisCasted,"show-reaction-emojis":l.showReactionEmojisCasted,"show-new-messages-divider":l.showNewMessagesDividerCasted,"show-footer":l.showFooterCasted,"text-messages":l.t,"single-room":l.singleRoomCasted,"show-rooms-list":r.showRoomsList&&l.roomsListOpenedCasted,"text-formatting":l.textFormattingCasted,"link-options":l.linkOptionsCasted,"is-mobile":r.isMobile,"loading-rooms":l.loadingRoomsCasted,"room-info-enabled":l.roomInfoEnabledCasted,"textarea-action-enabled":l.textareaActionEnabledCasted,"textarea-auto-focus":l.textareaAutoFocusCasted,"user-tags-enabled":l.userTagsEnabledCasted,"emojis-suggestion-enabled":l.emojisSuggestionEnabledCasted,"scroll-distance":o.scrollDistance,"accepted-files":o.acceptedFiles,"templates-text":l.templatesTextCasted,"username-options":l.usernameOptionsCasted,onToggleRoomsList:l.toggleRoomsList,onRoomInfo:l.roomInfo,onFetchMessages:l.fetchMessages,onSendMessage:l.sendMessage,onEditMessage:l.editMessage,onDeleteMessage:l.deleteMessage,onOpenFile:l.openFile,onOpenUserTag:l.openUserTag,onOpenFailedMessage:l.openFailedMessage,onMenuActionHandler:l.menuActionHandler,onMessageActionHandler:l.messageActionHandler,onMessageSelectionActionHandler:l.messageSelectionActionHandler,onSendMessageReaction:l.sendMessageReaction,onTypingMessage:l.typingMessage,onTextareaActionHandler:l.textareaActionHandler},na({_:2},[oa(r.slots,(t=>({name:t.slot,fn:us((data=>[ra(e.$slots,t.slot,Ze(lo(data)))]))})))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","templates-text","username-options","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),io(un,{name:"vac-fade-preview",appear:""},{default:us((()=>[r.showMediaPreview?(Ga(),eo(m,{key:0,file:r.previewFile,onCloseMediaPreview:t[1]||(t[1]=e=>r.showMediaPreview=!1)},na({_:2},[oa(r.slots,(t=>({name:t.slot,fn:us((data=>[ra(e.$slots,t.slot,Ze(lo(data)))]))})))]),1032,["file"])):mo("",!0)])),_:3})],4)}],["styles",['.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-bold{font-weight:700}.vac-text-italic{font-style:italic}.vac-text-strike{text-decoration:line-through}.vac-text-underline{text-decoration:underline}.vac-text-inline-code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-text-multiline-code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:60px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:30px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{height:20px;width:100%;line-height:20px;overflow:hidden;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;cursor:pointer;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}\n']]])),c_="vue-advanced-chat";function d_(){customElements.get(c_)||customElements.define(c_,l_)}}.call(this,o(71))}}]);